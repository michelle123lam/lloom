!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).vega={})}(this,(function(t){"use strict";const e="view",n="[",r="]",i="{",o="}",s=":",c=",",l="@",f=">",u=/[[\]{}]/,h={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let a,p;function m(t,e,n,r,i){const o=t.length;let s,c=0;for(;e<o;++e){if(s=t[e],!c&&s===n)return e;i&&i.indexOf(s)>=0?--c:r&&r.indexOf(s)>=0&&++c}return e}function g(t){const e=[],s=t.length;let l=0,f=0;for(;f<s;)f=m(t,f,c,n+i,r+o),e.push(t.substring(l,f).trim()),l=++f;if(0===e.length)throw"Empty event selector: "+t;return e}function b(t){return"["===t[0]?function(t){const e=t.length;let i,o=1;if(o=m(t,o,r,n,r),o===e)throw"Empty between selector: "+t;if(i=g(t.substring(1,o)),2!==i.length)throw"Between selector must have two elements: "+t;if(t=t.slice(o+1).trim(),t[0]!==f)throw"Expected '>' after between selector: "+t;i=i.map(b);const s=b(t.slice(1).trim());if(s.between)return{between:i,stream:s};s.between=i;return s}(t):function(t){const e={source:a},f=[];let h,g,b=[0,0],w=0,d=0,y=t.length,x=0;if(t[y-1]===o){if(x=t.lastIndexOf(i),!(x>=0))throw"Unmatched right brace: "+t;try{b=function(t){const e=t.split(c);if(!t.length||e.length>2)throw t;return e.map((e=>{const n=+e;if(n!=n)throw t;return n}))}(t.substring(x+1,y-1))}catch(e){throw"Invalid throttle specification: "+t}y=(t=t.slice(0,x).trim()).length,x=0}if(!y)throw t;t[0]===l&&(w=++x);h=m(t,x,s),h<y&&(f.push(t.substring(d,h).trim()),d=x=++h);if(x=m(t,x,n),x===y)f.push(t.substring(d,y).trim());else if(f.push(t.substring(d,x).trim()),g=[],d=++x,d===y)throw"Unmatched left bracket: "+t;for(;x<y;){if(x=m(t,x,r),x===y)throw"Unmatched left bracket: "+t;if(g.push(t.substring(d,x).trim()),x<y-1&&t[++x]!==n)throw"Expected left bracket: "+t;d=++x}if(!(y=f.length)||u.test(f[y-1]))throw"Invalid event selector: "+t;y>1?(e.type=f[1],w?e.markname=f[0].slice(1):(v=f[0],p[v]?e.marktype=f[0]:e.source=f[0])):e.type=f[0];var v;"!"===e.type.slice(-1)&&(e.consume=!0,e.type=e.type.slice(0,-1));null!=g&&(e.filter=g);b[0]&&(e.throttle=b[0]);b[1]&&(e.debounce=b[1]);return e}(t)}t.parseSelector=function(t,n,r){return a=n||e,p=r||h,g(t.trim()).map(b)}}));
//# sourceMappingURL=vega-event-selector.min.js.map
