// @observablehq/plot v0.6.14 Copyright 2020-2023 Observable, Inc.
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3@7.9.0/dist/d3.min.js")):"function"==typeof define&&define.amd?define(["exports","d3@7.9.0/dist/d3.min.js"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Plot=t.Plot||{},t.d3)}(this,(function(t,e){"use strict";function n(t){return null!=t&&!Number.isNaN(t)}function r(t,r){return+n(r)-+n(t)||e.ascending(t,r)}function o(t,r){return+n(r)-+n(t)||e.descending(t,r)}function i(t){return null!=t&&""!=`${t}`}function a(t){return isFinite(t)?t:NaN}function l(t){return t>0&&isFinite(t)?t:NaN}function s(t){return t<0&&isFinite(t)?t:NaN}function c(t,e){if(t instanceof Date||(t=new Date(+t)),isNaN(t))return"function"==typeof e?e(t):e;const n=t.getUTCHours(),r=t.getUTCMinutes(),o=t.getUTCSeconds(),i=t.getUTCMilliseconds();return`${a=t.getUTCFullYear(),a<0?`-${u(-a,6)}`:a>9999?`+${u(a,6)}`:u(a,4)}-${u(t.getUTCMonth()+1,2)}-${u(t.getUTCDate(),2)}${n||r||o||i?`T${u(n,2)}:${u(r,2)}${o||i?`:${u(o,2)}${i?`.${u(i,3)}`:""}`:""}Z`:""}`;var a}function u(t,e){return`${t}`.padStart(e,"0")}const f=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function h(t,e){return f.test(t+="")?new Date(t):"function"==typeof e?e(t):e}function d(t){if(null==t)return;const n=t[0],r=t[t.length-1];return e.descending(n,r)}const p=1e3,m=6e4,y=36e5,g=864e5,v=7*g,x=30*g,w=365*g,b=[["millisecond",1],["2 milliseconds",2],["5 milliseconds",5],["10 milliseconds",10],["20 milliseconds",20],["50 milliseconds",50],["100 milliseconds",100],["200 milliseconds",200],["500 milliseconds",500],["second",p],["5 seconds",5e3],["15 seconds",15e3],["30 seconds",3e4],["minute",m],["5 minutes",3e5],["15 minutes",9e5],["30 minutes",18e5],["hour",y],["3 hours",108e5],["6 hours",216e5],["12 hours",432e5],["day",g],["2 days",2*g],["week",v],["2 weeks",2*v],["month",x],["3 months",3*x],["6 months",6*x],["year",w],["2 years",2*w],["5 years",5*w],["10 years",10*w],["20 years",20*w],["50 years",50*w],["100 years",100*w]],k=new Map([["second",p],["minute",m],["hour",y],["day",g],["monday",v],["tuesday",v],["wednesday",v],["thursday",v],["friday",v],["saturday",v],["sunday",v],["week",v],["month",x],["year",w]]),$=new Map([["second",e.timeSecond],["minute",e.timeMinute],["hour",e.timeHour],["day",e.timeDay],["monday",e.timeMonday],["tuesday",e.timeTuesday],["wednesday",e.timeWednesday],["thursday",e.timeThursday],["friday",e.timeFriday],["saturday",e.timeSaturday],["sunday",e.timeSunday],["week",e.timeWeek],["month",e.timeMonth],["year",e.timeYear]]),M=new Map([["second",e.utcSecond],["minute",e.utcMinute],["hour",e.utcHour],["day",e.unixDay],["monday",e.utcMonday],["tuesday",e.utcTuesday],["wednesday",e.utcWednesday],["thursday",e.utcThursday],["friday",e.utcFriday],["saturday",e.utcSaturday],["sunday",e.utcSunday],["week",e.utcWeek],["month",e.utcMonth],["year",e.utcYear]]),L=Symbol("intervalDuration"),A=Symbol("intervalType");for(const[t,e]of $)e[L]=k.get(t),e[A]="time";for(const[t,e]of M)e[L]=k.get(t),e[A]="utc";const S=[["year",e.utcYear,"utc"],["month",e.utcMonth,"utc"],["day",e.unixDay,"utc",6*x],["hour",e.utcHour,"utc",3*g],["minute",e.utcMinute,"utc",216e5],["second",e.utcSecond,"utc",18e5]],z=[["year",e.timeYear,"time"],["month",e.timeMonth,"time"],["day",e.timeDay,"time",6*x],["hour",e.timeHour,"time",3*g],["minute",e.timeMinute,"time",216e5],["second",e.timeSecond,"time",18e5]],O=[S[0],z[0],S[1],z[1],S[2],z[2],...S.slice(3)];function E(t){let e=`${t}`.toLowerCase();e.endsWith("s")&&(e=e.slice(0,-1));let n=1;const r=/^(?:(\d+)\s+)/.exec(e);switch(r&&(e=e.slice(r[0].length),n=+r[1]),e){case"quarter":e="month",n*=3;break;case"half":e="month",n*=6}let o=M.get(e);if(!o)throw new Error(`unknown interval: ${t}`);if(n>1&&!o.every)throw new Error(`non-periodic interval: ${e}`);return[e,n]}function R(t){return T(E(t),"time")}function C(t){return T(E(t),"utc")}function T([t,e],n){let r=("time"===n?$:M).get(t);return e>1&&(r=r.every(e),r[L]=k.get(t)*e,r[A]=n),r}function B(t,n){if(!(n>1))return;const r=t[L];if(!b.some((([,t])=>t===r)))return;if(r%g==0&&g<r&&r<x)return;const[o]=b[e.bisector((([,t])=>Math.log(t))).center(b,Math.log(r*n))];return("time"===t[A]?R:C)(o)}function N(t,n,r){const o="time"===n?e.timeFormat:e.utcFormat;if(null==r)return o("year"===t?"%Y":"month"===t?"%Y-%m":"day"===t?"%Y-%m-%d":"hour"===t||"minute"===t?"%Y-%m-%dT%H:%M":"second"===t?"%Y-%m-%dT%H:%M:%S":"%Y-%m-%dT%H:%M:%S.%L");const i=function(t){return"left"===t||"right"===t?(t,e)=>`\n${t}\n${e}`:"top"===t?(t,e)=>`${e}\n${t}`:(t,e)=>`${t}\n${e}`}(r);switch(t){case"millisecond":return P(o(".%L"),o(":%M:%S"),i);case"second":return P(o(":%S"),o("%-I:%M"),i);case"minute":return P(o("%-I:%M"),o("%p"),i);case"hour":return P(o("%-I %p"),o("%b %-d"),i);case"day":return P(o("%-d"),o("%b"),i);case"month":return P(o("%b"),o("%Y"),i);case"year":return o("%Y")}throw new Error("unable to format time ticks")}function I(t,n,r){const o=e.max(e.pairs(n,((t,e)=>Math.abs(e-t))));if(o<1e3)return N("millisecond","utc",r);for(const[e,i,a,l]of function(t){return"time"===t?z:"utc"===t?S:O}(t)){if(o>l)break;if("hour"===e&&!o)break;if(n.every((t=>i.floor(t)>=t)))return N(e,a,r)}}function P(t,e,n){return(r,o,i)=>{const a=t(r,o),l=e(r,o),s=o-d(i);return o!==s&&void 0!==i[s]&&l===e(i[s],s)?a:n(a,l)}}const W=Object.getPrototypeOf(Uint8Array),j=Object.prototype.toString,q=Symbol("reindex");function F(t,e,n){const r=typeof e;return"string"===r?D(t,G(e),n):"function"===r?D(t,e,n):"number"===r||e instanceof Date||"boolean"===r?dt(t,et(e),n):"function"==typeof e?.transform?Y(e.transform(t),n):function(t,e){return e?At(t,e):t}(Y(e,n),t?.[q])}function D(t,e,n){return dt(t,n?.prototype instanceof W?function(t){return(e,n)=>ot(t(e,n))}(e):e,n)}function Y(t,e){return void 0===e?ht(t):t instanceof e?t:e.prototype instanceof W&&!(t instanceof W)?e.from(t,ot):e.from(t)}const _=[null],G=t=>e=>e[t],X={transform:Lt},H={transform:t=>t},U=()=>1,V=()=>!0,Z=t=>null==t?t:`${t}`,Q=t=>null==t?t:+t,J=t=>t?t[0]:void 0,K=t=>t?t[1]:void 0,tt=t=>t?t[2]:void 0,et=t=>()=>t;function nt(t){const n=+`${t}`.slice(1)/100;return(t,r)=>e.quantile(t,n,r)}function rt(t){return t instanceof W?t:dt(t,ot,Float64Array)}function ot(t){return null==t?NaN:Number(t)}function at(t){return dt(t,lt)}function lt(t){return t instanceof Date&&!isNaN(t)?t:"string"==typeof t?h(t):null==t||isNaN(t=+t)?void 0:new Date(t)}function st(t,e){return void 0===t&&(t=e),null===t?[void 0,"none"]:Zt(t)?[void 0,t]:[t,void 0]}function ct(t,e){return void 0===t&&(t=e),null===t||"number"==typeof t?[void 0,t]:[t,void 0]}function ut(t,e,n){if(null!=t)return ft(t,e,n)}function ft(t,e,n){const r=`${t}`.toLowerCase();if(!n.includes(r))throw new Error(`invalid ${e}: ${t}`);return r}function ht(t){return null==t||t instanceof Array||t instanceof W?t:Array.from(t)}function dt(t,e,n=Array){return null==t?t:t instanceof n?t.map(e):n.from(t,e)}function pt(t,e=Array){return t instanceof e?t.slice():e.from(t)}function mt({x:t,x1:e,x2:n}){return void 0!==t||void 0!==e||void 0!==n}function yt({y:t,y1:e,y2:n}){return void 0!==t||void 0!==e||void 0!==n}function gt(t){return mt(t)||yt(t)||void 0!==t.interval}function vt(t){return t?.toString===j}function xt(t){return vt(t)&&(void 0!==t.type||void 0!==t.domain)}function wt(t){return vt(t)&&"function"!=typeof t.transform}function bt(t){return wt(t)&&void 0===t.value&&void 0===t.channel}function kt(t,e,n,r=H){return void 0===e&&void 0===n?(e=0,n=void 0===t?r:t):void 0===e?e=void 0===t?0:t:void 0===n&&(n=void 0===t?0:t),[e,n]}function $t(t,e){return void 0===t&&void 0===e?[J,K]:[t,e]}function Mt({z:t,fill:e,stroke:n}={}){return void 0===t&&([t]=st(e)),void 0===t&&([t]=st(n)),t}function Lt(t){const e=t.length,n=new Uint32Array(e);for(let t=0;t<e;++t)n[t]=t;return n}function At(t,e){return dt(e,(e=>t[e]),t.constructor)}function St(t){return 1===t.length?(e,n)=>t(At(n,e)):t}function zt(t,e,n){return t.subarray?t.subarray(e,n):t.slice(e,n)}function Ot(t){return null!==t&&"object"==typeof t?t.valueOf():t}function Et(t,e){if(void 0!==e[t])return e[t];switch(t){case"x1":case"x2":t="x";break;case"y1":case"y2":t="y"}return e[t]}function Rt(t){let e;return[{transform:()=>e,label:Tt(t)},t=>e=t]}function Ct(t){return null==t?[t]:Rt(t)}function Tt(t,e){return"string"==typeof t?t:t&&void 0!==t.label?t.label:e}function Bt(t,e){return{transform(n){const r=t.transform(n),o=e.transform(n);return _t(r)||_t(o)?dt(r,((t,e)=>new Date((+r[e]+ +o[e])/2))):dt(r,((t,e)=>(+r[e]+ +o[e])/2),Float64Array)},label:t.label}}function Nt(t,e){const n=It(e?.interval,e?.type);return n?dt(t,n):t}function It(t,e){const r=Pt(t,e);return r&&(t=>n(t)?r.floor(t):t)}function Pt(t,n){if(null!=t){if("number"==typeof t){0<t&&t<1&&Number.isInteger(1/t)&&(t=-1/t);const n=Math.abs(t);return t<0?{floor:t=>Math.floor(t*n)/n,offset:t=>(t*n+1)/n,range:(t,r)=>e.range(Math.ceil(t*n),r*n).map((t=>t/n))}:{floor:t=>Math.floor(t/n)*n,offset:t=>t+n,range:(t,r)=>e.range(Math.ceil(t/n),r/n).map((t=>t*n))}}if("string"==typeof t)return("time"===n?R:C)(t);if("function"!=typeof t.floor)throw new Error("invalid interval; missing floor method");if("function"!=typeof t.offset)throw new Error("invalid interval; missing offset method");return t}}function Wt(t,e){if((t=Pt(t,e))&&"function"!=typeof t.range)throw new Error("invalid interval: missing range method");return t}function jt(t){return"function"==typeof t?.range}function qt(t){return void 0===t||wt(t)?t:{value:t}}function Ft(t){return t&&"function"==typeof t[Symbol.iterator]}function Dt(t){for(const e of t)if(null!=e)return"object"!=typeof e||e instanceof Date}function Yt(t){for(const e of t){if(null==e)continue;const t=typeof e;return"string"===t||"boolean"===t}}function _t(t){for(const e of t)if(null!=e)return e instanceof Date}function Gt(t){for(const e of t)if(null!=e)return"string"==typeof e&&isNaN(e)&&h(e)}function Xt(t){for(const e of t)if(null!=e){if("string"!=typeof e)return!1;if(e.trim())return!isNaN(e)}}function Ht(t){for(const e of t)if(null!=e)return"number"==typeof e}function Ut(t,e){let n;for(const r of t)if(null!=r){if(!e(r))return!1;n=!0}return n}const Vt=new Set("none,currentcolor,transparent,aliceblue,antiquewhite,aqua,aquamarine,azure,beige,bisque,black,blanchedalmond,blue,blueviolet,brown,burlywood,cadetblue,chartreuse,chocolate,coral,cornflowerblue,cornsilk,crimson,cyan,darkblue,darkcyan,darkgoldenrod,darkgray,darkgreen,darkgrey,darkkhaki,darkmagenta,darkolivegreen,darkorange,darkorchid,darkred,darksalmon,darkseagreen,darkslateblue,darkslategray,darkslategrey,darkturquoise,darkviolet,deeppink,deepskyblue,dimgray,dimgrey,dodgerblue,firebrick,floralwhite,forestgreen,fuchsia,gainsboro,ghostwhite,gold,goldenrod,gray,green,greenyellow,grey,honeydew,hotpink,indianred,indigo,ivory,khaki,lavender,lavenderblush,lawngreen,lemonchiffon,lightblue,lightcoral,lightcyan,lightgoldenrodyellow,lightgray,lightgreen,lightgrey,lightpink,lightsalmon,lightseagreen,lightskyblue,lightslategray,lightslategrey,lightsteelblue,lightyellow,lime,limegreen,linen,magenta,maroon,mediumaquamarine,mediumblue,mediumorchid,mediumpurple,mediumseagreen,mediumslateblue,mediumspringgreen,mediumturquoise,mediumvioletred,midnightblue,mintcream,mistyrose,moccasin,navajowhite,navy,oldlace,olive,olivedrab,orange,orangered,orchid,palegoldenrod,palegreen,paleturquoise,palevioletred,papayawhip,peachpuff,peru,pink,plum,powderblue,purple,rebeccapurple,red,rosybrown,royalblue,saddlebrown,salmon,sandybrown,seagreen,seashell,sienna,silver,skyblue,slateblue,slategray,slategrey,snow,springgreen,steelblue,tan,teal,thistle,tomato,turquoise,violet,wheat,white,whitesmoke,yellow".split(","));function Zt(t){return"string"==typeof t&&(t=t.toLowerCase().trim(),/^#[0-9a-f]{3,8}$/.test(t)||/^(?:url|var|rgb|rgba|hsl|hsla|hwb|lab|lch|oklab|oklch|color|color-mix)\(.*\)$/.test(t)||Vt.has(t))}function Qt(t){return"number"==typeof t&&(0<=t&&t<=1||isNaN(t))}function Jt(t){return null==t||Kt(t)}function Kt(t){return/^\s*none\s*$/i.test(t)}function te(t,e){return ut(t,e,["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function ee(t="middle"){return te(t,"frameAnchor")}function ne(t){return Ft(t)?function(t){console.warn("named iterables are deprecated; please use an object instead");const e=new Set;return Object.fromEntries(Array.from(t,(t=>{const{name:n}=t;if(null==n)throw new Error("missing name");const r=`${n}`;if("__proto__"===r)throw new Error(`illegal name: ${r}`);if(e.has(r))throw new Error(`duplicate name: ${r}`);return e.add(r),[n,t]})))}(t):t}function re(t){return!0===t?t="frame":!1===t?t=null:null!=t&&(t=ft(t,"clip",["frame","sphere"])),t}const oe=Symbol("position"),ie=Symbol("color"),ae=Symbol("radius"),le=Symbol("length"),se=Symbol("opacity"),ce=Symbol("symbol"),ue=Symbol("projection"),fe=new Map([["x",oe],["y",oe],["fx",oe],["fy",oe],["r",ae],["color",ie],["opacity",se],["symbol",ce],["length",le],["projection",ue]]);const he=Math.sqrt(3),de=2/he,pe={draw(t,e){const n=Math.sqrt(e/Math.PI),r=n*de,o=r/2;t.moveTo(0,r),t.lineTo(n,o),t.lineTo(n,-o),t.lineTo(0,-r),t.lineTo(-n,-o),t.lineTo(-n,o),t.closePath()}},me=new Map([["asterisk",e.symbolAsterisk],["circle",e.symbolCircle],["cross",e.symbolCross],["diamond",e.symbolDiamond],["diamond2",e.symbolDiamond2],["hexagon",pe],["plus",e.symbolPlus],["square",e.symbolSquare],["square2",e.symbolSquare2],["star",e.symbolStar],["times",e.symbolTimes],["triangle",e.symbolTriangle],["triangle2",e.symbolTriangle2],["wye",e.symbolWye]]);function ye(t){return t&&"function"==typeof t.draw}function ge(t){return!!ye(t)||"string"==typeof t&&me.has(t.toLowerCase())}function ve(t){if(null==t||ye(t))return t;const e=me.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid symbol: ${t}`)}function xe({filter:t,sort:e,reverse:n,transform:r,initializer:o,...i}={},a){if(void 0===r&&(null!=t&&(r=Me(t)),null==e||bt(e)||(r=be(r,Se(e))),n&&(r=be(r,Le))),null!=a&&null!=o)throw new Error("transforms cannot be applied after initializers");return{...i,...(null===e||bt(e))&&{sort:e},transform:be(r,a)}}function we({filter:t,sort:e,reverse:n,initializer:r,...o}={},i){return void 0===r&&(null!=t&&(r=Me(t)),null==e||bt(e)||(r=ke(r,Se(e))),n&&(r=ke(r,Le))),{...o,...(null===e||bt(e))&&{sort:e},initializer:ke(r,i)}}function be(t,e){return null==t?null===e?void 0:e:null==e?null===t?void 0:t:function(n,r,o){return({data:n,facets:r}=t.call(this,n,r,o)),e.call(this,ht(n),r,o)}}function ke(t,e){return null==t?null===e?void 0:e:null==e?null===t?void 0:t:function(n,r,o,...i){let a,l,s,c,u,f;return({data:l=n,facets:s=r,channels:a}=t.call(this,n,r,o,...i)),({data:u=l,facets:f=s,channels:c}=e.call(this,l,s,{...o,...a},...i)),{data:u,facets:f,channels:{...a,...c}}}}function $e(t,e){return(null!=t.initializer?we:xe)(t,e)}function Me(t){return(e,n)=>{const r=F(e,t);return{data:e,facets:n.map((t=>t.filter((t=>r[t]))))}}}function Le(t,e){return{data:t,facets:e.map((t=>t.slice().reverse()))}}function Ae(t,{sort:e,...n}={}){return{...(wt(t)&&void 0!==t.channel?we:$e)(n,Se(t)),sort:bt(e)?e:null}}function Se(t){return("function"==typeof t&&1!==t.length?ze:Oe)(t)}function ze(t){return(e,n)=>{const r=(n,r)=>t(e[n],e[r]);return{data:e,facets:n.map((t=>t.slice().sort(r)))}}}function Oe(t){let e,n;({channel:e,value:t,order:n}={...qt(t)});const i=e?.startsWith("-");if(i&&(e=e.slice(1)),void 0===n&&(n=i?o:r),"function"!=typeof n)switch(`${n}`.toLowerCase()){case"ascending":n=r;break;case"descending":n=o;break;default:throw new Error(`invalid order: ${n}`)}return(r,o,i)=>{let a;if(void 0===e)a=F(r,t);else{if(void 0===i)throw new Error("channel sort requires an initializer");if(a=i[e],!a)return{};a=a.value}const l=(t,e)=>n(a[t],a[e]);return{data:r,facets:o.map((t=>t.slice().sort(l)))}}}function Ee(t,e){return Be(null,null,t,e)}function Re(t={y:"count"},e={}){const{x:n=H}=e;if(null==n)throw new Error("missing channel: x");return Be(n,null,t,e)}function Ce(t={x:"count"},e={}){const{y:n=H}=e;if(null==n)throw new Error("missing channel: y");return Be(null,n,t,e)}function Te(t={fill:"count"},e={}){let{x:n,y:r}=e;if([n,r]=$t(n,r),null==n)throw new Error("missing channel: x");if(null==r)throw new Error("missing channel: y");return Be(n,r,t,e)}function Be(t,e,{data:n=Qe,filter:r,sort:o,reverse:i,...a}={},l={}){a=De(a,l),n=Ge(n,H),o=null==o?void 0:Ye("sort",o,l),r=null==r?void 0:_e("filter",r,l);const[s,c]=Ct(t),[u,f]=Ct(e),{z:h,fill:d,stroke:p,x1:m,x2:y,y1:g,y2:v,...x}=l,[w,b]=Ct(h),[k]=st(d),[$]=st(p),[M,L]=Ct(k),[A,S]=Ct($);return{..."z"in l&&{z:w||h},..."fill"in l&&{fill:M||d},..."stroke"in l&&{stroke:A||p},...xe(x,((l,s,u)=>{const d=Nt(F(l,t),u?.x),p=Nt(F(l,e),u?.y),m=F(l,h),y=F(l,k),g=F(l,$),v=He(a,{z:m,fill:y,stroke:g}),x=[],w=[],M=d&&c([]),A=p&&f([]),z=m&&b([]),O=y&&L([]),E=g&&S([]);let R=0;for(const t of a)t.initialize(l);o&&o.initialize(l),r&&r.initialize(l);for(const t of s){const e=[];for(const e of a)e.scope("facet",t);o&&o.scope("facet",t),r&&r.scope("facet",t);for(const[i,s]of je(t,v))for(const[t,c]of je(s,p))for(const[s,u]of je(c,d)){const c={data:l};if(d&&(c.x=s),p&&(c.y=t),v&&(c.z=i),!r||r.reduce(u,c)){e.push(R++),w.push(n.reduceIndex(u,l,c)),d&&M.push(s),p&&A.push(t),m&&z.push(v===m?i:m[u[0]]),y&&O.push(v===y?i:y[u[0]]),g&&E.push(v===g?i:g[u[0]]);for(const t of a)t.reduce(u,c);o&&o.reduce(u,c)}}x.push(e)}return Ue(x,o,i),{data:w,facets:x}})),...!Ne(a,"x")&&(s?{x:s}:{x1:m,x2:y}),...!Ne(a,"y")&&(u?{y:u}:{y1:g,y2:v}),...Object.fromEntries(a.map((({name:t,output:e})=>[t,e])))}}function Ne(t,...e){for(const{name:n}of t)if(e.includes(n))return!0;return!1}function Ie(t,e,n=Pe){const r=Object.entries(t);return null!=e.title&&void 0===t.title&&r.push(["title",Ke]),null!=e.href&&void 0===t.href&&r.push(["href",Je]),r.filter((([,t])=>void 0!==t)).map((([t,r])=>null===r?function(t){return{name:t,initialize(){},scope(){},reduce(){}}}(t):n(t,r,e)))}function Pe(t,e,n,r=We){let o;vt(e)&&"reduce"in e&&(o=e.scale,e=e.reduce);const i=r(t,e,n),[a,l]=Rt(i.label);let s;return{name:t,output:void 0===o?a:{value:a,scale:o},initialize(t){i.initialize(t),s=l([])},scope(t,e){i.scope(t,e)},reduce(t,e){s.push(i.reduce(t,e))}}}function We(t,e,n,r=qe){const o=Et(t,n),i=r(e,o);let a,l;return{label:Tt(i===en?null:o,i.label),initialize(t){a=void 0===o?t:F(t,o),"data"===i.scope&&(l=i.reduceIndex(Lt(t),a))},scope(t,e){i.scope===t&&(l=i.reduceIndex(e,a))},reduce:(t,e)=>null==i.scope?i.reduceIndex(t,a,e):i.reduceIndex(t,a,l,e)}}function je(t,n){return n?e.group(t,(t=>n[t])):[[,t]]}function qe(t,n,r=Fe){if(null==t)return r(t);if("function"==typeof t.reduceIndex)return t;if("function"==typeof t.reduce&&vt(t))return function(t){return console.warn("deprecated reduce interface; implement reduceIndex instead."),{...t,reduceIndex:t.reduce.bind(t)}}(t);if("function"==typeof t)return o=t,{reduceIndex:(t,e,n)=>o(At(e,t),n)};var o;if(/^p\d{2}$/i.test(t))return Ve(nt(t));switch(`${t}`.toLowerCase()){case"first":return Je;case"last":return tn;case"identity":return Qe;case"count":return en;case"distinct":return nn;case"sum":return null==n?en:rn;case"proportion":return on(n,"data");case"proportion-facet":return on(n,"facet");case"deviation":return Ve(e.deviation);case"min":return Ve(e.min);case"min-index":return Ve(e.minIndex);case"max":return Ve(e.max);case"max-index":return Ve(e.maxIndex);case"mean":return Ze(e.mean);case"median":return Ze(e.median);case"variance":return Ve(e.variance);case"mode":return Ve(e.mode)}return r(t)}function Fe(t){throw new Error(`invalid reduce: ${t}`)}function De(t,e){return Ie(t,e,Ye)}function Ye(t,e,n){return Pe(t,e,n,_e)}function _e(t,e,n){return We(t,e,n,Ge)}function Ge(t,e){return qe(t,e,Xe)}function Xe(t){switch(`${t}`.toLowerCase()){case"x":return an;case"y":return ln;case"z":return sn}throw new Error(`invalid group reduce: ${t}`)}function He(t,e){for(const n in e){const r=e[n];if(void 0!==r&&!t.some((t=>t.name===n)))return r}}function Ue(t,e,n){if(e){const n=e.output.transform(),o=(t,e)=>r(n[t],n[e]);t.forEach((t=>t.sort(o)))}n&&t.forEach((t=>t.reverse()))}function Ve(t){return{reduceIndex:(e,n)=>t(e,(t=>n[t]))}}function Ze(t){return{reduceIndex(e,n){const r=t(e,(t=>n[t]));return _t(n)?new Date(r):r}}}const Qe={reduceIndex:(t,e)=>At(e,t)},Je={reduceIndex:(t,e)=>e[t[0]]},Ke={reduceIndex(t,n){const r=e.sort(e.rollup(t,(t=>t.length),(t=>n[t])),K),o=r.slice(-5).reverse();if(o.length<r.length){const t=r.slice(0,-4);o[4]=[`… ${t.length.toLocaleString("en-US")} more`,e.sum(t,K)]}return o.map((([t,e])=>`${t} (${e.toLocaleString("en-US")})`)).join("\n")}},tn={reduceIndex:(t,e)=>e[t[t.length-1]]},en={label:"Frequency",reduceIndex:t=>t.length},nn={label:"Distinct",reduceIndex(t,n){const r=new e.InternSet;for(const e of t)r.add(n[e]);return r.size}},rn=Ve(e.sum);function on(t,n){return null==t?{scope:n,label:"Frequency",reduceIndex:(t,e,n=1)=>t.length/n}:{scope:n,reduceIndex:(t,n,r=1)=>e.sum(t,(t=>n[t]))/r}}const an={reduceIndex:(t,e,{x:n})=>n},ln={reduceIndex:(t,e,{y:n})=>n},sn={reduceIndex:(t,e,{z:n})=>n};function cn(t,{scale:e,type:n,value:r,filter:o,hint:i,label:a=Tt(r)},l){return void 0===i&&"function"==typeof r?.transform&&(i=r.hint),hn(l,{scale:e,type:n,value:F(t,r),label:a,filter:o,hint:i})}function un(t,e){return Object.fromEntries(Object.entries(t).map((([t,n])=>[t,cn(e,n,t)])))}function fn(t,e){const n=Object.fromEntries(Object.entries(t).map((([t,{scale:n,value:r}])=>{const o=null==n?null:e[n];return[t,null==o?r:dt(r,o)]})));return n.channels=t,n}function hn(t,e){const{scale:n,value:r}=e;if(!0===n||"auto"===n)switch(t){case"fill":case"stroke":case"color":e.scale=!0!==n&&Ut(r,Zt)?null:"color";break;case"fillOpacity":case"strokeOpacity":case"opacity":e.scale=!0!==n&&Ut(r,Qt)?null:"opacity";break;case"symbol":!0!==n&&Ut(r,ge)?(e.scale=null,e.value=dt(r,ve)):e.scale="symbol";break;default:e.scale=fe.has(t)?t:null}else if(!1===n)e.scale=null;else if(null!=n&&!fe.has(n))throw new Error(`unknown scale: ${n}`);return e}function dn(t,e){for(const n in t){const r=t[n];if(r.scale===e)return r}}function pn(t,e){const n=t.original;if(n===t)return e;const r=e.value,o=e.value=[];for(let e=0;e<n.length;++e){const i=r[n[e][0]];for(const n of t[e])o[n]=i}return e}function mn(t,e,n){const r=yn(t,e);return dt(yn(t,n),((t,e)=>Math.abs(t-r[e])),Float64Array)}function yn(t,e,n){let r=t[e];if(r||void 0===n||(r=t[n]),r)return r.value;throw new Error(`missing channel: ${e}`)}function gn(t){if(null==t||"function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"ascending":return vn;case"descending":return xn}throw new Error(`invalid order: ${t}`)}function vn([t,e],[n,o]){return r(e,o)||r(t,n)}function xn([t,e],[n,i]){return o(e,i)||r(t,n)}function wn(t,e){let n=t[e];if(n){for(;n.source;)n=n.source;return null===n.source?null:n}}function bn(t={}){const{document:e=("undefined"!=typeof window?window.document:void 0),clip:n}=t;return{document:e,clip:re(n)}}function kn(t,{document:n}){return e.select(e.creator(t).call(n.documentElement))}let $n,Mn=0;function Ln(t){t!==$n&&($n=t,console.warn(t),++Mn)}const An=Math.PI,Sn=2*An,zn=.618;function On({projection:t,inset:n=0,insetTop:r=n,insetRight:o=n,insetBottom:i=n,insetLeft:a=n}={},l){if(null==t)return;if("function"==typeof t.stream)return t;let s,c,u="frame";if(vt(t)){let e;if(({type:t,domain:c,inset:e,insetTop:r=(void 0!==e?e:r),insetRight:o=(void 0!==e?e:o),insetBottom:i=(void 0!==e?e:i),insetLeft:a=(void 0!==e?e:a),clip:u=u,...s}=t),null==t)return}"function"!=typeof t&&({type:t}=En(t));const{width:f,height:h,marginLeft:d,marginRight:p,marginTop:m,marginBottom:y}=l,g=f-d-p-a-o,v=h-m-y-r-i;if(t=t?.({width:g,height:v,clip:u,...s}),null==t)return;u=function(t,n,r,o,i){if(!1===t||null==t||"number"==typeof t)return t=>t;!0===t&&(t="frame");if("frame"===`${t}`.toLowerCase())return e.geoClipRectangle(n,r,o,i);throw new Error(`unknown projection clip type: ${t}`)}(u,d,m,f-p,h-y);let x,w=d+a,b=m+r;if(null!=c){const[[n,r],[o,i]]=e.geoPath(t).bounds(c),a=Math.min(g/(o-n),v/(i-r));a>0?(w-=(a*(n+o)-g)/2,b-=(a*(r+i)-v)/2,x=e.geoTransform({point(t,e){this.stream.point(t*a+w,e*a+b)}})):Ln("Warning: the projection could not be fit to the specified domain; using the default scale.")}return x??=0===w&&0===b?Tn():e.geoTransform({point(t,e){this.stream.point(t+w,e+b)}}),{stream:e=>t.stream(x.stream(u(e)))}}function En(t){switch(`${t}`.toLowerCase()){case"albers-usa":return Rn(e.geoAlbersUsa,.7463,.4673);case"albers":return Cn(e.geoAlbers,.7463,.4673);case"azimuthal-equal-area":return Rn(e.geoAzimuthalEqualArea,4,4);case"azimuthal-equidistant":return Rn(e.geoAzimuthalEquidistant,Sn,Sn);case"conic-conformal":return Cn(e.geoConicConformal,Sn,Sn);case"conic-equal-area":return Cn(e.geoConicEqualArea,6.1702,2.9781);case"conic-equidistant":return Cn(e.geoConicEquidistant,7.312,3.6282);case"equal-earth":return Rn(e.geoEqualEarth,5.4133,2.6347);case"equirectangular":return Rn(e.geoEquirectangular,Sn,An);case"gnomonic":return Rn(e.geoGnomonic,3.4641,3.4641);case"identity":return{type:Tn};case"reflect-y":return{type:Bn};case"mercator":return Rn(e.geoMercator,Sn,Sn);case"orthographic":return Rn(e.geoOrthographic,2,2);case"stereographic":return Rn(e.geoStereographic,2,2);case"transverse-mercator":return Rn(e.geoTransverseMercator,Sn,Sn);default:throw new Error(`unknown projection type: ${t}`)}}function Rn(t,e,n){return{type:({width:r,height:o,rotate:i,precision:a=.15,clip:l})=>{const s=t();return null!=a&&s.precision?.(a),null!=i&&s.rotate?.(i),"number"==typeof l&&s.clipAngle?.(l),s.scale(Math.min(r/e,o/n)),s.translate([r/2,o/2]),s},aspectRatio:n/e}}function Cn(t,e,n){const{type:r,aspectRatio:o}=Rn(t,e,n);return{type:t=>{const{parallels:e,domain:n,width:o,height:i}=t,a=r(t);return null!=e&&(a.parallels(e),void 0===n&&a.fitSize([o,i],{type:"Sphere"})),a},aspectRatio:o}}const Tn=et({stream:t=>t}),Bn=et(e.geoTransform({point(t,e){this.stream.point(t,-e)}}));function Nn(t,e,n,r){const o=n[t],i=n[e],a=o.length,l=n[t]=new Float64Array(a).fill(NaN),s=n[e]=new Float64Array(a).fill(NaN);let c;const u=r.stream({point(t,e){l[c]=t,s[c]=e}});for(c=0;c<a;++c)u.point(o[c],i[c])}function In({projection:t}={}){return null!=t&&("function"==typeof t.stream||(vt(t)&&(t=t.type),null!=t))}function Pn(t,e,{projection:n}){const{x:r,y:o}=t;let i={};return r&&(i.x=r),o&&(i.y=o),i=fn(i,e),n&&"x"===r?.scale&&"y"===o?.scale&&Nn("x","y",i,n),r&&(i.x=rt(i.x)),o&&(i.y=rt(i.y)),i}function Wn(t){const n=[],r=[],o={scale:"x",value:n},i={scale:"y",value:r},a={point(t,e){n.push(t),r.push(e)},lineStart(){},lineEnd(){},polygonStart(){},polygonEnd(){},sphere(){}};for(const n of t.value)e.geoStream(n,a);return[o,i]}const jn=new Map([["accent",e.schemeAccent],["category10",e.schemeCategory10],["dark2",e.schemeDark2],["observable10",e.schemeObservable10],["paired",e.schemePaired],["pastel1",e.schemePastel1],["pastel2",e.schemePastel2],["set1",e.schemeSet1],["set2",e.schemeSet2],["set3",e.schemeSet3],["tableau10",e.schemeTableau10]]);const qn=new Map([...jn,["brbg",Dn(e.schemeBrBG,e.interpolateBrBG)],["prgn",Dn(e.schemePRGn,e.interpolatePRGn)],["piyg",Dn(e.schemePiYG,e.interpolatePiYG)],["puor",Dn(e.schemePuOr,e.interpolatePuOr)],["rdbu",Dn(e.schemeRdBu,e.interpolateRdBu)],["rdgy",Dn(e.schemeRdGy,e.interpolateRdGy)],["rdylbu",Dn(e.schemeRdYlBu,e.interpolateRdYlBu)],["rdylgn",Dn(e.schemeRdYlGn,e.interpolateRdYlGn)],["spectral",Dn(e.schemeSpectral,e.interpolateSpectral)],["burd",Yn(e.schemeRdBu,e.interpolateRdBu)],["buylrd",Yn(e.schemeRdYlBu,e.interpolateRdYlBu)],["blues",Fn(e.schemeBlues,e.interpolateBlues)],["greens",Fn(e.schemeGreens,e.interpolateGreens)],["greys",Fn(e.schemeGreys,e.interpolateGreys)],["oranges",Fn(e.schemeOranges,e.interpolateOranges)],["purples",Fn(e.schemePurples,e.interpolatePurples)],["reds",Fn(e.schemeReds,e.interpolateReds)],["turbo",_n(e.interpolateTurbo)],["viridis",_n(e.interpolateViridis)],["magma",_n(e.interpolateMagma)],["inferno",_n(e.interpolateInferno)],["plasma",_n(e.interpolatePlasma)],["cividis",_n(e.interpolateCividis)],["cubehelix",_n(e.interpolateCubehelixDefault)],["warm",_n(e.interpolateWarm)],["cool",_n(e.interpolateCool)],["bugn",Fn(e.schemeBuGn,e.interpolateBuGn)],["bupu",Fn(e.schemeBuPu,e.interpolateBuPu)],["gnbu",Fn(e.schemeGnBu,e.interpolateGnBu)],["orrd",Fn(e.schemeOrRd,e.interpolateOrRd)],["pubu",Fn(e.schemePuBu,e.interpolatePuBu)],["pubugn",Fn(e.schemePuBuGn,e.interpolatePuBuGn)],["purd",Fn(e.schemePuRd,e.interpolatePuRd)],["rdpu",Fn(e.schemeRdPu,e.interpolateRdPu)],["ylgn",Fn(e.schemeYlGn,e.interpolateYlGn)],["ylgnbu",Fn(e.schemeYlGnBu,e.interpolateYlGnBu)],["ylorbr",Fn(e.schemeYlOrBr,e.interpolateYlOrBr)],["ylorrd",Fn(e.schemeYlOrRd,e.interpolateYlOrRd)],["rainbow",Gn(e.interpolateRainbow)],["sinebow",Gn(e.interpolateSinebow)]]);function Fn(t,n){return({length:r})=>1===r?[t[3][1]]:2===r?[t[3][1],t[3][2]]:(r=Math.max(3,Math.floor(r)))>9?e.quantize(n,r):t[r]}function Dn(t,n){return({length:r})=>2===r?[t[3][0],t[3][2]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize(n,r):t[r]}function Yn(t,n){return({length:r})=>2===r?[t[3][2],t[3][0]]:(r=Math.max(3,Math.floor(r)))>11?e.quantize((t=>n(1-t)),r):t[r].slice().reverse()}function _n(t){return({length:n})=>e.quantize(t,Math.max(2,Math.floor(n)))}function Gn(t){return({length:n})=>e.quantize(t,Math.floor(n)+1).slice(0,-1)}function Xn(t){const e=`${t}`.toLowerCase();if(!qn.has(e))throw new Error(`unknown ordinal scheme: ${e}`);return qn.get(e)}function Hn(t,e){const n=Xn(t),r="function"==typeof n?n({length:e}):n;return r.length!==e?r.slice(0,e):r}const Un=new Map([["brbg",e.interpolateBrBG],["prgn",e.interpolatePRGn],["piyg",e.interpolatePiYG],["puor",e.interpolatePuOr],["rdbu",e.interpolateRdBu],["rdgy",e.interpolateRdGy],["rdylbu",e.interpolateRdYlBu],["rdylgn",e.interpolateRdYlGn],["spectral",e.interpolateSpectral],["burd",t=>e.interpolateRdBu(1-t)],["buylrd",t=>e.interpolateRdYlBu(1-t)],["blues",e.interpolateBlues],["greens",e.interpolateGreens],["greys",e.interpolateGreys],["purples",e.interpolatePurples],["reds",e.interpolateReds],["oranges",e.interpolateOranges],["turbo",e.interpolateTurbo],["viridis",e.interpolateViridis],["magma",e.interpolateMagma],["inferno",e.interpolateInferno],["plasma",e.interpolatePlasma],["cividis",e.interpolateCividis],["cubehelix",e.interpolateCubehelixDefault],["warm",e.interpolateWarm],["cool",e.interpolateCool],["bugn",e.interpolateBuGn],["bupu",e.interpolateBuPu],["gnbu",e.interpolateGnBu],["orrd",e.interpolateOrRd],["pubugn",e.interpolatePuBuGn],["pubu",e.interpolatePuBu],["purd",e.interpolatePuRd],["rdpu",e.interpolateRdPu],["ylgnbu",e.interpolateYlGnBu],["ylgn",e.interpolateYlGn],["ylorbr",e.interpolateYlOrBr],["ylorrd",e.interpolateYlOrRd],["rainbow",e.interpolateRainbow],["sinebow",e.interpolateSinebow]]);function Vn(t){const e=`${t}`.toLowerCase();if(!Un.has(e))throw new Error(`unknown quantitative scheme: ${e}`);return Un.get(e)}const Zn=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);const Qn=t=>e=>t(1-e),Jn=[0,1],Kn=new Map([["number",e.interpolateNumber],["rgb",e.interpolateRgb],["hsl",e.interpolateHsl],["hcl",e.interpolateHcl],["lab",e.interpolateLab]]);function tr(t){const e=`${t}`.toLowerCase();if(!Kn.has(e))throw new Error(`unknown interpolator: ${e}`);return Kn.get(e)}function er(t,n,r,{type:o,nice:i,clamp:a,zero:l,domain:s=ir(t,r),unknown:c,round:u,scheme:f,interval:h,range:p=(fe.get(t)===ae?lr(r,s):fe.get(t)===le?sr(r,s):fe.get(t)===se?Jn:void 0),interpolate:m=(fe.get(t)===ie?null==f&&void 0!==p?e.interpolateRgb:Vn(void 0!==f?f:"cyclical"===o?"rainbow":"turbo"):u?e.interpolateRound:e.interpolateNumber),reverse:y}){if(h=Wt(h,o),"cyclical"!==o&&"sequential"!==o||(o="linear"),"function"!=typeof m&&(m=tr(m)),y=!!y,void 0!==p){if((s=ht(s)).length!==(p=ht(p)).length){if(1===m.length)throw new Error("invalid piecewise interpolator");m=e.piecewise(m,p),p=void 0}}if(1===m.length?(y&&(m=Qn(m),y=!1),void 0===p&&2===(p=Float64Array.from(s,((t,e)=>e/(s.length-1)))).length&&(p=Jn),n.interpolate((p===Jn?et:fr)(m))):n.interpolate(m),l){const[t,n]=e.extent(s);(t>0||n<0)&&(d(s=pt(s))!==Math.sign(t)?s[s.length-1]=0:s[0]=0)}return y&&(s=e.reverse(s)),n.domain(s).unknown(c),i&&(n.nice(function(t,e){return!0===t?void 0:"number"==typeof t?t:function(t,e){if((t=Wt(t,e))&&"function"!=typeof t.ceil)throw new Error("invalid interval: missing ceil method");return t}(t,e)}(i,o)),s=n.domain()),void 0!==p&&n.range(p),a&&n.clamp(a),{type:o,domain:s,range:p,scale:n,interpolate:m,interval:h}}function nr(t,n,{exponent:r=1,...o}){return er(t,e.scalePow().exponent(r),n,{...o,type:"pow"})}function rr(t,n,{domain:r=[0],unknown:o,scheme:i="rdylbu",interpolate:a,range:l=(void 0!==a?e.quantize(a,r.length+1):fe.get(t)===ie?Hn(i,r.length+1):void 0),reverse:s}){const c=d(r=ht(r));if(!isNaN(c)&&!function(t,n){for(let r=1,o=t.length,i=t[0];r<o;++r){const o=e.descending(i,i=t[r]);if(0!==o&&o!==n)return!1}return!0}(r,c))throw new Error(`the ${t} scale has a non-monotonic domain`);return s&&(l=e.reverse(l)),{type:"threshold",scale:e.scaleThreshold(c<0?e.reverse(r):r,void 0===l?[]:l).unknown(o),domain:r,range:l}}function or(t,n=a){return t.length?[e.min(t,(({value:t})=>void 0===t?t:e.min(t,n))),e.max(t,(({value:t})=>void 0===t?t:e.max(t,n)))]:[0,1]}function ir(t,e){const n=fe.get(t);return(n===ae||n===se||n===le?ar:or)(e)}function ar(t){return[0,t.length?e.max(t,(({value:t})=>void 0===t?t:e.max(t,a))):1]}function lr(t,n){const r=t.find((({radius:t})=>void 0!==t));if(void 0!==r)return[0,r.radius];const o=e.quantile(t,.5,(({value:t})=>void 0===t?NaN:e.quantile(t,.25,l))),i=n.map((t=>3*Math.sqrt(t/o))),a=30/e.max(i);return a<1?i.map((t=>t*a)):i}function sr(t,n){const r=e.median(t,(({value:t})=>void 0===t?NaN:e.median(t,Math.abs))),o=n.map((t=>12*t/r)),i=60/e.max(o);return i<1?o.map((t=>t*i)):o}function cr(t){for(const{value:e}of t)if(void 0!==e)for(let n of e){if(n>0)return or(t,l);if(n<0)return or(t,s)}return[1,10]}function ur(t){const e=[];for(const{value:n}of t)if(void 0!==n)for(const t of n)e.push(t);return e}function fr(t){return(e,n)=>r=>t(e+r*(n-e))}function hr(t,n,r,o,{type:i,nice:a,clamp:l,domain:s=or(o),unknown:c,pivot:u=0,scheme:f,range:h,symmetric:d=!0,interpolate:p=(fe.get(t)===ie?null==f&&void 0!==h?e.interpolateRgb:Vn(void 0!==f?f:"rdbu"):e.interpolateNumber),reverse:m}){u=+u,s=ht(s);let[y,g]=s;if(s.length>2&&Ln(`Warning: the diverging ${t} scale domain contains extra elements.`),e.descending(y,g)<0&&([y,g]=[g,y],m=!m),y=Math.min(y,u),g=Math.max(g,u),"function"!=typeof p&&(p=tr(p)),void 0!==h&&(p=1===p.length?fr(p)(...h):e.piecewise(p,h)),m&&(p=Qn(p)),d){const t=r.apply(u),e=t-r.apply(y),n=r.apply(g)-t;e<n?y=r.invert(t-n):e>n&&(g=r.invert(t+e))}return n.domain([y,u,g]).unknown(c).interpolator(p),l&&n.clamp(l),a&&n.nice(a),{type:i,domain:[y,g],pivot:u,interpolate:p,scale:n}}function dr(t,n,{exponent:r=1,...o}){return hr(t,e.scaleDivergingPow().exponent(r=+r),function(t){return.5===t?gr:{apply:e=>Math.sign(e)*Math.pow(Math.abs(e),t),invert:e=>Math.sign(e)*Math.pow(Math.abs(e),1/t)}}(r),n,{...o,type:"diverging-pow"})}function pr(t,n,{constant:r=1,...o}){return hr(t,e.scaleDivergingSymlog().constant(r=+r),function(t){return{apply:e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),invert:e=>Math.sign(e)*Math.expm1(Math.abs(e))*t}}(r),n,o)}const mr={apply:t=>t,invert:t=>t},yr={apply:Math.log,invert:Math.exp},gr={apply:t=>Math.sign(t)*Math.sqrt(Math.abs(t)),invert:t=>Math.sign(t)*(t*t)};function vr(t,e,n,r){return er(t,e,n,r)}const xr=Symbol("ordinal");function wr(t,n,r,{type:o,interval:i,domain:a,range:l,reverse:s,hint:c}){return i=Wt(i,o),void 0===a&&(a=$r(r,i,t)),"categorical"!==o&&o!==xr||(o="ordinal"),s&&(a=e.reverse(a)),a=n.domain(a).domain(),void 0!==l&&("function"==typeof l&&(l=l(a)),n.range(l)),{type:o,domain:a,range:l,scale:n,hint:c,interval:i}}function br(t,n,{type:r,interval:o,domain:i,range:a,scheme:l,unknown:s,...c}){let u;if(o=Wt(o,r),void 0===i&&(i=$r(n,o,t)),fe.get(t)===ce)u=function(t){return{fill:Mr(t,"fill"),stroke:Mr(t,"stroke")}}(n),a=void 0===a?function(t){return Jt(t.fill)?e.symbolsStroke:e.symbolsFill}(u):dt(a,ve);else if(fe.get(t)===ie&&(void 0!==a||"ordinal"!==r&&r!==xr||(a=function(t,e="greys"){const n=new Set,[r,o]=Hn(e,2);for(const e of t)if(null!=e)if(!0===e)n.add(o);else{if(!1!==e)return;n.add(r)}return[...n]}(i,l),void 0!==a&&(l=void 0)),void 0===l&&void 0===a&&(l="ordinal"===r?"turbo":"observable10"),void 0!==l))if(void 0!==a){const t=Vn(l),n=a[0],r=a[1]-a[0];a=({length:o})=>e.quantize((e=>t(n+r*e)),o)}else a=Xn(l);if(s===e.scaleImplicit)throw new Error(`implicit unknown on ${t} scale is not supported`);return wr(t,e.scaleOrdinal().unknown(s),n,{...c,type:r,domain:i,range:a,hint:u})}function kr(t,e,n,r){let{round:o}=n;return void 0!==o&&t.round(o=!!o),(t=wr(r,t,e,n)).round=o,t}function $r(t,n,o){const i=new e.InternSet;for(const{value:e,domain:n}of t){if(void 0!==n)return n();if(void 0!==e)for(const t of e)i.add(t)}if(void 0!==n){const[t,r]=e.extent(i).map(n.floor,n);return n.range(t,n.offset(r))}if(i.size>1e4&&fe.get(o)===oe)throw new Error(`implicit ordinal domain of ${o} scale has more than 10,000 values`);return e.sort(i,r)}function Mr(t,e){let n;for(const{hint:r}of t){const t=r?.[e];if(void 0!==t)if(void 0===n)n=t;else if(n!==t)return}return n}function Lr(t,{label:e,inset:n=0,insetTop:r=n,insetRight:o=n,insetBottom:i=n,insetLeft:a=n,round:l,nice:s,clamp:c,zero:u,align:f,padding:h,projection:d,facet:{label:p=e}={},...m}={}){const y={};for(const[n,g]of t){const t=m[n],v=Ir(n,g,{round:fe.get(n)===oe?l:void 0,nice:s,clamp:c,zero:u,align:f,padding:h,projection:d,...t});if(v){let{label:l=("fx"===n||"fy"===n?p:e),percent:s,transform:c,inset:u,insetTop:f=(void 0!==u?u:"y"===n?r:0),insetRight:h=(void 0!==u?u:"x"===n?o:0),insetBottom:d=(void 0!==u?u:"y"===n?i:0),insetLeft:m=(void 0!==u?u:"x"===n?a:0)}=t||{};if(null==c)c=void 0;else if("function"!=typeof c)throw new Error("invalid scale transform; not a function");v.percent=!!s,v.label=void 0===l?Sr(g,v):l,v.transform=c,"x"===n||"fx"===n?(v.insetLeft=+m,v.insetRight=+h):"y"!==n&&"fy"!==n||(v.insetTop=+f,v.insetBottom=+d),y[n]=v}}return y}function Ar(t){const e={},n={scales:e};for(const[r,o]of Object.entries(t)){const{scale:t,type:i,interval:a,label:l}=o;e[r]=Xr(o),n[r]=t,t.type=i,null!=a&&(t.interval=a),null!=l&&(t.label=l)}return n}function Sr(t=[],e){let n;for(const{label:e}of t)if(void 0!==e)if(void 0===n)n=e;else if(n!==e)return;if(void 0!==n)return!Fr(e)&&e.percent&&(n=`${n} (%)`),{inferred:!0,toString:()=>n}}function zr(t){return Math.sign(d(t.domain()))*Math.sign(d(t.range()))}function Or(t){const{marginTop:e,marginRight:n,marginBottom:r,marginLeft:o,width:i,height:a,facet:{marginTop:l,marginRight:s,marginBottom:c,marginLeft:u}}=t;return{marginTop:Math.max(e,l),marginRight:Math.max(n,s),marginBottom:Math.max(r,c),marginLeft:Math.max(o,u),width:i,height:a}}function Er({fx:t,fy:e},n){const{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:l,height:s}=Or(n);return{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:t?t.scale.bandwidth()+a+o:l,height:e?e.scale.bandwidth()+r+i:s,facet:{width:l,height:s}}}function Rr(t,e){if(void 0===t.range){const{insetLeft:n,insetRight:r}=t,{width:o,marginLeft:i=0,marginRight:a=0}=e,l=i+n,s=o-a-r;t.range=[l,Math.max(l,s)],Fr(t)||(t.range=Br(t)),t.scale.range(t.range)}Tr(t)}function Cr(t,e){if(void 0===t.range){const{insetTop:n,insetBottom:r}=t,{height:o,marginTop:i=0,marginBottom:a=0}=e,l=i+n,s=o-a-r;t.range=[Math.max(l,s),l],Fr(t)?t.range.reverse():t.range=Br(t),t.scale.range(t.range)}Tr(t)}function Tr(t){void 0===t.round&&function({type:t}){return"point"===t||"band"===t}(t)&&function({scale:t}){const e=t.domain().length,[n,r]=t.range(),o=t.paddingInner?t.paddingInner():1,i=t.paddingOuter?t.paddingOuter():t.padding(),a=e-o,l=Math.abs(r-n)/Math.max(1,a+2*i);return(l-Math.floor(l))*a}(t)<=30&&t.scale.round(!0)}function Br(t){const e=t.scale.domain().length+Dr(t);if(!(e>2))return t.range;const[n,r]=t.range;return Array.from({length:e},((t,o)=>n+o/(e-1)*(r-n)))}function Nr(t,e,n){return Ir(t,void 0===n?void 0:[{hint:n}],{...e})}function Ir(t,n=[],r={}){const o=function(t,e,{type:n,domain:r,range:o,scheme:i,pivot:a,projection:l}){if(n=Wr(n),"fx"===t||"fy"===t)return"band";"x"!==t&&"y"!==t||null==l||(n=jr);for(const t of e){const e=Wr(t.type);if(void 0!==e)if(void 0===n)n=e;else if(n!==e)throw new Error(`scale incompatible with channel: ${n} !== ${e}`)}if(n===jr)return;if(void 0!==n)return n;if(void 0===r&&!e.some((({value:t})=>void 0!==t)))return;const s=fe.get(t);if(s===ae)return"sqrt";if(s===se||s===le)return"linear";if(s===ce)return"ordinal";if((r||o||[]).length>2)return qr(s);if(void 0!==r){if(Yt(r))return qr(s);if(_t(r))return"utc"}else{const t=e.map((({value:t})=>t)).filter((t=>void 0!==t));if(t.some(Yt))return qr(s);if(t.some(_t))return"utc"}if(s===ie){if(null!=a||function(t){return null!=t&&Zn.has(`${t}`.toLowerCase())}(i))return"diverging";if(function(t){return null!=t&&jn.has(`${t}`.toLowerCase())}(i))return"categorical"}return"linear"}(t,n,r);if(void 0===r.type&&void 0===r.domain&&void 0===r.range&&null==r.interval&&"fx"!==t&&"fy"!==t&&Fr({type:o})){const e=n.map((({value:t})=>t)).filter((t=>void 0!==t));e.some(_t)?Ln(`Warning: some data associated with the ${t} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${Pr(o)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${t} scale to "${Pr(o)}".`):e.some(Gt)?Ln(`Warning: some data associated with the ${t} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${Pr(o)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${t} scale to "${Pr(o)}".`):e.some(Xt)&&Ln(`Warning: some data associated with the ${t} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${Pr(o)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${t} scale to "${Pr(o)}".`)}switch(r.type=o,o){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":r=_r(n,r,rt);break;case"identity":switch(fe.get(t)){case oe:r=_r(n,r,rt);break;case ce:r=_r(n,r,Gr)}break;case"utc":case"time":r=_r(n,r,at)}switch(o){case"diverging":return function(t,n,r){return hr(t,e.scaleDiverging(),mr,n,r)}(t,n,r);case"diverging-sqrt":return function(t,e,n){return dr(t,e,{...n,exponent:.5})}(t,n,r);case"diverging-pow":return dr(t,n,r);case"diverging-log":return function(t,n,{base:r=10,pivot:o=1,domain:i=or(n,o<0?s:l),...a}){return hr(t,e.scaleDivergingLog().base(r=+r),yr,n,{domain:i,pivot:o,...a})}(t,n,r);case"diverging-symlog":return pr(t,n,r);case"categorical":case"ordinal":case xr:return br(t,n,r);case"cyclical":case"sequential":case"linear":return function(t,n,r){return er(t,e.scaleLinear(),n,r)}(t,n,r);case"sqrt":return function(t,e,n){return nr(t,e,{...n,exponent:.5})}(t,n,r);case"threshold":return rr(t,0,r);case"quantile":return function(t,n,{range:r,quantiles:o=(void 0===r?5:(r=[...r]).length),n:i=o,scheme:a="rdylbu",domain:l=ur(n),unknown:s,interpolate:c,reverse:u}){return void 0===r&&(r=void 0!==c?e.quantize(c,i):fe.get(t)===ie?Hn(a,i):void 0),l.length>0&&(l=e.scaleQuantile(l,void 0===r?{length:i}:r).quantiles()),rr(t,0,{domain:l,range:r,reverse:u,unknown:s})}(t,n,r);case"quantize":return function(t,n,{range:r,n:o=(void 0===r?5:(r=[...r]).length),scheme:i="rdylbu",domain:a=ir(t,n),unknown:l,interpolate:s,reverse:c}){const[u,f]=e.extent(a);let h;return void 0===r?(h=e.ticks(u,f,o),h[0]<=u&&h.splice(0,1),h[h.length-1]>=f&&h.pop(),o=h.length+1,r=void 0!==s?e.quantize(s,o):fe.get(t)===ie?Hn(i,o):void 0):(h=e.quantize(e.interpolateNumber(u,f),o+1).slice(1,-1),u instanceof Date&&(h=h.map((t=>new Date(t))))),d(ht(a))<0&&h.reverse(),rr(t,0,{domain:h,range:r,reverse:c,unknown:l})}(t,n,r);case"pow":return nr(t,n,r);case"log":return function(t,n,{base:r=10,domain:o=cr(n),...i}){return er(t,e.scaleLog().base(r),n,{...i,domain:o})}(t,n,r);case"symlog":return function(t,n,{constant:r=1,...o}){return er(t,e.scaleSymlog().constant(r),n,o)}(t,n,r);case"utc":return function(t,n,r){return vr(t,e.scaleUtc(),n,r)}(t,n,r);case"time":return function(t,n,r){return vr(t,e.scaleTime(),n,r)}(t,n,r);case"point":return function(t,n,{align:r=.5,padding:o=.5,...i}){return kr(e.scalePoint().align(r).padding(o),n,i,t)}(t,n,r);case"band":return function(t,n,{align:r=.5,padding:o=.1,paddingInner:i=o,paddingOuter:a=("fx"===t||"fy"===t?0:o),...l}){return kr(e.scaleBand().align(r).paddingInner(i).paddingOuter(a),n,l,t)}(t,n,r);case"identity":return function(t){return{type:"identity",scale:(n=fe.get(t),n===oe||n===ae||n===le||n===se?e.scaleIdentity():t=>t)};var n}(t);case void 0:return;default:throw new Error(`unknown scale type: ${o}`)}}function Pr(t){return"symbol"==typeof t?t.description:t}function Wr(t){return"string"==typeof t?`${t}`.toLowerCase():t}const jr={toString:()=>"projection"};function qr(t){switch(t){case oe:return"point";case ie:return xr;default:return"ordinal"}}function Fr({type:t}){return"ordinal"===t||"point"===t||"band"===t||t===xr}function Dr({type:t}){return"threshold"===t}function Yr(t){if(void 0===t)return!0;const e=t.domain(),n=t(e[0]);for(let r=1,o=e.length;r<o;++r)if(t(e[r])-n)return!1;return!0}function _r(t,{domain:e,...n},r){for(const n of t)void 0!==n.value&&(void 0===e&&(e=n.value?.domain),n.value=r(n.value));return{domain:void 0===e?e:r(e),...n}}function Gr(t){return dt(t,ve)}function Xr({scale:t,type:e,domain:n,range:r,interpolate:o,interval:i,transform:a,percent:l,pivot:s}){if("identity"===e)return{type:"identity",apply:t=>t,invert:t=>t};const c=t.unknown?t.unknown():void 0;return{type:e,domain:pt(n),...void 0!==r&&{range:pt(r)},...void 0!==a&&{transform:a},...l&&{percent:l},...void 0!==c&&{unknown:c},...void 0!==i&&{interval:i},...void 0!==o&&{interpolate:o},...t.clamp&&{clamp:t.clamp()},...void 0!==s&&{pivot:s,symmetric:!1},...t.base&&{base:t.base()},...t.exponent&&{exponent:t.exponent()},...t.constant&&{constant:t.constant()},...t.align&&{align:t.align(),round:t.round()},...t.padding&&(t.paddingInner?{paddingInner:t.paddingInner(),paddingOuter:t.paddingOuter()}:{padding:t.padding()}),...t.bandwidth&&{bandwidth:t.bandwidth(),step:t.step()},apply:e=>t(e),...t.invert&&{invert:e=>t.invert(e)}}}function Hr(t){let e,n;return(...r)=>((n?.length!==r.length||n.some(((t,e)=>t!==r[e])))&&(n=r,e=t(...r)),e)}const Ur=Hr((t=>new Intl.NumberFormat(t))),Vr=Hr(((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...e&&{month:e}}))),Zr=Hr(((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...e&&{weekday:e}})));function Qr(t){return c(t,"Invalid Date")}const Jr=function(t="en-US"){const e=function(t="en-US"){const e=Ur(t);return t=>null==t||isNaN(t)?void 0:e.format(t)}(t);return t=>(t instanceof Date?Qr:"number"==typeof t?e:Z)(t)}(),Kr=("undefined"!=typeof window?window.devicePixelRatio>1:"undefined"==typeof it)?0:.5;let to=0;function eo(){return"plot-clip-"+ ++to}function no(t,{title:e,href:n,ariaLabel:r,ariaDescription:o,ariaHidden:i,target:a,fill:l,fillOpacity:s,stroke:c,strokeWidth:u,strokeOpacity:f,strokeLinejoin:h,strokeLinecap:d,strokeMiterlimit:p,strokeDasharray:m,strokeDashoffset:y,opacity:g,mixBlendMode:v,imageFilter:x,paintOrder:w,pointerEvents:b,shapeRendering:k,channels:$},{ariaLabel:M,fill:L="currentColor",fillOpacity:A,stroke:S="none",strokeOpacity:z,strokeWidth:O,strokeLinecap:E,strokeLinejoin:R,strokeMiterlimit:C,paintOrder:T}){null===L&&(l=null,s=null),null===S&&(c=null,f=null),Jt(L)?Jt(S)||Jt(l)&&!$?.fill||(S="none"):!Jt(S)||Jt(c)&&!$?.stroke||(L="none");const[B,N]=st(l,L),[I,P]=ct(s,A),[W,j]=st(c,S),[q,F]=ct(f,z),[D,Y]=ct(g);Kt(j)||(void 0===u&&(u=O),void 0===d&&(d=E),void 0===h&&(h=R),void 0!==p||/^\s*round\s*$/i.test(h)||(p=C),Kt(N)||void 0!==w||(w=T));const[_,G]=ct(u);return null!==L&&(t.fill=mo(N,"currentColor"),t.fillOpacity=yo(P,1)),null!==S&&(t.stroke=mo(j,"none"),t.strokeWidth=yo(G,1),t.strokeOpacity=yo(F,1),t.strokeLinejoin=mo(h,"miter"),t.strokeLinecap=mo(d,"butt"),t.strokeMiterlimit=yo(p,4),t.strokeDasharray=mo(m,"none"),t.strokeDashoffset=mo(y,"0")),t.target=Z(a),t.ariaLabel=Z(M),t.ariaDescription=Z(o),t.ariaHidden=Z(i),t.opacity=yo(Y,1),t.mixBlendMode=mo(v,"normal"),t.imageFilter=mo(x,"none"),t.paintOrder=mo(w,"normal"),t.pointerEvents=mo(b,"auto"),t.shapeRendering=mo(k,"auto"),{title:{value:e,optional:!0,filter:null},href:{value:n,optional:!0,filter:null},ariaLabel:{value:r,optional:!0,filter:null},fill:{value:B,scale:"auto",optional:!0},fillOpacity:{value:I,scale:"auto",optional:!0},stroke:{value:W,scale:"auto",optional:!0},strokeOpacity:{value:q,scale:"auto",optional:!0},strokeWidth:{value:_,optional:!0},opacity:{value:D,scale:"auto",optional:!0}}}function ro(t,e){e&&t.text((t=>Jr(e[t])))}function oo(t,e){e&&t.text((([t])=>Jr(e[t])))}function io(t,{target:e,tip:n},{ariaLabel:r,title:o,fill:a,fillOpacity:l,stroke:s,strokeOpacity:c,strokeWidth:u,opacity:f,href:h}){r&&ho(t,"aria-label",(t=>r[t])),a&&ho(t,"fill",(t=>a[t])),l&&ho(t,"fill-opacity",(t=>l[t])),s&&ho(t,"stroke",(t=>s[t])),c&&ho(t,"stroke-opacity",(t=>c[t])),u&&ho(t,"stroke-width",(t=>u[t])),f&&ho(t,"opacity",(t=>f[t])),h&&fo(t,(t=>h[t]),e),n||function(t,e){e&&t.filter((t=>i(e[t]))).append("title").call(ro,e)}(t,o)}function ao(t,{target:e,tip:n},{ariaLabel:r,title:o,fill:a,fillOpacity:l,stroke:s,strokeOpacity:c,strokeWidth:u,opacity:f,href:h}){r&&ho(t,"aria-label",(([t])=>r[t])),a&&ho(t,"fill",(([t])=>a[t])),l&&ho(t,"fill-opacity",(([t])=>l[t])),s&&ho(t,"stroke",(([t])=>s[t])),c&&ho(t,"stroke-opacity",(([t])=>c[t])),u&&ho(t,"stroke-width",(([t])=>u[t])),f&&ho(t,"opacity",(([t])=>f[t])),h&&fo(t,(([t])=>h[t]),e),n||function(t,e){e&&t.filter((([t])=>i(e[t]))).append("title").call(oo,e)}(t,o)}function lo(t,n,r){const o=e.group(t,(t=>n[t]));return void 0===r&&o.size>1+t.length>>1&&Ln("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),o.values()}function*so(t,e,r,o){const{z:i}=r,{z:a}=o,l=function({ariaLabel:t,title:e,fill:n,fillOpacity:r,stroke:o,strokeOpacity:i,strokeWidth:a,opacity:l,href:s},{tip:c}){return[t,c?void 0:e,n,r,o,i,a,l,s].filter((t=>void 0!==t))}(o,r),s=[...e,...l];for(const e of a?lo(t,a,i):[t]){let t,r;t:for(const o of e){for(const t of s)if(!n(t[o])){r&&r.push(-1);continue t}if(void 0!==t){r.push(o);for(let e=0;e<l.length;++e){if(Ot(l[e][o])!==t[e]){yield r,t=l.map((t=>Ot(t[o]))),r=[o];continue t}}}else r&&(yield r),t=l.map((t=>Ot(t[o]))),r=[o]}r&&(yield r)}}function co(t,n,r,o){!function(t,n,r,o){let i;const{clip:a=o.clip}=n;switch(a){case"frame":{const{width:e,height:n,marginLeft:a,marginRight:l,marginTop:s,marginBottom:c}=r,u=eo();i=`url(#${u})`,t=kn("svg:g",o).call((t=>t.append("svg:clipPath").attr("id",u).append("rect").attr("x",a).attr("y",s).attr("width",e-l-a).attr("height",n-s-c))).each((function(){this.appendChild(t.node()),t.node=()=>this}));break}case"sphere":{const{projection:n}=o;if(!n)throw new Error('the "sphere" clip option requires a projection');const r=eo();i=`url(#${r})`,t.append("clipPath").attr("id",r).append("path").attr("d",e.geoPath(n)({type:"Sphere"}));break}}ho(t,"aria-label",n.ariaLabel),ho(t,"aria-description",n.ariaDescription),ho(t,"aria-hidden",n.ariaHidden),ho(t,"clip-path",i)}(t,n,r,o),ho(t,"fill",n.fill),ho(t,"fill-opacity",n.fillOpacity),ho(t,"stroke",n.stroke),ho(t,"stroke-width",n.strokeWidth),ho(t,"stroke-opacity",n.strokeOpacity),ho(t,"stroke-linejoin",n.strokeLinejoin),ho(t,"stroke-linecap",n.strokeLinecap),ho(t,"stroke-miterlimit",n.strokeMiterlimit),ho(t,"stroke-dasharray",n.strokeDasharray),ho(t,"stroke-dashoffset",n.strokeDashoffset),ho(t,"shape-rendering",n.shapeRendering),ho(t,"filter",n.imageFilter),ho(t,"paint-order",n.paintOrder);const{pointerEvents:i=(!1===o.pointerSticky?"none":void 0)}=n;ho(t,"pointer-events",i)}function uo(t,e){!function(t,e,n){null!=n&&t.style(e,n)}(t,"mix-blend-mode",e.mixBlendMode),ho(t,"opacity",e.opacity)}function fo(t,n,r){t.each((function(t){const o=n(t);if(null!=o){const t=this.ownerDocument.createElementNS(e.namespaces.svg,"a");t.setAttribute("fill","inherit"),t.setAttributeNS(e.namespaces.xlink,"href",o),null!=r&&t.setAttribute("target",r),this.parentNode.insertBefore(t,this).appendChild(this)}}))}function ho(t,e,n){null!=n&&t.attr(e,n)}function po(t,e,{x:n,y:r},o=Kr,i=Kr){o+=e.dx,i+=e.dy,n?.bandwidth&&(o+=n.bandwidth()/2),r?.bandwidth&&(i+=r.bandwidth()/2),(o||i)&&t.attr("transform",`translate(${o},${i})`)}function mo(t,e){if((t=Z(t))!==e)return t}function yo(t,e){if((t=Q(t))!==e)return t}const go=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/i;function vo(t){if(void 0===t)return"plot-d6a7b5";if(t=`${t}`,!go.test(t))throw new Error(`invalid class name: ${t}`);return t}function xo(t,e){if("string"==typeof e)t.property("style",e);else if(null!=e)for(const n of t)Object.assign(n.style,e)}function wo({frameAnchor:t},{width:e,height:n,marginTop:r,marginRight:o,marginBottom:i,marginLeft:a}){return[/left$/.test(t)?a:/right$/.test(t)?e-o:(a+e-o)/2,/^top/.test(t)?r:/^bottom/.test(t)?n-i:(r+n-i)/2]}function bo({x:t,y:e,fy:n,fx:r},{projection:o,aspectRatio:i},{width:a,marginTopDefault:l,marginRightDefault:s,marginBottomDefault:c,marginLeftDefault:u}){const f=n?n.scale.domain().length:1,h=function(t){if("function"==typeof t?.stream)return zn;if(vt(t)&&(t=t.type),null!=t){if("function"!=typeof t){const{aspectRatio:e}=En(t);if(e)return e}return zn}}(o);if(h){const t=(1.1*f-.1)/(1.1*(r?r.scale.domain().length:1)-.1)*h,e=Math.max(.1,Math.min(10,t));return Math.round((a-u-s)*e+l+c)}const d=e?Fr(e)?e.scale.domain().length:Math.max(7,17/f):1;if(null!=i){if(i=+i,!(isFinite(i)&&i>0))throw new Error(`invalid aspectRatio: ${i}`);const o=ko("y",e)/(ko("x",t)*i),f=r?r.scale.bandwidth():1,h=n?n.scale.bandwidth():1;return(o*(f*(a-u-s)-t.insetLeft-t.insetRight)+e.insetTop+e.insetBottom)/h+l+c}return!(!e&&!n)*Math.max(1,Math.min(60,d*f))*20+30*!!r+60}function ko(t,n){if(!n)throw new Error(`aspectRatio requires ${t} scale`);const{type:r,domain:o}=n;let i;switch(r){case"linear":case"utc":case"time":i=Number;break;case"pow":{const t=n.scale.exponent();i=e=>Math.pow(e,t);break}case"log":i=Math.log;break;case"point":case"band":return o.length;default:throw new Error(`unsupported ${t} scale for aspectRatio: ${r}`)}const[a,l]=e.extent(o);return Math.abs(i(l)-i(a))}function $o(t,{fx:n,fy:r}){const o=Lt(t),i=n?.value,a=r?.value;return n&&r?e.rollup(o,(t=>(t.fx=i[t[0]],t.fy=a[t[0]],t)),(t=>i[t]),(t=>a[t])):n?e.rollup(o,(t=>(t.fx=i[t[0]],t)),(t=>i[t])):e.rollup(o,(t=>(t.fy=a[t[0]],t)),(t=>a[t]))}function Mo(t){const n=[],r=new Uint32Array(e.sum(t,(t=>t.length)));for(const e of t){let o=0;for(const n of t)e!==n&&(r.set(n,o),o+=n.length);n.push(r.slice(0,o))}return n}const Lo=new Map([["top",Eo],["right",To],["bottom",Ro],["left",Co],["top-left",Bo(Eo,Co)],["top-right",Bo(Eo,To)],["bottom-left",Bo(Ro,Co)],["bottom-right",Bo(Ro,To)],["top-empty",function(t,{y:e},{x:n,y:r,empty:o}){if(o)return!1;if(!e)return;const i=zo(e,r);if(i>0)return Oo(t,n,e[i-1])}],["right-empty",function(t,{x:e},{x:n,y:r,empty:o}){if(o)return!1;if(!e)return;const i=zo(e,n);if(i<e.length-1)return Oo(t,e[i+1],r)}],["bottom-empty",function(t,{y:e},{x:n,y:r,empty:o}){if(o)return!1;if(!e)return;const i=zo(e,r);if(i<e.length-1)return Oo(t,n,e[i+1])}],["left-empty",function(t,{x:e},{x:n,y:r,empty:o}){if(o)return!1;if(!e)return;const i=zo(e,n);if(i>0)return Oo(t,e[i-1],r)}],["empty",function(t,e,{empty:n}){return n}]]);const Ao=new WeakMap;function So(t){let n=Ao.get(t);return n||Ao.set(t,n=new e.InternMap(dt(t,((t,e)=>[t,e])))),n}function zo(t,e){return So(t).get(e)}function Oo(t,e,n){return function(t,e,n){return e=Ot(e),n=Ot(n),t.find((t=>Object.is(Ot(t.x),e)&&Object.is(Ot(t.y),n)))}(t,e,n)?.empty}function Eo(t,{y:e},{y:n}){return!e||0===zo(e,n)}function Ro(t,{y:e},{y:n}){return!e||zo(e,n)===e.length-1}function Co(t,{x:e},{x:n}){return!e||0===zo(e,n)}function To(t,{x:e},{x:n}){return!e||zo(e,n)===e.length-1}function Bo(t,e){return function(){return t.apply(null,arguments)&&e.apply(null,arguments)}}function No(t,{channels:{fx:e,fy:n},groups:r}){return e&&n?t.map((({x:t,y:e})=>r.get(t)?.get(e)??[])):e?t.map((({x:t})=>r.get(t)??[])):t.map((({y:t})=>r.get(t)??[]))}class Io{constructor(t,e={},n={},r){const{facet:o="auto",facetAnchor:i,fx:a,fy:l,sort:s,dx:c=0,dy:u=0,margin:f=0,marginTop:h=f,marginRight:d=f,marginBottom:p=f,marginLeft:m=f,clip:y=r?.clip,channels:g,tip:v,render:x}=n;if(this.data=t,this.sort=bt(s)?s:null,this.initializer=we(n).initializer,this.transform=this.initializer?n.transform:xe(n).transform,null===o||!1===o?this.facet=null:(this.facet=ft(!0===o?"include":o,"facet",["auto","include","exclude","super"]),this.fx=t===_&&"string"==typeof a?[a]:a,this.fy=t===_&&"string"==typeof l?[l]:l),this.facetAnchor=function(t){if(null==t)return null;const e=Lo.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid facet anchor: ${t}`)}(i),e=ne(e),void 0!==g&&(e={...jo(g),...e}),void 0!==r&&(e={...no(this,n,r),...e}),this.channels=Object.fromEntries(Object.entries(e).map((([e,n])=>{if(wt(n.value)){const{value:t,label:e=n.label,scale:r=n.scale}=n.value;n={...n,label:e,scale:r,value:t}}if(t===_&&"string"==typeof n.value){const{value:t}=n;n={...n,value:[t]}}return[e,n]})).filter((([t,{value:e,optional:n}])=>{if(null!=e)return!0;if(n)return!1;throw new Error(`missing channel value: ${t}`)}))),this.dx=+c,this.dy=+u,this.marginTop=+h,this.marginRight=+d,this.marginBottom=+p,this.marginLeft=+m,this.clip=re(y),this.tip=function(t){return!0===t?"xy":!1===t||null==t?null:"string"==typeof t?ft(t,"tip",["x","y","xy"]):t}(v),"super"===this.facet){if(a||l)throw new Error("super-faceting cannot use fx or fy");for(const t in this.channels){const{scale:n}=e[t];if("x"===n||"y"===n)throw new Error("super-faceting cannot use x or y")}}null!=x&&(this.render=Wo(x,this.render))}initialize(t,n,r){let o=ht(this.data);void 0===t&&null!=o&&(t=[Lt(o)]);const i=t;null!=this.transform&&(({facets:t,data:o}=this.transform(o,t,r)),o=ht(o)),void 0!==t&&(t.original=i);const a=un(this.channels,o);return null!=this.sort&&function(t,n,r,o,i){const{order:a,reverse:l,reduce:s=!0,limit:c}=i;for(const u in i){if(!fe.has(u))continue;let{value:f,order:h=a,reverse:d=l,reduce:p=s,limit:m=c}=qt(i[u]);const y=f?.startsWith("-");if(y&&(f=f.slice(1)),h=void 0===h?y!==("width"===f||"height"===f)?xn:vn:gn(h),null==p||!1===p)continue;const g="fx"===u||"fy"===u?pn(n,o[u]):dn(r,u);if(!g)throw new Error(`missing channel for scale: ${u}`);const v=g.value,[x=0,w=1/0]=Ft(m)?m:m<0?[m]:[0,m];if(null==f)g.domain=()=>{let t=Array.from(new e.InternSet(v));return d&&(t=t.reverse()),0===x&&w===1/0||(t=t.slice(x,w)),t};else{const n="data"===f?t:"height"===f?mn(r,"y1","y2"):"width"===f?mn(r,"x1","x2"):yn(r,f,"y"===f?"y2":"x"===f?"x2":void 0),o=qe(!0===p?"max":p,n);g.domain=()=>{let t=e.rollups(Lt(v),(t=>o.reduceIndex(t,n)),(t=>v[t]));return h&&t.sort(h),d&&t.reverse(),0===x&&w===1/0||(t=t.slice(x,w)),t.map(J)}}}}(o,t,a,n,this.sort),{data:o,facets:t,channels:a}}filter(t,e,r){for(const o in e){const{filter:i=n}=e[o];if(null!==i){const e=r[o];t=t.filter((t=>i(e[t])))}}return t}project(t,e,n){for(const r in t)if("x"===t[r].scale&&/^x|x$/.test(r)){const o=r.replace(/^x|x$/,"y");o in t&&"y"===t[o].scale&&Nn(r,o,e,n.projection)}}scale(t,e,n){const r=fn(t,e);return n.projection&&this.project(t,r,n),r}}function Po(...t){return t.plot=Io.prototype.plot,t}function Wo(t,e){if(null==t)return null===e?void 0:e;if(null==e)return null===t?void 0:t;if("function"!=typeof t)throw new TypeError(`invalid render transform: ${t}`);if("function"!=typeof e)throw new TypeError(`invalid render transform: ${e}`);return function(n,r,o,i,a,l){return t.call(this,n,r,o,i,a,((t,n,r,o,i)=>e.call(this,t,n,r,o,i,l)))}}function jo(t){return Object.fromEntries(Object.entries(ne(t)).map((([t,e])=>(void 0===(e="string"==typeof e?{value:e,label:t}:qt(e)).filter&&null==e.scale&&(e={...e,filter:null}),[t,e]))))}function qo(t,e){return!0===t?.tip?{...t,tip:e}:vt(t?.tip)&&void 0===t.tip.pointer?{...t,tip:{...t.tip,pointer:e}}:t}const Fo=new WeakMap;function Do(t,n,{x:r,y:o,px:i,py:a,maxRadius:l=40,channels:s,render:c,...u}={}){return l=+l,null!=i&&(r??=null,s={...s,px:{value:i,scale:"x"}}),null!=a&&(o??=null,s={...s,py:{value:a,scale:"y"}}),{x:r,y:o,channels:s,...u,render:Wo((function(r,o,i,a,s,c){const u=(s={...s,pointerSticky:!1}).ownerSVGElement,{data:f}=s.getMarkState(this);let h=Fo.get(u);h||Fo.set(u,h={sticky:!1,roots:[],renders:[]});let d=h.renders.push(T)-1;const{x:p,y:m,fx:y,fy:g}=o;let v=y?y(r.fx)-a.marginLeft:0,x=g?g(r.fy)-a.marginTop:0;p?.bandwidth&&(v+=p.bandwidth()/2),m?.bandwidth&&(x+=m.bandwidth()/2);const w=null!=r.fi;let b;if(w){let t=h.facetStates;t||(h.facetStates=t=new Map),b=t.get(this),b||t.set(this,b=new Map)}const[k,$]=wo(this,a),{px:M,py:L}=i,A=M?t=>M[t]:Xo(i,k),S=L?t=>L[t]:Ho(i,$);let z,O,E,R;function C(t,e){if(w){if(R&&(R=cancelAnimationFrame(R)),null!=t)return b.set(r.fi,e),void(R=requestAnimationFrame((()=>{R=null;for(const[n,o]of b)if(o<e||o===e&&n<r.fi){t=null;break}T(t)})));b.delete(r.fi)}T(t)}function T(t){if(z===t&&E===h.sticky)return;z=t,E=s.pointerSticky=h.sticky;const e=null==z?[]:[z];w&&(e.fx=r.fx,e.fy=r.fy,e.fi=r.fi);const n=c(e,o,i,a,s);if(O){if(w){const t=O.parentNode,e=O.getAttribute("transform"),r=n.getAttribute("transform");e?n.setAttribute("transform",e):n.removeAttribute("transform"),r?t.setAttribute("transform",r):t.removeAttribute("transform"),n.removeAttribute("aria-label"),n.removeAttribute("aria-description"),n.removeAttribute("aria-hidden")}O.replaceWith(n)}return h.roots[d]=O=n,null==z&&b?.size>1||s.dispatchValue(null==z?null:f[z]),n}function B(o){if(h.sticky||"mouse"===o.pointerType&&1===o.buttons)return;let[i,s]=e.pointer(o);i-=v,s-=x;const c=i<a.marginLeft||i>a.width-a.marginRight?1:t,u=s<a.marginTop||s>a.height-a.marginBottom?1:n;let f=null,d=l*l;for(const t of r){const e=c*(A(t)-i),n=u*(S(t)-s),r=e*e+n*n;r<=d&&(f=t,d=r)}if(null!=f&&(1!==t||1!==n)){const t=A(f)-i,e=S(f)-s;d=t*t+e*e}C(f,d)}return u.addEventListener("pointerenter",B),u.addEventListener("pointermove",B),u.addEventListener("pointerdown",(function(t){"mouse"===t.pointerType&&null!=z&&(h.sticky&&h.roots.some((e=>e?.contains(t.target)))||(h.sticky?(h.sticky=!1,h.renders.forEach((t=>t(null)))):(h.sticky=!0,T(z)),t.stopImmediatePropagation()))})),u.addEventListener("pointerleave",(function(t){"mouse"===t.pointerType&&(h.sticky||C(null))})),T(null)}),c)}}function Yo(t){return Do(1,1,t)}function _o(t){return Do(1,.01,t)}function Go(t){return Do(.01,1,t)}function Xo({x1:t,x2:e,x:n=t},r){return t&&e?n=>(t[n]+e[n])/2:n?t=>n[t]:()=>r}function Ho({y1:t,y2:e,y:n=t},r){return t&&e?n=>(t[n]+e[n])/2:n?t=>n[t]:()=>r}function Uo(t){return Fr(t)&&void 0===t.interval?void 0:"tabular-nums"}const Vo=Math.PI/180;function Zo(t,{marker:e,markerStart:n=e,markerMid:r=e,markerEnd:o=e}={}){t.markerStart=Qo(n),t.markerMid=Qo(r),t.markerEnd=Qo(o)}function Qo(t){if(null==t||!1===t)return null;if(!0===t)return ti;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"none":return null;case"arrow":return Jo("auto");case"arrow-reverse":return Jo("auto-start-reverse");case"dot":return Ko;case"circle":case"circle-fill":return ti;case"circle-stroke":return ei;case"tick":return ni("auto");case"tick-x":return ni(90);case"tick-y":return ni(0)}throw new Error(`invalid marker: ${t}`)}function Jo(t){return(e,n)=>kn("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient",t).attr("fill","none").attr("stroke",e).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call((t=>t.append("path").attr("d","M-1.5,-3l3,3l-3,3"))).node()}function Ko(t,e){return kn("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","none").call((t=>t.append("circle").attr("r",2.5))).node()}function ti(t,e){return kn("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","var(--plot-background)").attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}function ei(t,e){return kn("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","var(--plot-background)").attr("stroke",t).attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}function ni(t){return(e,n)=>kn("svg:marker",n).attr("viewBox","-3 -3 6 6").attr("markerWidth",6).attr("markerHeight",6).attr("orient",t).attr("stroke",e).call((t=>t.append("path").attr("d","M0,-3v6"))).node()}let ri=0;function oi(t,e,{stroke:n},r){return ai(t,e,n&&(t=>n[t]),r)}function ii(t,e,{stroke:n},r){return ai(t,e,n&&(([t])=>n[t]),r)}function ai(t,{markerStart:e,markerMid:n,markerEnd:r,stroke:o},i=(()=>o),a){const l=new Map;function s(t){return function(e){const n=i(e);let r=l.get(t);r||l.set(t,r=new Map);let o=r.get(n);if(!o){const e=this.parentNode.insertBefore(t(n,a),this),i="plot-marker-"+ ++ri;e.setAttribute("id",i),r.set(n,o=`url(#${i})`)}return o}}e&&t.attr("marker-start",s(e)),n&&t.attr("marker-mid",s(n)),r&&t.attr("marker-end",s(r))}function li({inset:t,insetLeft:e,insetRight:n,...r}={}){return[e,n]=ci(t,e,n),{inset:t,insetLeft:e,insetRight:n,...r}}function si({inset:t,insetTop:e,insetBottom:n,...r}={}){return[e,n]=ci(t,e,n),{inset:t,insetTop:e,insetBottom:n,...r}}function ci(t,e,n){return void 0===t&&void 0===e&&void 0===n?Kr?[1,0]:[.5,.5]:[e,n]}function ui(t,{interval:e}){return(t={...qt(t)}).interval=Pt(void 0===t.interval?e:t.interval),t}function fi(t,e,n,r){const{[t]:o,[`${t}1`]:i,[`${t}2`]:a}=n,{value:l,interval:s}=ui(o,n);if(null==l||null==s&&!r)return n;const c=Tt(o);if(null==s){let e;const o={transform:t=>e||(e=F(t,l)),label:c};return{...n,[t]:void 0,[`${t}1`]:void 0===i?o:i,[`${t}2`]:void 0!==a||i===a&&r?a:o}}let u,f;function h(t){return void 0!==f&&t===u?f:f=dt(F(u=t,l),(t=>s.floor(t)))}return e({...n,[t]:void 0,[`${t}1`]:void 0===i?{transform:h,label:c}:i,[`${t}2`]:void 0===a?{transform:t=>h(t).map((t=>s.offset(t))),label:c}:a})}function hi(t,e,n){const{[t]:r}=n,{value:o,interval:i}=ui(r,n);return null==o||null==i?n:e({...n,[t]:{label:Tt(r),transform:t=>{const e=dt(F(t,o),(t=>i.floor(t))),n=e.map((t=>i.offset(t)));return e.map(_t(e)?(t,e)=>null==t||isNaN(t=+t)||null==(e=n[e])||isNaN(e=+e)?void 0:new Date((t+e)/2):(t,e)=>null==t||null==(e=n[e])?NaN:(+t+ +e)/2)}}})}function di(t={}){return fi("x",li,t,!0)}function pi(t={}){return fi("y",si,t,!0)}function mi(t={}){return fi("x",li,t)}function yi(t={}){return fi("y",si,t)}function gi(t={}){return hi("x",li,t)}function vi(t={}){return hi("y",si,t)}const xi={ariaLabel:"rule",fill:null,stroke:"currentColor"};class wi extends Io{constructor(t,e={}){const{x:n,y1:r,y2:o,inset:i=0,insetTop:a=i,insetBottom:l=i}=e;super(t,{x:{value:n,scale:"x",optional:!0},y1:{value:r,scale:"y",optional:!0},y2:{value:o,scale:"y",optional:!0}},qo(e,"x"),xi),this.insetTop=Q(a),this.insetBottom=Q(l),Zo(this,e)}render(t,e,n,r,o){const{x:i,y:a}=e,{x:l,y1:s,y2:c}=n,{width:u,height:f,marginTop:h,marginRight:d,marginLeft:p,marginBottom:m}=r,{insetTop:y,insetBottom:g}=this;return kn("svg:g",o).call(co,this,r,o).call(po,this,{x:l&&i},Kr,0).call((e=>e.selectAll().data(t).enter().append("line").call(uo,this).attr("x1",l?t=>l[t]:(p+u-d)/2).attr("x2",l?t=>l[t]:(p+u-d)/2).attr("y1",s&&!Yr(a)?t=>s[t]+y:h+y).attr("y2",c&&!Yr(a)?a.bandwidth?t=>c[t]+a.bandwidth()-g:t=>c[t]-g:f-m-g).call(io,this,n).call(oi,this,n,o))).node()}}class bi extends Io{constructor(t,e={}){const{x1:n,x2:r,y:o,inset:i=0,insetRight:a=i,insetLeft:l=i}=e;super(t,{y:{value:o,scale:"y",optional:!0},x1:{value:n,scale:"x",optional:!0},x2:{value:r,scale:"x",optional:!0}},qo(e,"y"),xi),this.insetRight=Q(a),this.insetLeft=Q(l),Zo(this,e)}render(t,e,n,r,o){const{x:i,y:a}=e,{y:l,x1:s,x2:c}=n,{width:u,height:f,marginTop:h,marginRight:d,marginLeft:p,marginBottom:m}=r,{insetLeft:y,insetRight:g}=this;return kn("svg:g",o).call(co,this,r,o).call(po,this,{y:l&&a},0,Kr).call((e=>e.selectAll().data(t).enter().append("line").call(uo,this).attr("x1",s&&!Yr(i)?t=>s[t]+y:p+y).attr("x2",c&&!Yr(i)?i.bandwidth?t=>c[t]+i.bandwidth()-g:t=>c[t]-g:u-d-g).attr("y1",l?t=>l[t]:(h+f-m)/2).attr("y2",l?t=>l[t]:(h+f-m)/2).call(io,this,n).call(oi,this,n,o))).node()}}function ki(t,e){let{x:n=H,y:r,y1:o,y2:i,...a}=yi(e);return[o,i]=Mi(r,o,i),new wi(t,{...a,x:n,y1:o,y2:i})}function $i(t,e){let{y:n=H,x:r,x1:o,x2:i,...a}=mi(e);return[o,i]=Mi(r,o,i),new bi(t,{...a,y:n,x1:o,x2:i})}function Mi(t,e,n){if(null==t){if(void 0===e){if(void 0!==n)return[0,n]}else if(void 0===n)return[0,e]}else{if(void 0===e)return void 0===n?[0,t]:[t,n];if(void 0===n)return[t,e]}return[e,n]}function Li(t,...e){let n=e.length;for(let r=0,o=!0;r<n;++r)"function"!=typeof e[r]&&(o&&(t=t.slice(),o=!1),t.splice(r,2,t[r]+e[r]+t[r+1]),e.splice(r,1),--r,--n);return r=>{let o=t[0];for(let i=0;i<n;++i)o+=e[i](r)+t[i+1];return o}}const Ai={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"},Si="­";class zi extends Io{constructor(t,e={}){const{x:n,y:r,text:o=(Ft(t)&&Dt(t)?H:X),frameAnchor:a,textAnchor:l=(/right$/i.test(a)?"end":/left$/i.test(a)?"start":"middle"),lineAnchor:s=(/^top/i.test(a)?"top":/^bottom/i.test(a)?"bottom":"middle"),lineHeight:c=1,lineWidth:u=1/0,textOverflow:f,monospace:h,fontFamily:d=(h?"ui-monospace, monospace":void 0),fontSize:p,fontStyle:m,fontVariant:y,fontWeight:g,rotate:v}=e,[x,w]=ct(v,0),[b,k]=function(t){return null==t||"number"==typeof t?[void 0,t]:"string"!=typeof t?[t,void 0]:(t=t.trim().toLowerCase(),Ni.has(t)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(t)?[void 0,t]:[t,void 0])}(p);var $;if(super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},fontSize:{value:b,optional:!0},rotate:{value:($=x,null==$?null:{transform:t=>F(t,$,Float64Array),label:Tt($)}),optional:!0},text:{value:o,filter:i,optional:!0}},e,Ai),this.rotate=w,this.textAnchor=mo(l,"middle"),this.lineAnchor=ft(s,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+c,this.lineWidth=+u,this.textOverflow=Oi(f),this.monospace=!!h,this.fontFamily=Z(d),this.fontSize=k,this.fontStyle=Z(m),this.fontVariant=Z(y),this.fontWeight=Z(g),this.frameAnchor=ee(a),!(this.lineWidth>=0))throw new Error(`invalid lineWidth: ${u}`);this.splitLines=qi(this),this.clipLine=Fi(this)}render(t,e,n,r,o){const{x:i,y:a}=e,{x:l,y:s,rotate:c,text:u,title:f,fontSize:h}=n,{rotate:d}=this,[p,m]=wo(this,r);return kn("svg:g",o).call(co,this,r,o).call(Bi,this,u,r).call(po,this,{x:l&&i,y:s&&a}).call((e=>e.selectAll().data(t).enter().append("text").call(uo,this).call(Ei,this,u,f).attr("transform",Li`translate(${l?t=>l[t]:p},${s?t=>s[t]:m})${c?t=>` rotate(${c[t]})`:d?` rotate(${d})`:""}`).call(ho,"font-size",h&&(t=>h[t])).call(io,this,n))).node()}}function Oi(t){return null==t?null:ft(t,"textOverflow",["clip","ellipsis","clip-start","clip-end","ellipsis-start","ellipsis-middle","ellipsis-end"]).replace(/^(clip|ellipsis)$/,"$1-end")}function Ei(t,n,r,o){if(!r)return;const{lineAnchor:i,lineHeight:a,textOverflow:l,splitLines:s,clipLine:c}=n;t.each((function(t){const n=s(Jr(r[t])??"").map(c),u=n.length,f="top"===i?.71:"bottom"===i?1-u:(164-100*u)/200;if(u>1){let t=0;for(let r=0;r<u;++r){if(++t,!n[r])continue;const o=this.ownerDocument.createElementNS(e.namespaces.svg,"tspan");o.setAttribute("x",0),r===t-1?o.setAttribute("y",(f+r)*a+"em"):o.setAttribute("dy",t*a+"em"),o.textContent=n[r],this.appendChild(o),t=0}}else f&&this.setAttribute("y",f*a+"em"),this.textContent=n[0];if(l&&!o&&n[0]!==r[t]){const n=this.ownerDocument.createElementNS(e.namespaces.svg,"title");n.textContent=r[t],this.appendChild(n)}}))}function Ri(t,{x:e,y:n,...r}={}){return void 0===r.frameAnchor&&([e,n]=$t(e,n)),new zi(t,{...r,x:e,y:n})}function Ci(t,{x:e=H,...n}={}){return new zi(t,vi({...n,x:e}))}function Ti(t,{y:e=H,...n}={}){return new zi(t,gi({...n,y:e}))}function Bi(t,e,n){ho(t,"text-anchor",e.textAnchor),ho(t,"font-family",e.fontFamily),ho(t,"font-size",e.fontSize),ho(t,"font-style",e.fontStyle),ho(t,"font-variant",void 0===e.fontVariant?function(t){return t&&(Ht(t)||_t(t))?"tabular-nums":void 0}(n):e.fontVariant),ho(t,"font-weight",e.fontWeight)}const Ni=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);function Ii(t,e,n){const r=[];let o,i=0;for(const[a,l,s]of function*(t){let e=0,n=0;const r=t.length;for(;n<r;){let r=1;switch(t[n]){case Si:case"-":++n,yield[e,n,!1],e=n;break;case" ":for(yield[e,n,!1];" "===t[++n];);e=n;break;case"\r":"\n"===t[n+1]&&++r;case"\n":yield[e,n,!0],n+=r,e=n;break;default:++n}}yield[e,n,!0]}(t))void 0===o&&(o=a),i>o&&n(t,o,l)>e&&(r.push(t.slice(o,i)+(t[i-1]===Si?"-":"")),o=a),s?(r.push(t.slice(o,l)),o=void 0):i=l;return r}const Pi={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"‘":31,"’":31,"“":47,"”":47,"…":82};function Wi(t,e=0,n=t.length){let r=0;for(let o=e;o<n;o=Ui(t,o))r+=Pi[t[o]]??(Zi(t,o)?120:Pi.e);return r}function ji(t,e=0,n=t.length){let r=0;for(let o=e;o<n;o=Ui(t,o))r+=Zi(t,o)?126:63;return r}function qi({monospace:t,lineWidth:e,textOverflow:n}){if(null!=n||e==1/0)return t=>t.split(/\r\n?|\n/g);const r=t?ji:Wi,o=100*e;return t=>Ii(t,o,r)}function Fi({monospace:t,lineWidth:e,textOverflow:n}){if(null==n||e==1/0)return t=>t;const r=t?ji:Wi,o=100*e;switch(n){case"clip-start":return t=>Gi(t,o,r,"");case"clip-end":return t=>_i(t,o,r,"");case"ellipsis-start":return t=>Gi(t,o,r,Di);case"ellipsis-middle":return t=>function(t,e,n,r){t=t.trim();const o=n(t);if(o<=e)return t;const i=n(r)/2,[a,l]=Yi(t,e/2,n,i),[s]=Yi(t,o-e/2-l+i,n,-i);return s<0?r:t.slice(0,a).trimEnd()+r+t.slice(Ui(t,s)).trimStart()}(t,o,r,Di);case"ellipsis-end":return t=>_i(t,o,r,Di)}}const Di="…";function Yi(t,e,n,r){const o=[];let i=0;for(let a=0,l=0,s=t.length;a<s;a=l){l=Ui(t,a);const s=n(t,a,l);if(i+s>e){for(i+=r;i>e&&a>0;)l=a,a=o.pop(),i-=n(t,a,l);return[a,e-i]}i+=s,o.push(a)}return[-1,0]}function _i(t,e,n,r){t=t.trim();const o=n(r),[i]=Yi(t,e,n,o);return i<0?t:t.slice(0,i).trimEnd()+r}function Gi(t,e,n,r){const o=n(t=t.trim());if(o<=e)return t;const i=n(r),[a]=Yi(t,o-e+i,n,-i);return a<0?r:r+t.slice(Ui(t,a)).trimStart()}const Xi=/[\p{Combining_Mark}\p{Emoji_Modifier}]+/uy,Hi=/\p{Extended_Pictographic}/uy;function Ui(t,e){return e+=function(t,e){const n=t.charCodeAt(e);if(n>=55296&&n<56320){const n=t.charCodeAt(e+1);return n>=56320&&n<57344}return!1}(t,e)?2:1,function(t,e){return!Vi(t,e)&&(Xi.lastIndex=e,Xi.test(t))}(t,e)&&(e=Xi.lastIndex),function(t,e){return 8205===t.charCodeAt(e)}(t,e)?Ui(t,e+1):e}function Vi(t,e){return t.charCodeAt(e)<128}function Zi(t,e){return!Vi(t,e)&&(Hi.lastIndex=e,Hi.test(t))}const Qi={ariaLabel:"vector",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinejoin:"round",strokeLinecap:"round"},Ji=3.5,Ki=5*Ji,ta={draw(t,e,n){const r=e*n/Ki;t.moveTo(0,0),t.lineTo(0,-e),t.moveTo(-r,r-e),t.lineTo(0,-e),t.lineTo(r,r-e)}},ea={draw(t,e,n){t.moveTo(-n,0),t.lineTo(0,-e),t.lineTo(n,0)}},na=new Map([["arrow",ta],["spike",ea]]);class ra extends Io{constructor(t,e={}){const{x:n,y:r,r:o=Ji,length:i,rotate:a,shape:l=ta,anchor:s="middle",frameAnchor:c}=e,[u,f]=ct(i,12),[h,d]=ct(a,0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},length:{value:u,scale:"length",optional:!0},rotate:{value:h,optional:!0}},e,Qi),this.r=+o,this.length=f,this.rotate=d,this.shape=function(t){if(function(t){return t&&"function"==typeof t.draw}(t))return t;const e=na.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid shape: ${t}`)}(l),this.anchor=ft(s,"anchor",["start","middle","end"]),this.frameAnchor=ee(c)}render(t,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,length:u,rotate:f}=r,{length:h,rotate:d,anchor:p,shape:m,r:y}=this,[g,v]=wo(this,o);return kn("svg:g",i).call(co,this,o,i).call(po,this,{x:s&&a,y:c&&l}).call((n=>n.selectAll().data(t).enter().append("path").call(uo,this).attr("transform",Li`translate(${s?t=>s[t]:g},${c?t=>c[t]:v})${f?t=>` rotate(${f[t]})`:d?` rotate(${d})`:""}${"start"===p?"":"end"===p?u?t=>` translate(0,${u[t]})`:` translate(0,${h})`:u?t=>` translate(0,${u[t]/2})`:` translate(0,${h/2})`}`).attr("d",u?t=>{const n=e.pathRound();return m.draw(n,u[t],y),n}:(()=>{const t=e.pathRound();return m.draw(t,h,y),t})()).call(io,this,r))).node()}}function oa(t,e={}){let{x:n,y:r,...o}=e;return void 0===e.frameAnchor&&([n,r]=$t(n,r)),new ra(t,{...o,x:n,y:r})}function ia(t,e={}){const{x:n=H,...r}=e;return new ra(t,{...r,x:n})}function aa(t,e={}){const{y:n=H,...r}=e;return new ra(t,{...r,y:n})}function la(t,e){return arguments.length<2&&!Ft(t)&&(e=t,t=null),void 0===e&&(e={}),[t,e]}function sa({anchor:t}={},e){return void 0===t?e[0]:ft(t,"anchor",e)}function ca(t){return sa(t,["left","right"])}function ua(t){return sa(t,["right","left"])}function fa(t){return sa(t,["bottom","top"])}function ha(t){return sa(t,["top","bottom"])}function da(){const[t,e]=la(...arguments);return ga("y",ca(e),t,e)}function pa(){const[t,e]=la(...arguments);return ga("fy",ua(e),t,e)}function ma(){const[t,e]=la(...arguments);return va("x",fa(e),t,e)}function ya(){const[t,e]=la(...arguments);return va("fx",ha(e),t,e)}function ga(t,e,n,{color:r="currentColor",opacity:o=1,stroke:i=r,strokeOpacity:a=o,strokeWidth:l=1,fill:s=r,fillOpacity:c=o,textAnchor:u,textStroke:f,textStrokeOpacity:h,textStrokeWidth:d,tickSize:p=("y"===t?6:0),tickPadding:m,tickRotate:y,x:g,margin:v,marginTop:x=(void 0===v?20:v),marginRight:w=(void 0===v?"right"===e?40:0:v),marginBottom:b=(void 0===v?20:v),marginLeft:k=(void 0===v?"left"===e?40:0:v),label:$,labelAnchor:M,labelArrow:L,labelOffset:A,...S}){return p=Q(p),m=Q(m),y=Q(y),void 0!==M&&(M=ft(M,"labelAnchor",["center","top","bottom"])),L=Pa(L),Po(p&&!Jt(i)?function(t,e,n,{strokeWidth:r=1,strokeLinecap:o=null,strokeLinejoin:i=null,facetAnchor:a=e+("y"===t?"-empty":""),frameAnchor:l=e,tickSize:s,inset:c=0,insetLeft:u=c,insetRight:f=c,dx:h=0,y:d=("y"===t?void 0:null),...p}){return Sa(aa,t,n,{ariaLabel:`${t}-axis tick`,ariaHidden:!0},{strokeWidth:r,strokeLinecap:o,strokeLinejoin:i,facetAnchor:a,frameAnchor:l,y:d,...p,dx:"left"===e?+h-Kr+ +u:+h+Kr-f,anchor:"start",length:s,shape:"left"===e?Ta:Ba})}(t,e,n,{stroke:i,strokeOpacity:a,strokeWidth:l,tickSize:p,tickPadding:m,tickRotate:y,x:g,...S}):null,Jt(s)?null:function(t,e,n,{facetAnchor:r=e+("y"===t?"-empty":""),frameAnchor:o=e,tickSize:i,tickRotate:a=0,tickPadding:l=Math.max(3,9-i)+(Math.abs(a)>60?4*Math.cos(a*Vo):0),text:s,textAnchor:c=(Math.abs(a)>60?"middle":"left"===e?"end":"start"),lineAnchor:u=(a>60?"top":a<-60?"bottom":"middle"),fontVariant:f,inset:h=0,insetLeft:d=h,insetRight:p=h,dx:m=0,y:y=("y"===t?void 0:null),...g}){return Sa(Ti,t,n,{ariaLabel:`${t}-axis tick label`},{facetAnchor:r,frameAnchor:o,text:s,textAnchor:c,lineAnchor:u,fontVariant:f,rotate:a,y:y,...g,dx:"left"===e?+m-i-l+ +d:+m+ +i+ +l-p},(function(t,n,r,o,i){void 0===f&&(this.fontVariant=Na(t)),void 0===s&&(i.text=za(t,n,r,o,e))}))}(t,e,n,{fill:s,fillOpacity:c,stroke:f,strokeOpacity:h,strokeWidth:d,textAnchor:u,tickSize:p,tickPadding:m,tickRotate:y,x:g,marginTop:x,marginRight:w,marginBottom:b,marginLeft:k,...S}),Jt(s)||null===$?null:Ri([],Aa({fill:s,fillOpacity:c,...S},(function(n,r,o,i,a){const l=i[t],{marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}="y"===t&&a.inset||a,h=M??(l.bandwidth?"center":"top"),d=A??("right"===e?c:f)-3;return"center"===h?(this.textAnchor=void 0,this.lineAnchor="right"===e?"bottom":"top",this.frameAnchor=e,this.rotate=-90):(this.textAnchor="right"===e?"end":"start",this.lineAnchor=h,this.frameAnchor=`${h}-${e}`,this.rotate=0),this.dy="top"===h?3-s:"bottom"===h?u-3:0,this.dx="right"===e?d:-d,this.ariaLabel=`${t}-axis label`,{facets:[[0]],channels:{text:{value:[Ia(t,l,{anchor:e,label:$,labelAnchor:h,labelArrow:L})]}}}}))))}function va(t,e,n,{color:r="currentColor",opacity:o=1,stroke:i=r,strokeOpacity:a=o,strokeWidth:l=1,fill:s=r,fillOpacity:c=o,textAnchor:u,textStroke:f,textStrokeOpacity:h,textStrokeWidth:d,tickSize:p=("x"===t?6:0),tickPadding:m,tickRotate:y,y:g,margin:v,marginTop:x=(void 0===v?"top"===e?30:0:v),marginRight:w=(void 0===v?20:v),marginBottom:b=(void 0===v?"bottom"===e?30:0:v),marginLeft:k=(void 0===v?20:v),label:$,labelAnchor:M,labelArrow:L,labelOffset:A,...S}){return p=Q(p),m=Q(m),y=Q(y),void 0!==M&&(M=ft(M,"labelAnchor",["center","left","right"])),L=Pa(L),Po(p&&!Jt(i)?function(t,e,n,{strokeWidth:r=1,strokeLinecap:o=null,strokeLinejoin:i=null,facetAnchor:a=e+("x"===t?"-empty":""),frameAnchor:l=e,tickSize:s,inset:c=0,insetTop:u=c,insetBottom:f=c,dy:h=0,x:d=("x"===t?void 0:null),...p}){return Sa(ia,t,n,{ariaLabel:`${t}-axis tick`,ariaHidden:!0},{strokeWidth:r,strokeLinejoin:i,strokeLinecap:o,facetAnchor:a,frameAnchor:l,x:d,...p,dy:"bottom"===e?+h-Kr-f:+h+Kr+ +u,anchor:"start",length:s,shape:"bottom"===e?Ra:Ca})}(t,e,n,{stroke:i,strokeOpacity:a,strokeWidth:l,tickSize:p,tickPadding:m,tickRotate:y,y:g,...S}):null,Jt(s)?null:function(t,e,n,{facetAnchor:r=e+("x"===t?"-empty":""),frameAnchor:o=e,tickSize:i,tickRotate:a=0,tickPadding:l=Math.max(3,9-i)+(Math.abs(a)>=10?4*Math.cos(a*Vo):0),text:s,textAnchor:c=(Math.abs(a)>=10?a<0^"bottom"===e?"start":"end":"middle"),lineAnchor:u=(Math.abs(a)>=10?"middle":"bottom"===e?"top":"bottom"),fontVariant:f,inset:h=0,insetTop:d=h,insetBottom:p=h,dy:m=0,x:y=("x"===t?void 0:null),...g}){return Sa(Ci,t,n,{ariaLabel:`${t}-axis tick label`},{facetAnchor:r,frameAnchor:o,text:void 0===s?null:s,textAnchor:c,lineAnchor:u,fontVariant:f,rotate:a,x:y,...g,dy:"bottom"===e?+m+ +i+ +l-p:+m-i-l+ +d},(function(t,n,r,o,i){void 0===f&&(this.fontVariant=Na(t)),void 0===s&&(i.text=za(t,n,r,o,e))}))}(t,e,n,{fill:s,fillOpacity:c,stroke:f,strokeOpacity:h,strokeWidth:d,textAnchor:u,tickSize:p,tickPadding:m,tickRotate:y,y:g,marginTop:x,marginRight:w,marginBottom:b,marginLeft:k,...S}),Jt(s)||null===$?null:Ri([],Aa({fill:s,fillOpacity:c,...S},(function(n,r,o,i,a){const l=i[t],{marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}="x"===t&&a.inset||a,h=M??(l.bandwidth?"center":"right"),d=A??("top"===e?s:u)-3;return"center"===h?(this.frameAnchor=e,this.textAnchor=void 0):(this.frameAnchor=`${e}-${h}`,this.textAnchor="right"===h?"end":"start"),this.lineAnchor=e,this.dy="top"===e?-d:d,this.dx="right"===h?c-3:"left"===h?3-f:0,this.ariaLabel=`${t}-axis label`,{facets:[[0]],channels:{text:{value:[Ia(t,l,{anchor:e,label:$,labelAnchor:h,labelArrow:L})]}}}}))))}function xa(){const[t,e]=la(...arguments);return $a("y",ca(e),t,e)}function wa(){const[t,e]=la(...arguments);return $a("fy",ua(e),t,e)}function ba(){const[t,e]=la(...arguments);return Ma("x",fa(e),t,e)}function ka(){const[t,e]=la(...arguments);return Ma("fx",ha(e),t,e)}function $a(t,e,n,{y:r=("y"===t?void 0:null),x:o=null,x1:i=("left"===e?o:null),x2:a=("right"===e?o:null),...l}){return Sa($i,t,n,{ariaLabel:`${t}-grid`,ariaHidden:!0},{y:r,x1:i,x2:a,...La(l)})}function Ma(t,e,n,{x:r=("x"===t?void 0:null),y:o=null,y1:i=("top"===e?o:null),y2:a=("bottom"===e?o:null),...l}){return Sa(ki,t,n,{ariaLabel:`${t}-grid`,ariaHidden:!0},{x:r,y1:i,y2:a,...La(l)})}function La({color:t="currentColor",opacity:e=.1,stroke:n=t,strokeOpacity:r=e,strokeWidth:o=1,...i}){return{stroke:n,strokeOpacity:r,strokeWidth:o,...i}}function Aa({fill:t,fillOpacity:e,fontFamily:n,fontSize:r,fontStyle:o,fontVariant:i,fontWeight:a,monospace:l,pointerEvents:s,shapeRendering:c,clip:u=!1},f){return[,t]=st(t),[,e]=ct(e),{facet:"super",x:null,y:null,fill:t,fillOpacity:e,fontFamily:n,fontSize:r,fontStyle:o,fontVariant:i,fontWeight:a,monospace:l,pointerEvents:s,shapeRendering:c,clip:u,initializer:f}}function Sa(t,n,r,o,i,a){let l;const s=we(i).initializer,c=t(r,we({...i,initializer:function(t,r,o,s,c,u){const f=null==t&&("fx"===n||"fy"===n),{[n]:h}=s;if(!h)throw new Error(`missing scale: ${n}`);const d=h.domain();let{interval:p,ticks:m,tickFormat:y,tickSpacing:g=("x"===n?80:35)}=i;if("string"==typeof m&&Wa(h)&&(p=m,m=void 0),void 0===m&&(m=Wt(p,h.type)??function(t,n){const[r,o]=e.extent(t.range());return(o-r)/n}(h,g)),null==t){if(Ft(m))t=ht(m);else if(jt(m))t=Ea(m,...e.extent(d));else if(h.interval){let n=h.interval;if(h.ticks){const[r,o]=e.extent(d);n=B(n,(o-r)/n[L]/m)??n,t=Ea(n,r,o)}else{n=B(n,(t=d).length/m)??n,n!==h.interval&&(t=Ea(n,...e.extent(t)))}if(n===h.interval){const e=Math.round(t.length/m);e>1&&(t=t.filter(((t,n)=>n%e==0)))}}else t=h.ticks?h.ticks(m):d;if(!h.ticks&&t.length&&t!==d){const r=new e.InternSet(d);(t=t.filter((t=>r.has(t)))).length||Ln(`Warning: the ${n}-axis ticks appear to not align with the scale domain, resulting in no ticks. Try different ticks?`)}"y"===n||"x"===n?r=[Lt(t)]:l[n]={scale:n,value:H}}a?.call(this,h,t,m,y,l);const v=Object.fromEntries(Object.entries(l).map((([e,n])=>[e,{...n,value:F(t,n.value)}])));return f&&(r=u.filterFacets(t,v)),{data:t,facets:r,channels:v}}},s));return null==r?(l=c.channels,c.channels={}):l={},void 0!==o&&Object.assign(c,o),void 0===c.clip&&(c.clip=!1),c}function za(t,e,n,r,o){return{value:Oa(t,e,n,r,o)}}function Oa(t,n,r,o,i){return"function"==typeof o?o:void 0===o&&n&&_t(n)?I(t.type,n,i)??Jr:t.tickFormat?t.tickFormat("number"==typeof r?r:null,o):void 0===o?Jr:"string"==typeof o?(_t(t.domain())?e.utcFormat:e.format)(o):et(o)}function Ea(t,e,n){return t.range(e,t.offset(t.floor(n)))}const Ra={draw(t,e){t.moveTo(0,0),t.lineTo(0,e)}},Ca={draw(t,e){t.moveTo(0,0),t.lineTo(0,-e)}},Ta={draw(t,e){t.moveTo(0,0),t.lineTo(-e,0)}},Ba={draw(t,e){t.moveTo(0,0),t.lineTo(e,0)}};function Na(t){return t.bandwidth&&!t.interval?void 0:"tabular-nums"}function Ia(t,e,{anchor:n,label:r=e.label,labelAnchor:o,labelArrow:i}={}){if(!(null==r||r.inferred&&Wa(e)&&/^(date|time|year)$/i.test(r))){if(r=String(r),"auto"===i&&(i=(!e.bandwidth||e.interval)&&!/[↑↓→←]/.test(r)),!i)return r;if(!0===i){const n=zr(e);n&&(i=/x$/.test(t)||"center"===o?/x$/.test(t)===n<0?"left":"right":n<0?"up":"down")}switch(i){case"left":return`← ${r}`;case"right":return`${r} →`;case"up":return"right"===n?`${r} ↑`:`↑ ${r}`;case"down":return"right"===n?`${r} ↓`:`↓ ${r}`}return r}}function Pa(t="auto"){return!Jt(t)&&("boolean"==typeof t?t:ft(t,"labelArrow",["auto","up","right","down","left"]))}function Wa(t){return _t(t.domain())}function ja(t,e){if(null==e)return e;const n=t(e);if(!n)throw new Error(`scale not found: ${e}`);return n}function qa(t,e={},n){let{columns:r,tickFormat:o,fontVariant:i=Uo(t),swatchSize:a=15,swatchWidth:l=a,swatchHeight:s=a,marginLeft:c=0,className:u,style:f,width:h}=e;const d=bn(e);u=vo(u),o=Oa(t.scale,t.domain,void 0,o);const p=kn("div",d).attr("class",`${u}-swatches ${u}-swatches-${null!=r?"columns":"wrap"}`);let m;return null!=r?(m=`:where(.${u}-swatches-columns .${u}-swatch) {\n  display: flex;\n  align-items: center;\n  break-inside: avoid;\n  padding-bottom: 1px;\n}\n:where(.${u}-swatches-columns .${u}-swatch::before) {\n  flex-shrink: 0;\n}\n:where(.${u}-swatches-columns .${u}-swatch-label) {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}`,p.style("columns",r).selectAll().data(t.domain).enter().append("div").attr("class",`${u}-swatch`).call(n,t,l,s).call((t=>t.append("div").attr("class",`${u}-swatch-label`).attr("title",o).text(o)))):(m=`:where(.${u}-swatches-wrap) {\n  display: flex;\n  align-items: center;\n  min-height: 33px;\n  flex-wrap: wrap;\n}\n:where(.${u}-swatches-wrap .${u}-swatch) {\n  display: inline-flex;\n  align-items: center;\n  margin-right: 1em;\n}`,p.selectAll().data(t.domain).enter().append("span").attr("class",`${u}-swatch`).call(n,t,l,s).append((function(){return this.ownerDocument.createTextNode(o.apply(this,arguments))}))),p.call((t=>t.insert("style","*").text(`:where(.${u}-swatches) {\n  font-family: system-ui, sans-serif;\n  font-size: 10px;\n  margin-bottom: 0.5em;\n}\n:where(.${u}-swatch > svg) {\n  margin-right: 0.5em;\n  overflow: visible;\n}\n${m}`))).style("margin-left",c?+c+"px":null).style("width",void 0===h?null:+h+"px").style("font-variant",mo(i,"normal")).call(xo,f).node()}const Fa=new Map([["symbol",function(t,{fill:n=(void 0!==t.hint?.fill?t.hint.fill:"none"),fillOpacity:r=1,stroke:o=(void 0!==t.hint?.stroke?t.hint.stroke:Jt(n)?"currentColor":"none"),strokeOpacity:i=1,strokeWidth:a=1.5,r:l=4.5,...s}={},c){const[u,f]=st(n),[h,d]=st(o),p=ja(c,u),m=ja(c,h),y=l*l*Math.PI;return r=ct(r)[1],i=ct(i)[1],a=ct(a)[1],qa(t,s,((n,o,l,s)=>n.append("svg").attr("viewBox","-8 -8 16 16").attr("width",l).attr("height",s).attr("fill","color"===u?t=>p.scale(t):f).attr("fill-opacity",r).attr("stroke","color"===h?t=>m.scale(t):d).attr("stroke-opacity",i).attr("stroke-width",a).append("path").attr("d",(n=>{const r=e.pathRound();return t.scale(n).draw(r,y),r}))))}],["color",Ya],["opacity",function({type:t,interpolate:n,...r},{legend:o=!0,color:i=e.rgb(0,0,0),...a}){if(!n)throw new Error(`${t} opacity scales are not supported`);!0===o&&(o="ramp");if("ramp"!==`${o}`.toLowerCase())throw new Error(`${o} opacity legends are not supported`);return Ya({type:t,...r,interpolate:_a(i)},{legend:o,...a})}]]);function Da({className:t,...e},{label:n,ticks:r,tickFormat:o}={},i){return function(t={},...e){let n=t;for(const r of e)for(const e in r)if(void 0===n[e]){const o=r[e];n===t?n={...n,[e]:o}:n[e]=o}return n}(i,{className:t,...e},{label:n,ticks:r,tickFormat:o})}function Ya(t,{legend:n=!0,...r}){if(!0===n&&(n="ordinal"===t.type?"swatches":"ramp"),void 0!==t.domain)switch(`${n}`.toLowerCase()){case"swatches":return function(t,{opacity:e,...n}={}){if(!Fr(t)&&!Dr(t))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${t.type})`);return qa(t,n,((t,n,r,o)=>t.append("svg").attr("width",r).attr("height",o).attr("fill",n.scale).attr("fill-opacity",ct(e)[1]).append("rect").attr("width","100%").attr("height","100%")))}(t,r);case"ramp":return function(t,n){let{label:r=t.label,tickSize:o=6,width:i=240,height:a=44+o,marginTop:l=18,marginRight:s=0,marginBottom:c=16+o,marginLeft:u=0,style:f,ticks:h=(i-u-s)/64,tickFormat:d,fontVariant:p=Uo(t),round:m=!0,opacity:y,className:g}=n;const v=bn(n);g=vo(g),y=ct(y)[1],null===d&&(d=()=>null);const x=kn("svg",v).attr("class",`${g}-ramp`).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",i).attr("height",a).attr("viewBox",`0 0 ${i} ${a}`).call((t=>t.append("style").text(`:where(.${g}-ramp) {\n  display: block;\n  height: auto;\n  height: intrinsic;\n  max-width: 100%;\n  overflow: visible;\n}\n:where(.${g}-ramp text) {\n  white-space: pre;\n}`))).call(xo,f);let w,b=t=>t.selectAll(".tick line").attr("y1",l+c-a);const k=m?(t,e)=>t.rangeRound(e):(t,e)=>t.range(e),{type:$,domain:M,range:L,interpolate:A,scale:S,pivot:z}=t;if(A){const t=void 0===L?A:e.piecewise(1===A.length?fr(A):A,L);w=k(S.copy(),e.quantize(e.interpolateNumber(u,i-s),Math.min(M.length+(void 0!==z),void 0===L?1/0:L.length)));const n=256,r=v.document.createElement("canvas");r.width=n,r.height=1;const o=r.getContext("2d");for(let e=0,r=n-1;e<n;++e)o.fillStyle=t(e/r),o.fillRect(e,0,1,1);x.append("image").attr("opacity",y).attr("x",u).attr("y",l).attr("width",i-u-s).attr("height",a-l-c).attr("preserveAspectRatio","none").attr("xlink:href",r.toDataURL())}else if("threshold"===$){const t=M,n=void 0===d?t=>t:"string"==typeof d?e.format(d):d;w=k(e.scaleLinear().domain([-1,L.length-1]),[u,i-s]),x.append("g").attr("fill-opacity",y).selectAll().data(L).enter().append("rect").attr("x",((t,e)=>w(e-1))).attr("y",l).attr("width",((t,e)=>w(e)-w(e-1))).attr("height",a-l-c).attr("fill",(t=>t)),h=dt(t,((t,e)=>e)),d=e=>n(t[e],e)}else w=k(e.scaleBand().domain(M),[u,i-s]),x.append("g").attr("fill-opacity",y).selectAll().data(M).enter().append("rect").attr("x",w).attr("y",l).attr("width",Math.max(0,w.bandwidth()-1)).attr("height",a-l-c).attr("fill",S),b=()=>{};return x.append("g").attr("transform",`translate(0,${a-c})`).call(e.axisBottom(w).ticks(Array.isArray(h)?null:h,"string"==typeof d?d:void 0).tickFormat("function"==typeof d?d:void 0).tickSize(o).tickValues(Array.isArray(h)?h:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",mo(p,"normal")).call(b).call((t=>t.select(".domain").remove())),void 0!==r&&x.append("text").attr("x",u).attr("y",l-6).attr("fill","currentColor").attr("font-weight","bold").text(r),x.node()}(t,r);default:throw new Error(`unknown legend type: ${n}`)}}function _a(t){const{r:n,g:r,b:o}=e.rgb(t)||e.rgb(0,0,0);return t=>`rgba(${n},${r},${o},${t})`}const Ga={ariaLabel:"frame",fill:"none",stroke:"currentColor",clip:!1},Xa={ariaLabel:"frame",fill:null,stroke:"currentColor",strokeLinecap:"square",clip:!1};class Ha extends Io{constructor(t={}){const{anchor:e=null,inset:n=0,insetTop:r=n,insetRight:o=n,insetBottom:i=n,insetLeft:a=n,rx:l,ry:s}=t;super(_,void 0,t,null==e?Ga:Xa),this.anchor=ut(e,"anchor",["top","right","bottom","left"]),this.insetTop=Q(r),this.insetRight=Q(o),this.insetBottom=Q(i),this.insetLeft=Q(a),this.rx=Q(l),this.ry=Q(s)}render(t,e,n,r,o){const{marginTop:i,marginRight:a,marginBottom:l,marginLeft:s,width:c,height:u}=r,{anchor:f,insetTop:h,insetRight:d,insetBottom:p,insetLeft:m,rx:y,ry:g}=this,v=s+m,x=c-a-d,w=i+h,b=u-l-p;return kn(f?"svg:line":"svg:rect",o).datum(0).call(co,this,r,o).call(uo,this).call(io,this,n).call(po,this,{}).call("left"===f?t=>t.attr("x1",v).attr("x2",v).attr("y1",w).attr("y2",b):"right"===f?t=>t.attr("x1",x).attr("x2",x).attr("y1",w).attr("y2",b):"top"===f?t=>t.attr("x1",v).attr("x2",x).attr("y1",w).attr("y2",w):"bottom"===f?t=>t.attr("x1",v).attr("x2",x).attr("y1",b).attr("y2",b):t=>t.attr("x",v).attr("y",w).attr("width",x-v).attr("height",b-w).attr("rx",y).attr("ry",g)).node()}}function Ua(t){return new Ha(t)}const Va={ariaLabel:"tip",fill:"var(--plot-background)",stroke:"currentColor"},Za=new Set(["geometry","href","src","ariaLabel","scales"]);class Qa extends Io{constructor(t,e={}){e.tip&&(e={...e,tip:!1}),void 0===e.title&&Ft(t)&&Dt(t)&&(e={...e,title:H});const{x:n,y:r,x1:o,x2:i,y1:a,y2:l,anchor:s,preferredAnchor:c="bottom",monospace:u,fontFamily:f=(u?"ui-monospace, monospace":void 0),fontSize:h,fontStyle:d,fontVariant:p,fontWeight:m,lineHeight:y=1,lineWidth:g=20,frameAnchor:v,format:x,textAnchor:w="start",textOverflow:b,textPadding:k=8,title:$,pointerSize:M=12,pathFilter:L="drop-shadow(0 3px 4px rgba(0,0,0,0.2))"}=e;super(t,{x:{value:null!=o&&null!=i?null:n,scale:"x",optional:!0},y:{value:null!=a&&null!=l?null:r,scale:"y",optional:!0},x1:{value:o,scale:"x",optional:null==i},y1:{value:a,scale:"y",optional:null==l},x2:{value:i,scale:"x",optional:null==o},y2:{value:l,scale:"y",optional:null==a},title:{value:$,optional:!0}},e,Va),this.anchor=te(s,"anchor"),this.preferredAnchor=te(c,"preferredAnchor"),this.frameAnchor=ee(v),this.textAnchor=mo(w,"middle"),this.textPadding=+k,this.pointerSize=+M,this.pathFilter=Z(L),this.lineHeight=+y,this.lineWidth=+g,this.textOverflow=Oi(b),this.monospace=!!u,this.fontFamily=Z(f),this.fontSize=Q(h),this.fontStyle=Z(d),this.fontVariant=Z(p),this.fontWeight=Z(m);for(const t in Va)t in this.channels&&(this[t]=Va[t]);this.splitLines=qi(this),this.clipLine=Fi(this),this.format={...x}}render(t,n,r,o,i){const a=this,{x:l,y:s,fx:c,fy:u}=n,{ownerSVGElement:f,document:h}=i,{anchor:d,monospace:p,lineHeight:m,lineWidth:y}=this,{textPadding:g,pointerSize:v,pathFilter:x}=this,{marginTop:w,marginLeft:b}=o,{x1:k,y1:$,x2:M,y2:L,x:A=k??M,y:S=$??L}=r,z=c?c(t.fx)-b:0,O=u?u(t.fy)-w:0,[E,R]=wo(this,o),C=Xo(r,E),T=Ho(r,R),B=p?ji:Wi,N=B(Di);let I,P;"title"in r?(I=r.channels,P=el):(I=Ka.call(this,r,n),P=nl);const W=kn("svg:g",i).call(co,this,o,i).call(Bi,this).call(po,this,{x:A&&l,y:S&&s}).call((o=>o.selectAll().data(t).enter().append("g").attr("transform",(t=>`translate(${Math.round(C(t))},${Math.round(T(t))})`)).call(uo,this).call((t=>t.append("path").attr("filter",x))).call((o=>o.append("text").each((function(o){const i=e.select(this);this.setAttribute("fill","currentColor"),this.setAttribute("fill-opacity",1),this.setAttribute("stroke","none");const l=P.call(a,o,t,I,n,r);if("string"==typeof l)for(const t of a.splitLines(l))j(i,{value:a.clipLine(t)});else{const t=new Set;for(const e of l){const{label:n=""}=e;n&&t.has(n)||(t.add(n),j(i,e))}}}))))));function j(t,{label:e,value:n,color:r,opacity:o}){e??="",n??="";const i=null!=r||null!=o;let a,l=100*y;const[s]=Yi(e,l,B,N);if(s>=0)e=e.slice(0,s).trimEnd()+Di,a=n.trim(),n="";else{(e||!n&&!i)&&(n=" "+n);const[t]=Yi(n,l-B(e),B,N);t>=0&&(a=n.trim(),n=n.slice(0,t).trimEnd()+Di)}const c=t.append("tspan").attr("x",0).attr("dy",`${m}em`).text("​");e&&c.append("tspan").attr("font-weight","bold").text(e),n&&c.append((()=>h.createTextNode(n))),i&&c.append("tspan").text(" ■").attr("fill",r).attr("fill-opacity",o).style("user-select","none"),a&&c.append("title").text(a)}function q(){const{width:t,height:e}=o.facet??o;W.selectChildren().each((function(n){let{x:r,width:o,height:i}=this.getBBox();o=Math.round(o),i=Math.round(i);let l=d;if(void 0===l){const r=C(n)+z,s=T(n)+O,c=r+o+v+2*g<t,u=r-o-v-2*g>0,f=s+i+v+2*g<e,h=s-i-v-2*g>0;l=c&&u?f&&h?a.preferredAnchor:h?"bottom":"top":f&&h?c?"left":"right":(c||u)&&(f||h)?`${h?"bottom":"top"}-${c?"left":"right"}`:a.preferredAnchor}const s=this.firstChild,c=this.lastChild;if(s.setAttribute("d",function(t,e,n,r,o){const i=r+2*n,a=o+2*n;switch(t){case"middle":return`M${-i/2},${-a/2}h${i}v${a}h${-i}z`;case"top-left":return`M0,0l${e},${e}h${i-e}v${a}h${-i}z`;case"top":return`M0,0l${e/2},${e/2}h${(i-e)/2}v${a}h${-i}v${-a}h${(i-e)/2}z`;case"top-right":return`M0,0l${-e},${e}h${e-i}v${a}h${i}z`;case"right":return`M0,0l${-e/2},${-e/2}v${e/2-a/2}h${-i}v${a}h${i}v${e/2-a/2}z`;case"bottom-left":return`M0,0l${e},${-e}h${i-e}v${-a}h${-i}z`;case"bottom":return`M0,0l${e/2},${-e/2}h${(i-e)/2}v${-a}h${-i}v${a}h${(i-e)/2}z`;case"bottom-right":return`M0,0l${-e},${-e}h${e-i}v${-a}h${i}z`;case"left":return`M0,0l${e/2},${-e/2}v${e/2-a/2}h${i}v${a}h${-i}v${e/2-a/2}z`}}(l,v,g,o,i)),r)for(const t of c.childNodes)t.setAttribute("x",-r);c.setAttribute("y",+function(t,e,n){return/^top(?:-|$)/.test(t)?.94-n:-.29-e*n}(l,c.childNodes.length,m).toFixed(6)+"em"),c.setAttribute("transform",`translate(${function(t,e,n,r,o){switch(t){case"middle":return[-r/2,o/2];case"top-left":return[n,e+n];case"top":return[-r/2,e/2+n];case"top-right":return[-r-n,e+n];case"right":return[-e/2-r-n,o/2];case"bottom-left":return[n,-e-n];case"bottom":return[-r/2,-e/2-n];case"bottom-right":return[-r-n,-e-n];case"left":return[n+e/2,o/2]}}(l,v,g,o,i)})`)})),W.attr("visibility",null)}return t.length&&(W.attr("visibility","hidden"),f.isConnected?Promise.resolve().then(q):"undefined"!=typeof requestAnimationFrame&&requestAnimationFrame(q)),W.node()}}function Ja(t,{x:e,y:n,...r}={}){return void 0===r.frameAnchor&&([e,n]=$t(e,n)),new Qa(t,{...r,x:e,y:n})}function Ka({channels:t},n){const r={};let o=this.format;o=tl(o,t,"x"),o=tl(o,t,"y"),this.format=o;for(const e in o){const n=o[e];if(null!==n&&!1!==n)if("fx"===e||"fy"===e)r[e]=!0;else{const n=wn(t,e);n&&(r[e]=n)}}for(const e in t){if(e in r||e in o||Za.has(e))continue;const n=wn(t,e);n&&(r[e]=n)}this.facet&&(n.fx&&!("fx"in o)&&(r.fx=!0),n.fy&&!("fy"in o)&&(r.fy=!0));for(const t in r){const o=this.format[t];if("string"==typeof o){const i=r[t]?.value??n[t]?.domain()??[];this.format[t]=(_t(i)?e.utcFormat:e.format)(o)}else if(void 0===o||!0===o){const e=n[t];this.format[t]=e?.bandwidth?Oa(e,e.domain()):Jr}}return r}function tl(t,e,n){if(!(n in t))return t;const r=`${n}1`,o=`${n}2`;if(!(!(r in t)&&r in e||!(o in t)&&o in e))return t;const i=Object.entries(t),a=t[n];return i.splice(i.findIndex((([t])=>t===n))+1,0,[r,a],[o,a]),Object.fromEntries(i)}function el(t,e,{title:n}){return Jr(n.value[t],t)}function*nl(t,e,r,o,i){for(const a in r){if("fx"===a||"fy"===a){yield{label:il(o,r,a),value:this.format[a](e[a],t)};continue}if("x1"===a&&"x2"in r)continue;if("y1"===a&&"y2"in r)continue;const l=r[a];if("x2"===a&&"x1"in r)yield{label:ol(o,r,"x"),value:rl(this.format.x2,r.x1,l,t)};else if("y2"===a&&"y1"in r)yield{label:ol(o,r,"y"),value:rl(this.format.y2,r.y1,l,t)};else{const e=l.value[t],s=l.scale;if(!n(e)&&null==s)continue;yield{label:il(o,r,a),value:this.format[a](e,t),color:"color"===s?i[a][t]:null,opacity:"opacity"===s?i[a][t]:null}}}}function rl(t,e,n,r){return n.hint?.length?`${t(n.value[r]-e.value[r],r)}`:`${t(e.value[r],r)}–${t(n.value[r],r)}`}function ol(t,e,n){const r=il(t,e,`${n}1`,n),o=il(t,e,`${n}2`,n);return r===o?r:`${r}–${o}`}function il(t,e,n,r=n){const o=e[n],i=t[o?.scale??n];return String(i?.label??o?.label??r)}function al(t={}){const{facet:n,style:r,title:o,subtitle:i,caption:a,ariaLabel:l,ariaDescription:s}=t,c=vo(t.className),u=void 0===t.marks?[]:sl(t.marks);u.push(...function(t){const e=[];for(const n of t){let t=n.tip;if(t){!0===t?t={}:"string"==typeof t&&(t={pointer:t});let{pointer:r,preferredAnchor:o}=t;r=/^x$/i.test(r)?_o:/^y$/i.test(r)?Go:Yo,t=r(gl(n,t)),t.title=null,void 0===o&&(t.preferredAnchor=r===Go?"left":"bottom");const i=Ja(n.data,t);i.facet=n.facet,i.facetAnchor=n.facetAnchor,e.push(i)}}return e}(u));const f=function(t,e){if(null==t)return;const{x:n,y:r}=t;if(null==n&&null==r)return;const o=ht(t.data);if(null==o)throw new Error("missing facet data");const i={};null!=n&&(i.fx=cn(o,{value:n,scale:"fx"}));null!=r&&(i.fy=cn(o,{value:r,scale:"fy"}));fl(i,e);const a=$o(o,i);return{channels:i,groups:a,data:t.data}}(n,t),h=new Map;for(const e of u){const n=yl(e,f,t);n&&h.set(e,n)}const d=new Map;f&&pl(d,[f],t),pl(d,h,t);const p=sl(function(t,e,n){let{projection:r,x:o={},y:i={},fx:a={},fy:l={},axis:s,grid:c,facet:u={},facet:{axis:f=s,grid:h}=u,x:{axis:d=s,grid:p=(null===d?null:c)}=o,y:{axis:m=s,grid:y=(null===m?null:c)}=i,fx:{axis:g=f,grid:v=(null===g?null:h)}=a,fy:{axis:x=f,grid:w=(null===x?null:h)}=l}=n;(r||!xt(o)&&!kl("x",t))&&(d=p=null);(r||!xt(i)&&!kl("y",t))&&(m=y=null);e.has("fx")||(g=v=null);e.has("fy")||(x=w=null);void 0===d&&(d=!bl(t,"x"));void 0===m&&(m=!bl(t,"y"));void 0===g&&(g=!bl(t,"fx"));void 0===x&&(x=!bl(t,"fy"));!0===d&&(d="bottom");!0===m&&(m="left");!0===g&&(g="top"===d||null===d?"bottom":"top");!0===x&&(x="right"===m||null===m?"left":"right");const b=[];return xl(b,w,wa,l),vl(b,x,pa,"right","left",u,l),xl(b,v,ka,a),vl(b,g,ya,"top","bottom",u,a),xl(b,y,xa,i),vl(b,m,da,"left","right",n,i),xl(b,p,ba,o),vl(b,d,ma,"bottom","top",n,o),b}(u,d,t));for(const e of p){const n=yl(e,f,t);n&&h.set(e,n)}u.unshift(...p);let m=function(t,n){const{fx:r,fy:o}=Lr(t,n),i=r?.scale.domain(),a=o?.scale.domain();return i&&a?e.cross(i,a).map((([t,e],n)=>({x:t,y:e,i:n}))):i?i.map(((t,e)=>({x:t,i:e}))):a?a.map(((t,e)=>({y:t,i:e}))):void 0}(d,t);if(void 0!==m){const t=f?No(m,f):void 0;for(const e of u){if(null===e.facet||"super"===e.facet)continue;const n=h.get(e);void 0!==n&&(n.facetsIndex=null!=e.fx||null!=e.fy?No(m,n):t)}const e=new Set;for(const{facetsIndex:t}of h.values())t?.forEach(((t,n)=>{t?.length>0&&e.add(n)}));m.forEach(0<e.size&&e.size<m.length?(t,n)=>t.empty=!e.has(n):t=>t.empty=!1);for(const t of u)if("exclude"===t.facet){const e=h.get(t);void 0!==e&&(e.facetsIndex=Mo(e.facetsIndex))}}for(const e of fe.keys())xt(t[e])&&"fx"!==e&&"fy"!==e&&d.set(e,[]);const y=new Map;for(const e of u){if(y.has(e))throw new Error("duplicate mark; each mark must be unique");const{facetsIndex:n,channels:r}=h.get(e)??{},{data:o,facets:i,channels:a}=e.initialize(n,r,t);fl(a,t),y.set(e,{data:o,facets:i,channels:a})}const g=Lr(pl(d,y,t),t),v=function(t,e,n={}){let r=.5-Kr,o=.5+Kr,i=.5+Kr,a=.5-Kr;for(const{marginTop:t,marginRight:n,marginBottom:l,marginLeft:s}of e)t>r&&(r=t),n>o&&(o=n),l>i&&(i=l),s>a&&(a=s);let{margin:l,marginTop:s=(void 0!==l?l:r),marginRight:c=(void 0!==l?l:o),marginBottom:u=(void 0!==l?l:i),marginLeft:f=(void 0!==l?l:a)}=n;s=+s,c=+c,u=+u,f=+f;let{width:h=640,height:d=bo(t,n,{width:h,marginTopDefault:r,marginRightDefault:o,marginBottomDefault:i,marginLeftDefault:a})+Math.max(0,s-r+u-i)}=n;h=+h,d=+d;const p={width:h,height:d,marginTop:s,marginRight:c,marginBottom:u,marginLeft:f};if(t.fx||t.fy){let{margin:t,marginTop:e=(void 0!==t?t:s),marginRight:r=(void 0!==t?t:c),marginBottom:o=(void 0!==t?t:u),marginLeft:i=(void 0!==t?t:f)}=n.facet??{};e=+e,r=+r,o=+o,i=+i,p.facet={marginTop:e,marginRight:r,marginBottom:o,marginLeft:i}}return p}(g,u,t);!function(t,e){const{x:n,y:r,fx:o,fy:i}=t,a=o||i?Or(e):e;o&&Rr(o,a),i&&Cr(i,a);const l=o||i?Er(t,e):e;n&&Rr(n,l),r&&Cr(r,l)}(g,v);const x=Ar(g),{fx:w,fy:b}=x,k=w||b?Er(g,v):v,$=w||b?function({fx:t,fy:e},n){const{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:l,height:s}=Or(n),c=t&&$l(t),u=e&&$l(e);return{marginTop:e?u[0]:r,marginRight:t?l-c[1]:o,marginBottom:e?s-u[1]:i,marginLeft:t?c[0]:a,inset:{marginTop:n.marginTop,marginRight:n.marginRight,marginBottom:n.marginBottom,marginLeft:n.marginLeft},width:l,height:s}}(x,v):v,M=bn(t),L=M.document,A=e.creator("svg").call(L.documentElement);let S=A;M.ownerSVGElement=A,M.className=c,M.projection=On(t,k),M.filterFacets=(t,e)=>No(m,{channels:e,groups:$o(t,e)}),M.getMarkState=t=>{const e=y.get(t),n=h.get(t);return{...e,channels:{...e.channels,...n?.channels}}},M.dispatchValue=t=>{S.value!==t&&(S.value=t,S.dispatchEvent(new Event("input",{bubbles:!0})))};const z=new Set;for(const[e,n]of y)if(null!=e.initializer){const r="super"===e.facet?$:k,o=e.initializer(n.data,n.facets,n.channels,x,r,M);if(void 0!==o.data&&(n.data=o.data),void 0!==o.facets&&(n.facets=o.facets),void 0!==o.channels){const{fx:r,fy:i,...a}=o.channels;dl(a),Object.assign(n.channels,a);for(const e of Object.values(a)){const{scale:n}=e;null!=n&&((O=fe.get(n))!==oe&&O!==ue)&&(hl(e,t),z.add(n))}null==r&&null==i||h.set(e,!0)}}var O;if(z.size){const e=new Map;pl(e,y,t,(t=>z.has(t))),pl(d,y,t,(t=>z.has(t)));const n=function(t,e){for(const n in t){const r=t[n],o=e[n];void 0===r.label&&o&&(r.label=o.label)}return t}(Lr(e,t),g),{scales:r,...o}=Ar(n);Object.assign(g,n),Object.assign(x,o),Object.assign(x.scales,r)}let E,R;void 0!==m&&(E={x:w?.domain(),y:b?.domain()},m=function(t,{x:e,y:n}){return e&&=So(e),n&&=So(n),t.filter(e&&n?t=>e.has(t.x)&&n.has(t.y):e?t=>e.has(t.x):t=>n.has(t.y)).sort(e&&n?(t,r)=>e.get(t.x)-e.get(r.x)||n.get(t.y)-n.get(r.y):e?(t,n)=>e.get(t.x)-e.get(n.x):(t,e)=>n.get(t.y)-n.get(e.y))}(m,E),R=function(t,e,{marginTop:n,marginLeft:r}){return t&&e?({x:o,y:i})=>`translate(${t(o)-r},${e(i)-n})`:t?({x:e})=>`translate(${t(e)-r},0)`:({y:t})=>`translate(0,${e(t)-n})`}(w,b,v));for(const[t,e]of y)e.values=t.scale(e.channels,x,M);const{width:C,height:T}=v;e.select(A).attr("class",c).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",C).attr("height",T).attr("viewBox",`0 0 ${C} ${T}`).attr("aria-label",l).attr("aria-description",s).call((t=>t.append("style").text(`:where(.${c}) {\n  --plot-background: white;\n  display: block;\n  height: auto;\n  height: intrinsic;\n  max-width: 100%;\n}\n:where(.${c} text),\n:where(.${c} tspan) {\n  white-space: pre;\n}`))).call(xo,r);for(const t of u){const{channels:n,values:r,facets:o}=y.get(t);if(void 0===m||"super"===t.facet){let e=null;if(o&&(e=o[0],e=t.filter(e,n,r),0===e.length))continue;const i=t.render(e,x,r,$,M);if(null==i)continue;A.appendChild(i)}else{let i;for(const a of m){if(!(t.facetAnchor?.(m,E,a)??!a.empty))continue;let l=null;if(o){const e=h.has(t);if(l=o[e?a.i:0],l=t.filter(l,n,r),0===l.length)continue;e||l!==o[0]||(l=zt(l)),l.fx=a.x,l.fy=a.y,l.fi=a.i}const s=t.render(l,x,r,k,M);if(null!=s){(i??=e.select(A).append("g")).append((()=>s)).datum(a);for(const t of["aria-label","aria-description","aria-hidden","transform"])s.hasAttribute(t)&&(i.attr(t,s.getAttribute(t)),s.removeAttribute(t))}}i?.selectChildren().attr("transform",R)}}const B=function(t,e,n){const r=[];for(const[o,i]of Fa){const a=n[o];if(a?.legend&&o in t){const n=i(t[o],Da(e,t[o],a),(e=>t[e]));null!=n&&r.push(n)}}return r}(g,M,t),{figure:N=null!=o||null!=i||null!=a||B.length>0}=t;N&&(S=L.createElement("figure"),S.className=`${c}-figure`,S.style.maxWidth="initial",null!=o&&S.append(ll(L,o,"h2")),null!=i&&S.append(ll(L,i,"h3")),S.append(...B,A),null!=a&&S.append(function(t,e){const n=t.createElement("figcaption");return n.append(e),n}(L,a))),S.scale=function(t){return e=>{if(!fe.has(e=`${e}`))throw new Error(`unknown scale: ${e}`);return t[e]}}(x.scales),S.legend=function(t,e,n={}){return(r,o)=>{if(!Fa.has(r))throw new Error(`unknown legend type: ${r}`);if(r in t)return Fa.get(r)(t[r],Da(e,n[r],o),(e=>t[e]))}}(g,M,t);const I=function(){const t=Mn;return Mn=0,$n=void 0,t}();return I>0&&e.select(A).append("text").attr("x",C).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("⚠️").append("title").text(`${I.toLocaleString("en-US")} warning${1===I?"":"s"}. Please check the console.`),S}function ll(t,e,n){if(e.ownerDocument)return e;const r=t.createElement(n);return r.append(e),r}function sl(t){return t.flat(1/0).filter((t=>null!=t)).map(cl)}function cl(t){return"function"==typeof t.render?t:new ul(t)}Io.prototype.plot=function({marks:t=[],...e}={}){return al({...e,marks:[...t,this]})};class ul extends Io{constructor(t){if("function"!=typeof t)throw new TypeError("invalid mark; missing render function");super(),this.render=t}render(){}}function fl(t,e){for(const n in t)hl(t[n],e);return t}function hl(t,e){const{scale:n,transform:r=!0}=t;if(null==n||!r)return;const{type:o,percent:i,interval:a,transform:l=(i?t=>100*t:It(a,o))}=e[n]??{};null!=l&&(t.value=dt(t.value,l),t.transform=!1)}function dl(t){for(const e in t)hn(e,t[e])}function pl(t,e,n,r=V){for(const{channels:o}of e.values())for(const e in o){const i=o[e],{scale:a}=i;if(null!=a&&r(a))if("projection"===a){if(!In(n)){const e=void 0===n.x?.domain,r=void 0===n.y?.domain;if(e||r){const[n,o]=Wn(i);e&&ml(t,"x",n),r&&ml(t,"y",o)}}}else ml(t,a,i)}return t}function ml(t,e,n){const r=t.get(e);void 0!==r?r.push(n):t.set(e,[n])}function yl(t,e,n){if(null===t.facet||"super"===t.facet)return;const{fx:r,fy:o}=t;if(null!=r||null!=o){const e=ht(t.data??r??o);if(void 0===e)throw new Error(`missing facet data in ${t.ariaLabel}`);if(null===e)return;const i={};return null!=r&&(i.fx=cn(e,{value:r,scale:"fx"})),null!=o&&(i.fy=cn(e,{value:o,scale:"fy"})),fl(i,n),{channels:i,groups:$o(e,i)}}if(void 0===e)return;const{channels:i,groups:a,data:l}=e;if("auto"!==t.facet||t.data===l)return{channels:i,groups:a};l.length>0&&(a.size>1||1===a.size&&i.fx&&i.fy&&[...a][0][1].size>1)&&ht(t.data)?.length===l.length&&Ln(`Warning: the ${t.ariaLabel} mark appears to use faceted data, but isn’t faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}function gl(t,e={}){return we({...e,x:null,y:null},((e,n,r,o,i,a)=>a.getMarkState(t)))}function vl(t,e,n,r,o,i,a){if(!e)return;const l=/^\s*both\s*$/i.test(e);a=function(t,e,{line:n=e.line,ticks:r,tickSize:o,tickSpacing:i,tickPadding:a,tickFormat:l,tickRotate:s,fontVariant:c,ariaLabel:u,ariaDescription:f,label:h=e.label,labelAnchor:d,labelArrow:p=e.labelArrow,labelOffset:m}){return{anchor:t,line:n,ticks:r,tickSize:o,tickSpacing:i,tickPadding:a,tickFormat:l,tickRotate:s,fontVariant:c,ariaLabel:u,ariaDescription:f,label:h,labelAnchor:d,labelArrow:p,labelOffset:m}}(l?r:e,i,a);const{line:s}=a;n!==da&&n!==ma||!s||Kt(s)||t.push(Ua(function(t){const{anchor:e,line:n}=t;return{anchor:e,facetAnchor:e+"-empty",stroke:!0===n?void 0:n}}(a))),t.push(n(a)),l&&t.push(n({...a,anchor:o,label:null}))}function xl(t,e,n,r){e&&!Kt(e)&&t.push(n(function(t,{stroke:e=(Zt(t)?t:void 0),ticks:n=(wl(t)?t:void 0),tickSpacing:r,ariaLabel:o,ariaDescription:i}){return{stroke:e,ticks:n,tickSpacing:r,ariaLabel:o,ariaDescription:i}}(e,r)))}function wl(t){switch(typeof t){case"number":return!0;case"string":return!Zt(t)}return Ft(t)||"function"==typeof t?.range}function bl(t,e){const n=`${e}-axis `;return t.some((t=>t.ariaLabel?.startsWith(n)))}function kl(t,e){for(const n of e)for(const e in n.channels){const{scale:r}=n.channels[e];if(r===t||"projection"===r)return!0}return!1}function $l(t){const e=t.domain();let n=t(e[0]),r=t(e[e.length-1]);return r<n&&([n,r]=[r,n]),[n,r+t.bandwidth()]}const Ml=new Map([["basis",e.curveBasis],["basis-closed",e.curveBasisClosed],["basis-open",e.curveBasisOpen],["bundle",e.curveBundle],["bump-x",e.curveBumpX],["bump-y",e.curveBumpY],["cardinal",e.curveCardinal],["cardinal-closed",e.curveCardinalClosed],["cardinal-open",e.curveCardinalOpen],["catmull-rom",e.curveCatmullRom],["catmull-rom-closed",e.curveCatmullRomClosed],["catmull-rom-open",e.curveCatmullRomOpen],["linear",e.curveLinear],["linear-closed",e.curveLinearClosed],["monotone-x",e.curveMonotoneX],["monotone-y",e.curveMonotoneY],["natural",e.curveNatural],["step",e.curveStep],["step-after",e.curveStepAfter],["step-before",e.curveStepBefore]]);function Ll(t=e.curveLinear,n){if("function"==typeof t)return t;const r=Ml.get(`${t}`.toLowerCase());if(!r)throw new Error(`unknown curve: ${t}`);if(void 0!==n){if("beta"in r)return r.beta(n);if("tension"in r)return r.tension(n);if("alpha"in r)return r.alpha(n)}return r}function Al(t=Sl,e){return"function"!=typeof t&&"auto"===`${t}`.toLowerCase()?Sl:Ll(t,e)}function Sl(t){return e.curveLinear(t)}function zl(t={y:"count"},e={}){[t,e]=Nl(t,e);const{x:n,y:r}=e;return Bl(Il(n,e,H),null,null,r,t,li(e))}function Ol(t={x:"count"},e={}){[t,e]=Nl(t,e);const{x:n,y:r}=e;return Bl(null,Il(r,e,H),n,null,t,si(e))}function El(t={fill:"count"},e={}){[t,e]=Nl(t,e);const{x:n,y:r}=function(t){let{x:e,y:n}=t;return e=Il(e,t),n=Il(n,t),[e.value,n.value]=$t(e.value,n.value),{x:e,y:n}}(e);return Bl(n,r,null,null,t,li(si(e)))}function Rl(t,e,n={}){if(null==n?.interval)return n;const{reduce:r=Je}=n,o={filter:null};return null!=n[e]&&(o[e]=r),null!=n[`${e}1`]&&(o[`${e}1`]=r),null!=n[`${e}2`]&&(o[`${e}2`]=r),t(o,n)}function Cl(t={}){return Rl(zl,"y",qo(t,"x"))}function Tl(t={}){return Rl(Ol,"x",qo(t,"y"))}function Bl(t,e,n,r,{data:o=Qe,filter:i=en,sort:a,reverse:l,...s}={},c={}){t=Pl(t),e=Pl(e),s=function(t,e){return Ie(t,e,jl)}(s,c),o=Fl(o,H),a=null==a?void 0:jl("sort",a,c),i=null==i?void 0:ql("filter",i,c),null!=n&&Ne(s,"x","x1","x2")&&(n=null),null!=r&&Ne(s,"y","y1","y2")&&(r=null);const[u,f]=Ct(t),[h,d]=Ct(t),[p,m]=Ct(e),[y,g]=Ct(e),[v,x]=null!=n?[n,"x"]:null!=r?[r,"y"]:[],[w,b]=Ct(v),{x:k,y:$,z:M,fill:L,stroke:A,x1:S,x2:z,y1:O,y2:E,domain:R,cumulative:C,thresholds:T,interval:B,...N}=c,[I,P]=Ct(M),[W]=st(L),[j]=st(A),[q,D]=Ct(W),[Y,_]=Ct(j);return{..."z"in c&&{z:I||M},..."fill"in c&&{fill:q||L},..."stroke"in c&&{stroke:Y||A},...xe(N,((n,r,c)=>{const u=Nt(F(n,v),c?.[x]),h=F(n,M),p=F(n,W),y=F(n,j),w=He(s,{z:h,fill:p,stroke:y}),k=[],$=[],L=u&&b([]),A=h&&P([]),S=p&&D([]),z=y&&_([]),O=t&&f([]),E=t&&d([]),R=e&&m([]),C=e&&g([]),T=function(t,e,n){const r=t?.(n),o=e?.(n);return r&&o?function*(t){const e=r.bin(t);for(const[t,[i,a]]of r.entries()){const r=o.bin(e[t]);for(const[t,[e,l]]of o.entries())yield[r[t],{data:n,x1:i,y1:e,x2:a,y2:l}]}}:r?function*(t){const e=r.bin(t);for(const[t,[o,i]]of r.entries())yield[e[t],{data:n,x1:o,x2:i}]}:function*(t){const e=o.bin(t);for(const[t,[r,i]]of o.entries())yield[e[t],{data:n,y1:r,y2:i}]}}(t,e,n);let B=0;for(const t of s)t.initialize(n);a&&a.initialize(n),i&&i.initialize(n);for(const t of r){const e=[];for(const e of s)e.scope("facet",t);a&&a.scope("facet",t),i&&i.scope("facet",t);for(const[r,l]of je(t,w))for(const[t,c]of je(l,u))for(const[l,f]of T(c))if(w&&(f.z=r),!i||i.reduce(l,f)){e.push(B++),$.push(o.reduceIndex(l,n,f)),u&&L.push(t),h&&A.push(w===h?r:h[(l.length>0?l:c)[0]]),p&&S.push(w===p?r:p[(l.length>0?l:c)[0]]),y&&z.push(w===y?r:y[(l.length>0?l:c)[0]]),O&&(O.push(f.x1),E.push(f.x2)),R&&(R.push(f.y1),C.push(f.y2));for(const t of s)t.reduce(l,f);a&&a.reduce(l,f)}k.push(e)}return Ue(k,a,l),{data:$,facets:k}})),...!Ne(s,"x")&&(u?{x1:u,x2:h,x:Bt(u,h)}:{x:k,x1:S,x2:z}),...!Ne(s,"y")&&(p?{y1:p,y2:y,y:Bt(p,y)}:{y:$,y1:O,y2:E}),...w&&{[x]:w},...Object.fromEntries(s.map((({name:t,output:e})=>[t,e])))}}function Nl({cumulative:t,domain:e,thresholds:n,interval:r,...o},i){return[o,{cumulative:t,domain:e,thresholds:n,interval:r,...i}]}function Il(t,{cumulative:e,domain:n,thresholds:r,interval:o},i){return void 0===(t={...qt(t)}).domain&&(t.domain=n),void 0===t.cumulative&&(t.cumulative=e),void 0===t.thresholds&&(t.thresholds=r),void 0===t.interval&&(t.interval=o),void 0===t.value&&(t.value=i),t.thresholds=Wl(t.thresholds,t.interval),t}function Pl(t){if(null==t)return;const{value:n,cumulative:r,domain:o=e.extent,thresholds:i}=t,a=t=>{let a,l=F(t,n);if(_t(l)||(function(t){return jt(t)&&"function"==typeof t?.floor&&t.floor()instanceof Date}(s=i)||Ft(s)&&_t(s))){l=dt(l,lt,Float64Array);let[t,n]="function"==typeof o?o(l):o,r="function"!=typeof i||jt(i)?i:i(l,t,n);"number"==typeof r&&(r=e.utcTickInterval(t,n,r)),jt(r)&&(o===e.extent&&(t=r.floor(t),n=r.offset(r.floor(n))),r=r.range(t,r.offset(n))),a=r}else{l=rt(l);let[t,n]="function"==typeof o?o(l):o,r="function"!=typeof i||jt(i)?i:i(l,t,n);if("number"==typeof r)if(o===e.extent){let o=e.tickIncrement(t,n,r);if(isFinite(o))if(o>0){let e=Math.round(t/o),i=Math.round(n/o);e*o<=t||--e,i*o>n||++i;let a=i-e+1;r=new Float64Array(a);for(let t=0;t<a;++t)r[t]=(e+t)*o}else if(o<0){o=-o;let e=Math.round(t*o),i=Math.round(n*o);e/o<=t||--e,i/o>n||++i;let a=i-e+1;r=new Float64Array(a);for(let t=0;t<a;++t)r[t]=(e+t)/o}else r=[t];else r=[t]}else r=e.ticks(t,n,r);else jt(r)&&(o===e.extent&&(t=r.floor(t),n=r.offset(r.floor(n))),r=r.range(t,r.offset(n)));a=r}var s;const c=[];if(1===a.length)c.push([a[0],a[0]]);else for(let t=1;t<a.length;++t)c.push([a[t-1],a[t]]);return c.bin=(r<0?Xl:r>0?Gl:_l)(c,a,l),c};return a.label=Tt(n),a}function Wl(t,n,r=Yl){if(void 0===t)return void 0===n?r:Wt(n);if("string"==typeof t){switch(t.toLowerCase()){case"freedman-diaconis":return e.thresholdFreedmanDiaconis;case"scott":return e.thresholdScott;case"sturges":return e.thresholdSturges;case"auto":return Yl}return C(t)}return t}function jl(t,e,n){return Pe(t,e,n,ql)}function ql(t,e,n){return We(t,e,n,Fl)}function Fl(t,e){return qe(t,e,Dl)}function Dl(t){switch(`${t}`.toLowerCase()){case"x":return Ul;case"x1":return Zl;case"x2":return Ql;case"y":return Vl;case"y1":return Jl;case"y2":return Kl;case"z":return sn}throw new Error(`invalid bin reduce: ${t}`)}function Yl(t,n,r){return Math.min(200,e.thresholdScott(t,n,r))}function _l(t,n,r){return n=rt(n),o=>{const i=t.map((()=>[]));for(const t of o)i[e.bisect(n,r[t])-1]?.push(t);return i}}function Gl(t,e,n){const r=_l(t,e,n);return t=>{const e=r(t);for(let t=1,n=e.length;t<n;++t){const n=e[t-1],r=e[t];for(const t of n)r.push(t)}return e}}function Xl(t,e,n){const r=_l(t,e,n);return t=>{const e=r(t);for(let t=e.length-2;t>=0;--t){const n=e[t+1],r=e[t];for(const t of n)r.push(t)}return e}}function Hl(t,e){const n=(+t+ +e)/2;return t instanceof Date?new Date(n):n}const Ul={reduceIndex:(t,e,{x1:n,x2:r})=>Hl(n,r)},Vl={reduceIndex:(t,e,{y1:n,y2:r})=>Hl(n,r)},Zl={reduceIndex:(t,e,{x1:n})=>n},Ql={reduceIndex:(t,e,{x2:n})=>n},Jl={reduceIndex:(t,e,{y1:n})=>n},Kl={reduceIndex:(t,e,{y2:n})=>n};function ts(t={}){return mt(t)?t:{...t,x:H}}function es(t={}){return yt(t)?t:{...t,y:H}}function ns(t={},e={}){1===arguments.length&&([t,e]=as(t));const{y1:n,y:r=n,x:o,...i}=e,[a,l,s,c]=ss(r,o,"y","x",t,i);return{...a,y1:n,y:l,x1:s,x2:c,x:Bt(s,c)}}function rs(t={},e={}){1===arguments.length&&([t,e]=as(t));const{x1:n,x:r=n,y:o,...i}=e,[a,l,s,c]=ss(r,o,"x","y",t,i);return{...a,x1:n,x:l,y1:s,y2:c,y:Bt(s,c)}}function os({x:t,x1:e,x2:n,...r}={}){return r=qo(r,"y"),void 0===e&&void 0===n?ns({x:t,...r}):([e,n]=kt(t,e,n),{...r,x1:e,x2:n})}function is({y:t,y1:e,y2:n,...r}={}){return r=qo(r,"x"),void 0===e&&void 0===n?rs({y:t,...r}):([e,n]=kt(t,e,n),{...r,y1:e,y2:n})}function as(t){const{offset:e,order:n,reverse:r,...o}=t;return[{offset:e,order:n,reverse:r},o]}const ls={length:!0};function ss(t,n=U,i,a,{offset:l,order:s,reverse:c},u){if(null===n)throw new Error(`stack requires ${a}`);const f=Mt(u),[h,d]=Ct(t),[p,m]=Rt(n),[y,g]=Rt(n);return p.hint=y.hint=ls,l=function(t){if(null==t)return;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"expand":case"normalize":return us;case"center":case"silhouette":return fs;case"wiggle":return hs}throw new Error(`unknown offset: ${t}`)}(l),s=function(t,n,i){if(void 0===t&&n===hs)return ms(r);if(null==t)return;if("string"==typeof t){const n=t.startsWith("-"),a=n?o:r;switch((n?t.slice(1):t).toLowerCase()){case"value":case i:return function(t){return(e,n,r)=>(e,n)=>t(r[e],r[n])}(a);case"z":return function(t){return(e,n,r,o)=>(e,n)=>t(o[e],o[n])}(a);case"sum":return function(t){return vs(t,((t,n,r,o)=>e.groupSort(Lt(t),(t=>e.sum(t,(t=>r[t]))),(t=>o[t]))))}(a);case"appearance":return function(t){return vs(t,((t,n,r,o)=>e.groupSort(Lt(t),(t=>n[e.greatest(t,(t=>r[t]))]),(t=>o[t]))))}(a);case"inside-out":return ms(a)}return ys(G(t))}if("function"==typeof t)return(1===t.length?ys:gs)(t);if(Array.isArray(t))return a=t,vs(r,(()=>a));var a;throw new Error(`invalid order: ${t}`)}(s,l,a),[xe(u,((r,o,a)=>{({data:r,facets:o}=function(t,e){if(1===e.length)return{data:t,facets:e};const n=t.length,r=new Uint8Array(n);let o=0;for(const t of e)for(const e of t)r[e]&&++o,r[e]=1;if(0===o)return{data:t,facets:e};const i=(t=pt(t))[q]=new Uint32Array(n+o);e=e.map((t=>pt(t,Uint32Array)));let a=n;r.fill(0);for(const n of e)for(let e=0,o=n.length;e<o;++e){const o=n[e];r[o]?(n[e]=a,t[a]=t[o],i[a]=o,++a):i[o]=o,r[o]=1}return{data:t,facets:e}}(r,o));const u=null==t?void 0:d(Nt(F(r,t),a?.[i])),h=F(r,n,Float64Array),p=F(r,f),y=s&&s(r,u,h,p),v=r.length,x=m(new Float64Array(v)),w=g(new Float64Array(v)),b=[];for(const t of o){const n=u?Array.from(e.group(t,(t=>u[t])).values()):[t];if(y)for(const t of n)t.sort(y);for(const t of n){let e=0,n=0;c&&t.reverse();for(const r of t){const t=h[r];t<0?e=w[r]=(x[r]=e)+t:t>0?n=w[r]=(x[r]=n)+t:w[r]=x[r]=n}}b.push(n)}return l&&l(b,x,w,p),{data:r,facets:o}})),h,p,y]}function cs(t,e){let n=0,r=0;for(const o of t){const t=e[o];t<n&&(n=t),t>r&&(r=t)}return[n,r]}function us(t,e,n){for(const r of t)for(const t of r){const[r,o]=cs(t,n);for(const i of t){const t=1/(o-r||1);e[i]=t*(e[i]-r),n[i]=t*(n[i]-r)}}}function fs(t,e,n){for(const r of t){for(const t of r){const[r,o]=cs(t,n);for(const i of t){const t=(o+r)/2;e[i]-=t,n[i]-=t}}ds(r,e,n)}ps(t,e,n)}function hs(t,n,r,o){for(const i of t){const t=new e.InternMap;let a=0;for(const l of i){let i=-1;const s=l.map((t=>Math.abs(r[t]-n[t]))),c=l.map((e=>{i=o?o[e]:++i;const a=r[e]-n[e],l=t.has(i)?a-t.get(i):0;return t.set(i,a),l})),u=[0,...e.cumsum(c)];for(const t of l)n[t]+=a,r[t]+=a;const f=e.sum(s);f&&(a-=e.sum(s,((t,e)=>(c[e]/2+u[e])*t))/f)}ds(i,n,r)}ps(t,n,r)}function ds(t,n,r){const o=e.min(t,(t=>e.min(t,(t=>n[t]))));for(const e of t)for(const t of e)n[t]-=o,r[t]-=o}function ps(t,n,r){const o=t.length;if(1===o)return;const i=t.map((t=>t.flat())),a=i.map((t=>(e.min(t,(t=>n[t]))+e.max(t,(t=>r[t])))/2)),l=e.min(a);for(let t=0;t<o;t++){const e=l-a[t];for(const o of i[t])n[o]+=e,r[o]+=e}}function ms(t){return vs(t,((t,n,r,o)=>{const i=Lt(t),a=e.groupSort(i,(t=>n[e.greatest(t,(t=>r[t]))]),(t=>o[t])),l=e.rollup(i,(t=>e.sum(t,(t=>r[t]))),(t=>o[t])),s=[],c=[];let u=0;for(const t of a)u<0?(u+=l.get(t),s.push(t)):(u-=l.get(t),c.push(t));return c.reverse().concat(s)}))}function ys(t){return e=>{const n=F(e,t);return(t,e)=>r(n[t],n[e])}}function gs(t){return e=>(n,r)=>t(e[n],e[r])}function vs(t,n){return(r,o,i,a)=>{if(!a)throw new Error("missing channel: z");const l=new e.InternMap(n(r,o,i,a).map(((t,e)=>[t,e])));return(e,n)=>t(l.get(a[e]),l.get(a[n]))}}const xs={ariaLabel:"area",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class ws extends Io{constructor(t,e={}){const{x1:n,y1:r,x2:o,y2:i,z:a,curve:l,tension:s}=e;super(t,{x1:{value:n,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0},z:{value:Mt(e),optional:!0}},e,xs),this.z=a,this.curve=Ll(l,s)}filter(t){return t}render(t,n,r,o,i){const{x1:a,y1:l,x2:s=a,y2:c=l}=r;return kn("svg:g",i).call(co,this,o,i).call(po,this,n,0,0).call((n=>n.selectAll().data(so(t,[a,l,s,c],this,r)).enter().append("path").call(uo,this).call(ao,this,r).attr("d",e.area().curve(this.curve).defined((t=>t>=0)).x0((t=>a[t])).y0((t=>l[t])).x1((t=>s[t])).y1((t=>c[t]))))).node()}}function bs(t,e){return void 0===e?$s(t,{x:J,y:K}):new ws(t,e)}function ks(t,e){const{y:n=X,...r}=Tl(e);return new ws(t,os(ts({...r,y1:n,y2:void 0})))}function $s(t,e){const{x:n=X,...r}=Cl(e);return new ws(t,is(es({...r,x1:n,x2:void 0})))}const Ms={ariaLabel:"link",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class Ls extends Io{constructor(t,e={}){const{x1:n,y1:r,x2:o,y2:i,curve:a,tension:l}=e;super(t,{x1:{value:n,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},e,Ms),this.curve=Al(a,l),Zo(this,e)}project(t,e,n){this.curve!==Sl&&super.project(t,e,n)}render(t,n,r,o,i){const{x1:a,y1:l,x2:s=a,y2:c=l}=r,{curve:u}=this;return kn("svg:g",i).call(co,this,o,i).call(po,this,n).call((n=>n.selectAll().data(t).enter().append("path").call(uo,this).attr("d",u===Sl&&i.projection?function(t,n,r,o,i){const a=e.geoPath(t);return n=rt(n),r=rt(r),o=rt(o),i=rt(i),t=>a({type:"LineString",coordinates:[[n[t],r[t]],[o[t],i[t]]]})}(i.projection,a,l,s,c):t=>{const n=e.pathRound(),r=u(n);return r.lineStart(),r.point(a[t],l[t]),r.point(s[t],c[t]),r.lineEnd(),n}).call(io,this,r).call(oi,this,r,i))).node()}}function As(t,{x:e,x1:n,x2:r,y:o,y1:i,y2:a,...l}={}){return[n,r]=Ss(e,n,r),[i,a]=Ss(o,i,a),new Ls(t,{...l,x1:n,x2:r,y1:i,y2:a})}function Ss(t,e,n){if(void 0===t){if(void 0===e){if(void 0!==n)return[n]}else if(void 0===n)return[e]}else{if(void 0===e)return void 0===n?[t]:[t,n];if(void 0===n)return[t,e]}return[e,n]}const zs={ariaLabel:"arrow",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:1,strokeWidth:1.5};class Os extends Io{constructor(t,n={}){const{x1:r,y1:o,x2:i,y2:a,bend:l=0,headAngle:s=60,headLength:c=8,inset:u=0,insetStart:f=u,insetEnd:h=u,sweep:d}=n;super(t,{x1:{value:r,scale:"x"},y1:{value:o,scale:"y"},x2:{value:i,scale:"x",optional:!0},y2:{value:a,scale:"y",optional:!0}},n,zs),this.bend=!0===l?22.5:Math.max(-90,Math.min(90,l)),this.headAngle=+s,this.headLength=+c,this.insetStart=+f,this.insetEnd=+h,this.sweep=function(t=1){if("number"==typeof t)return et(Math.sign(t));if("function"==typeof t)return(e,n,r,o)=>Math.sign(t(e,n,r,o));switch(ft(t,"sweep",["+x","-x","+y","-y"])){case"+x":return(t,n,r)=>e.ascending(t,r);case"-x":return(t,n,r)=>e.descending(t,r);case"+y":return(t,n,r,o)=>e.ascending(n,o);case"-y":return(t,n,r,o)=>e.descending(n,o)}}(d)}render(t,e,n,r,o){const{x1:i,y1:a,x2:l=i,y2:s=a,SW:c}=n,{strokeWidth:u,bend:f,headAngle:h,headLength:d,insetStart:p,insetEnd:m}=this,y=c?t=>c[t]:et(void 0===u?1:u),g=h*Vo/2,v=d/1.5;return kn("svg:g",o).call(co,this,r,o).call(po,this,e).call((e=>e.selectAll().data(t).enter().append("path").call(uo,this).attr("d",(t=>{let e=i[t],n=a[t],r=l[t],o=s[t];const c=Math.hypot(r-e,o-n);if(c<=p+m)return null;let u=Math.atan2(o-n,r-e);const h=Math.min(v*y(t),c/3),d=this.sweep(e,n,r,o)*f*Vo,x=Math.hypot(c/Math.tan(d),c)/2;if(p||m)if(x<1e5){const t=Math.sign(d),[i,a]=function([t,e],[n,r],o,i){const a=n-t,l=r-e,s=Math.hypot(a,l),c=i*Math.sqrt(o*o-s*s/4)/s;return[(t+n)/2-l*c,(e+r)/2+a*c]}([e,n],[r,o],x,t);if(p&&([e,n]=Es([i,a,x],[e,n,p],-t*Math.sign(p))),m){const[e,n]=Es([i,a,x],[r,o,m],t*Math.sign(m));u+=Math.atan2(n-a,e-i)-Math.atan2(o-a,r-i),r=e,o=n}}else{const t=r-e,i=o-n,a=Math.hypot(t,i);p&&(e+=t/a*p,n+=i/a*p),m&&(r-=t/a*m,o-=i/a*m)}const w=u+d,b=w+g,k=w-g,$=r-h*Math.cos(b),M=o-h*Math.sin(b),L=r-h*Math.cos(k),A=o-h*Math.sin(k);return`M${e},${n}${x<1e5?`A${x},${x} 0,0,${d>0?1:0} `:"L"}${r},${o}${h?`M${$},${M}L${r},${o}L${L},${A}`:""}`})).call(io,this,n))).node()}}function Es([t,e,n],[r,o,i],a){const l=r-t,s=o-e,c=Math.hypot(l,s),u=(l*l+s*s-i*i+n*n)/(2*c),f=a*Math.sqrt(n*n-u*u);return[t+(l*u+s*f)/c,e+(s*u-l*f)/c]}class Rs extends Io{constructor(t,e,n={},r){super(t,e,n,r);const{inset:o=0,insetTop:i=o,insetRight:a=o,insetBottom:l=o,insetLeft:s=o,rx:c,ry:u}=n;this.insetTop=Q(i),this.insetRight=Q(a),this.insetBottom=Q(l),this.insetLeft=Q(s),this.rx=mo(c,"auto"),this.ry=mo(u,"auto")}render(t,e,n,r,o){const{rx:i,ry:a}=this;return kn("svg:g",o).call(co,this,r,o).call(this._transform,this,e).call((o=>o.selectAll().data(t).enter().append("rect").call(uo,this).attr("x",this._x(e,n,r)).attr("width",this._width(e,n,r)).attr("y",this._y(e,n,r)).attr("height",this._height(e,n,r)).call(ho,"rx",i).call(ho,"ry",a).call(io,this,n))).node()}_x(t,{x:e},{marginLeft:n}){const{insetLeft:r}=this;return e?t=>e[t]+r:n+r}_y(t,{y:e},{marginTop:n}){const{insetTop:r}=this;return e?t=>e[t]+r:n+r}_width({x:t},{x:e},{marginRight:n,marginLeft:r,width:o}){const{insetLeft:i,insetRight:a}=this,l=e&&t?t.bandwidth():o-n-r;return Math.max(0,l-i-a)}_height({y:t},{y:e},{marginTop:n,marginBottom:r,height:o}){const{insetTop:i,insetBottom:a}=this,l=e&&t?t.bandwidth():o-n-r;return Math.max(0,l-i-a)}}const Cs={ariaLabel:"bar"};class Ts extends Rs{constructor(t,e={}){const{x1:n,x2:r,y:o}=e;super(t,{x1:{value:n,scale:"x"},x2:{value:r,scale:"x"},y:{value:o,scale:"y",type:"band",optional:!0}},e,Cs)}_transform(t,e,{x:n}){t.call(po,e,{x:n},0,0)}_x({x:t},{x1:e,x2:n},{marginLeft:r}){const{insetLeft:o}=this;return Yr(t)?r+o:t=>Math.min(e[t],n[t])+o}_width({x:t},{x1:e,x2:n},{marginRight:r,marginLeft:o,width:i}){const{insetLeft:a,insetRight:l}=this;return Yr(t)?i-r-o-a-l:t=>Math.max(0,Math.abs(n[t]-e[t])-a-l)}}class Bs extends Rs{constructor(t,e={}){const{x:n,y1:r,y2:o}=e;super(t,{y1:{value:r,scale:"y"},y2:{value:o,scale:"y"},x:{value:n,scale:"x",type:"band",optional:!0}},e,Cs)}_transform(t,e,{y:n}){t.call(po,e,{y:n},0,0)}_y({y:t},{y1:e,y2:n},{marginTop:r}){const{insetTop:o}=this;return Yr(t)?r+o:t=>Math.min(e[t],n[t])+o}_height({y:t},{y1:e,y2:n},{marginTop:r,marginBottom:o,height:i}){const{insetTop:a,insetBottom:l}=this;return Yr(t)?i-r-o-a-l:t=>Math.max(0,Math.abs(n[t]-e[t])-a-l)}}function Ns(t,e={}){return gt(e)||(e={...e,y:X,x2:H}),new Ts(t,os(mi(ts(e))))}function Is(t,e={}){return gt(e)||(e={...e,x:X,y2:H}),new Bs(t,is(yi(es(e))))}const Ps={ariaLabel:"cell"};class Ws extends Rs{constructor(t,{x:e,y:n,...r}={}){super(t,{x:{value:e,scale:"x",type:"band",optional:!0},y:{value:n,scale:"y",type:"band",optional:!0}},r,Ps)}_transform(t,e){t.call(po,e,{},0,0)}}function js(t,{x:e,y:n,...r}={}){return[e,n]=$t(e,n),new Ws(t,{...r,x:e,y:n})}const qs={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};function Fs(t){return void 0===t.sort&&void 0===t.reverse?Ae({channel:"-r"},t):t}class Ds extends Io{constructor(t,n={}){const{x:r,y:o,r:i,rotate:a,symbol:s=e.symbolCircle,frameAnchor:c}=n,[u,f]=ct(a,0),[h,d]=function(t){if(null==t||ye(t))return[void 0,t];if("string"==typeof t){const e=me.get(`${t}`.toLowerCase());if(e)return[void 0,e]}return[t,void 0]}(s),[p,m]=ct(i,null==h?3:4.5);super(t,{x:{value:r,scale:"x",optional:!0},y:{value:o,scale:"y",optional:!0},r:{value:p,scale:"r",filter:l,optional:!0},rotate:{value:u,optional:!0},symbol:{value:h,scale:"auto",optional:!0}},Fs(n),qs),this.r=m,this.rotate=f,this.symbol=d,this.frameAnchor=ee(c);const{channels:y}=this,{symbol:g}=y;if(g){const{fill:t,stroke:e}=y;g.hint={fill:t?t.value===g.value?"color":"currentColor":this.fill??"currentColor",stroke:e?e.value===g.value?"color":"currentColor":this.stroke??"none"}}}render(t,n,r,o,i){const{x:a,y:l}=n,{x:c,y:u,r:f,rotate:h,symbol:d}=r,{r:p,rotate:m,symbol:y}=this,[g,v]=wo(this,o),x=y===e.symbolCircle,w=f?void 0:p*p*Math.PI;return s(p)&&(t=[]),kn("svg:g",i).call(co,this,o,i).call(po,this,{x:c&&a,y:u&&l}).call((n=>n.selectAll().data(t).enter().append(x?"circle":"path").call(uo,this).call(x?t=>{t.attr("cx",c?t=>c[t]:g).attr("cy",u?t=>u[t]:v).attr("r",f?t=>f[t]:p)}:t=>{t.attr("transform",Li`translate(${c?t=>c[t]:g},${u?t=>u[t]:v})${h?t=>` rotate(${h[t]})`:m?` rotate(${m})`:""}`).attr("d",f&&d?t=>{const n=e.pathRound();return d[t].draw(n,f[t]*f[t]*Math.PI),n}:f?t=>{const n=e.pathRound();return y.draw(n,f[t]*f[t]*Math.PI),n}:d?t=>{const n=e.pathRound();return d[t].draw(n,w),n}:(()=>{const t=e.pathRound();return y.draw(t,w),t})())}).call(io,this,r))).node()}}function Ys(t,{x:e,y:n,...r}={}){return void 0===r.frameAnchor&&([e,n]=$t(e,n)),new Ds(t,{...r,x:e,y:n})}const _s={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Gs extends Io{constructor(t,e={}){const{x:n,y:r,z:o,curve:i,tension:a}=e;super(t,{x:{value:n,scale:"x"},y:{value:r,scale:"y"},z:{value:Mt(e),optional:!0}},e,_s),this.z=o,this.curve=Al(i,a),Zo(this,e)}filter(t){return t}project(t,e,n){this.curve!==Sl&&super.project(t,e,n)}render(t,n,r,o,i){const{x:a,y:l}=r,{curve:s}=this;return kn("svg:g",i).call(co,this,o,i).call(po,this,n).call((n=>n.selectAll().data(so(t,[a,l],this,r)).enter().append("path").call(uo,this).call(ao,this,r).call(ii,this,r,i).attr("d",s===Sl&&i.projection?function(t,n,r){const o=e.geoPath(t);return n=rt(n),r=rt(r),t=>{let e=[];const i=[e];for(const o of t)-1===o?(e=[],i.push(e)):e.push([n[o],r[o]]);return o({type:"MultiLineString",coordinates:i})}}(i.projection,a,l):e.line().curve(s).defined((t=>t>=0)).x((t=>a[t])).y((t=>l[t]))))).node()}}function Xs(t,{x:e,y:n,...r}={}){return[e,n]=$t(e,n),new Gs(t,{...r,x:e,y:n})}function Hs(t,{x:e=H,y:n=X,...r}={}){return new Gs(t,Tl({...r,x:e,y:n}))}function Us(t,{x:e=X,y:n=H,...r}={}){return new Gs(t,Cl({...r,x:e,y:n}))}const Vs={ariaLabel:"rect"};class Zs extends Io{constructor(t,e={}){const{x1:n,y1:r,x2:o,y2:i,inset:a=0,insetTop:l=a,insetRight:s=a,insetBottom:c=a,insetLeft:u=a,rx:f,ry:h}=e;super(t,{x1:{value:n,scale:"x",type:null!=n&&null==o?"band":void 0,optional:!0},y1:{value:r,scale:"y",type:null!=r&&null==i?"band":void 0,optional:!0},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},e,Vs),this.insetTop=Q(l),this.insetRight=Q(s),this.insetBottom=Q(c),this.insetLeft=Q(u),this.rx=mo(f,"auto"),this.ry=mo(h,"auto")}render(t,e,n,r,o){const{x:i,y:a}=e,{x1:l,y1:s,x2:c,y2:u}=n,{marginTop:f,marginRight:h,marginBottom:d,marginLeft:p,width:m,height:y}=r,{projection:g}=o,{insetTop:v,insetRight:x,insetBottom:w,insetLeft:b,rx:k,ry:$}=this,M=(i?.bandwidth?i.bandwidth():0)-b-x,L=(a?.bandwidth?a.bandwidth():0)-v-w;return kn("svg:g",o).call(co,this,r,o).call(po,this,{},0,0).call((e=>e.selectAll().data(t).enter().append("rect").call(uo,this).attr("x",!l||!g&&Yr(i)?p+b:c?t=>Math.min(l[t],c[t])+b:t=>l[t]+b).attr("y",!s||!g&&Yr(a)?f+v:u?t=>Math.min(s[t],u[t])+v:t=>s[t]+v).attr("width",!l||!g&&Yr(i)?m-h-p-x-b:c?t=>Math.max(0,Math.abs(c[t]-l[t])+M):M).attr("height",!s||!g&&Yr(a)?y-f-d-v-w:u?t=>Math.max(0,Math.abs(s[t]-u[t])+L):L).call(ho,"rx",k).call(ho,"ry",$).call(io,this,n))).node()}}function Qs(t,e){return new Zs(t,di(pi(e)))}function Js(t,e={}){return gt(e)||(e={...e,y:X,x2:H,interval:1}),new Zs(t,os(pi(ts(e))))}function Ks(t,e={}){return gt(e)||(e={...e,x:X,y2:H,interval:1}),new Zs(t,is(di(es(e))))}function tc(t,e){e=function({x:t,y:e,color:n,size:r,fx:o,fy:i,mark:a}={}){wt(t)||(t=rc(t));wt(e)||(e=rc(e));wt(n)||(n=Zt(n)?{color:n}:rc(n));wt(r)||(r=rc(r));wt(o)&&({value:o}=rc(o));wt(i)&&({value:i}=rc(i));null!=a&&(a=`${a}`.toLowerCase());return{x:t,y:e,color:n,size:r,fx:o,fy:i,mark:a}}(e);const{x:n,y:r,color:o,size:i}=e,a=nc(t,n),l=nc(t,r),s=nc(t,o),c=nc(t,i);let u,f,h,{fx:d,fy:p,x:{value:m,reduce:y,zero:g,...v},y:{value:x,reduce:w,zero:b,...k},color:{value:$,color:M,reduce:L},size:{value:A,reduce:S},mark:z}=e;if(void 0===y&&(y=null==w&&null==m&&null==A&&null!=x?"count":null),void 0===w&&(w=null==y&&null==x&&null==A&&null!=m?"count":null),void 0!==S||null!=A||null!=L||null!=y||null!=w||null!=m&&!Yt(a)||null!=x&&!Yt(l)||(S="count"),void 0===g&&(g=!!oc(y)||void 0),void 0===b&&(b=!!oc(w)||void 0),null==m&&null==x)throw new Error("must specify x or y");if(null!=y&&null==x)throw new Error("reducing x requires y");if(null!=w&&null==m)throw new Error("reducing y requires x");switch(void 0===z&&(z=null!=A||null!=S?"dot":oc(y)||oc(w)||null!=L?"bar":null!=m&&null!=x?Yt(a)||Yt(l)||null==y&&null==w&&!ec(a)&&!ec(l)?"dot":"line":null!=m||null!=x?"rule":null),z){case"dot":h=Ys,f="stroke";break;case"line":h=a&&l||null!=y||null!=w?b||null!=w||a&&ec(a)?Us:g||null!=y||l&&ec(l)?Hs:Xs:a?Hs:Us,f="stroke",ac(s)&&(u=null);break;case"area":h=!b&&null==w&&(g||null!=y||l&&ec(l))?ks:$s,f="fill",ac(s)&&(u=null);break;case"rule":h=a?ki:$i,f="stroke";break;case"bar":h=null!=y?Yt(l)?ic(y)&&a&&Yt(a)?js:Ns:Js:null!=w?Yt(a)?ic(w)&&l&&Yt(l)?js:Is:Ks:null!=L||null!=S?a&&Yt(a)&&l&&Yt(l)?js:a&&Yt(a)?Is:l&&Yt(l)?Ns:Qs:!a||!Ht(a)||l&&Ht(l)?!l||!Ht(l)||a&&Ht(a)?js:Is:Ns,f="fill";break;default:throw new Error(`invalid mark: ${z}`)}let O,E={fx:d,fy:p,x:a??void 0,y:l??void 0,[f]:s??M,z:u,r:c??void 0,tip:!0},R={[f]:L??void 0,r:S??void 0};if(null!=y&&null!=w)throw new Error("cannot reduce both x and y");return null!=w?(R.y=w,O=Yt(a)?Re:zl):null!=y?(R.x=y,O=Yt(l)?Ce:Ol):null==L&&null==S||(a&&l?O=Yt(a)&&Yt(l)?Te:Yt(a)?Ol:Yt(l)?zl:El:a?O=Yt(a)?Re:zl:l&&(O=Yt(l)?Ce:Ol)),O!==El&&O!==zl||(E.x={value:a,...v}),O!==El&&O!==Ol||(E.y={value:l,...k}),void 0===g&&(g=a&&!(O===El||O===zl)&&(h===Ns||h===ks||h===Js||h===$i)),void 0===b&&(b=l&&!(O===El||O===Ol)&&(h===Is||h===$s||h===Ks||h===ki)),{fx:d??null,fy:p??null,x:{value:m??null,reduce:y??null,zero:!!g,...v},y:{value:x??null,reduce:w??null,zero:!!b,...k},color:{value:$??null,reduce:L??null,...void 0!==M&&{color:M}},size:{value:A??null,reduce:S??null},mark:z,markImpl:sc[h],markOptions:E,transformImpl:sc[O],transformOptions:R,colorMode:f}}function ec(t){let n,r;for(const o of t){if(null==o)continue;if(void 0===n){n=o;continue}const t=Math.sign(e.ascending(n,o));if(t){if(void 0!==r&&t!==r)return!1;n=o,r=t}}return!0}function nc(t,e){const n=F(t,e.value);return n&&(n.label=Tt(e.value)),n}function rc(t){return function(t){if(null==t)return!1;if("function"==typeof t.reduceIndex)return!0;if("function"==typeof t.reduce&&vt(t))return!0;if(/^p\d{2}$/i.test(t))return!0;switch(`${t}`.toLowerCase()){case"first":case"last":case"count":case"distinct":case"sum":case"proportion":case"proportion-facet":case"deviation":case"min":case"min-index":case"max":case"max-index":case"mean":case"median":case"variance":case"mode":return!0}return!1}(t)?{reduce:t}:{value:t}}function oc(t){return/^(?:distinct|count|sum|proportion)$/i.test(t)}function ic(t){return/^(?:first|last|mode)$/i.test(t)}function ac(t){return!!t&&new e.InternSet(t).size>t.length>>1}const lc={dot:Ys,line:Xs,lineX:Hs,lineY:Us,areaX:ks,areaY:$s,ruleX:ki,ruleY:$i,barX:Ns,barY:Is,rect:Qs,rectX:Js,rectY:Ks,cell:js,bin:El,binX:zl,binY:Ol,group:Te,groupX:Re,groupY:Ce},sc=Object.fromEntries(Object.entries(lc).map((([t,e])=>[e,t])));function cc(t,e={}){let{x:n,x1:r,x2:o}=e;void 0===n&&void 0===r&&void 0===o&&(e={...e,x:n=H});const i={};return null!=n&&(i.x=t),null!=r&&(i.x1=t),null!=o&&(i.x2=t),fc(i,e)}function uc(t,e={}){let{y:n,y1:r,y2:o}=e;void 0===n&&void 0===r&&void 0===o&&(e={...e,y:n=H});const i={};return null!=n&&(i.y=t),null!=r&&(i.y1=t),null!=o&&(i.y2=t),fc(i,e)}function fc(t={},n={}){const r=Mt(n),o=Object.entries(t).map((([t,e])=>{const r=Et(t,n);if(null==r)throw new Error(`missing channel: ${t}`);const[o,i]=Rt(r);return{key:t,input:r,output:o,setOutput:i,map:hc(e)}}));return{...xe(n,((t,n)=>{const i=F(t,r),a=o.map((({input:e})=>F(t,e))),l=o.map((({setOutput:e})=>e(new Array(t.length))));for(const t of n)for(const n of i?e.group(t,(t=>i[t])).values():[t])o.forEach((({map:t},e)=>t.mapIndex(n,a[e],l[e])));return{data:t,facets:n}})),...Object.fromEntries(o.map((({key:t,output:e})=>[t,e])))}}function hc(t){if(null==t)throw new Error("missing map");if("function"==typeof t.mapIndex)return t;if("function"==typeof t.map&&vt(t))return function(t){return console.warn("deprecated map interface; implement mapIndex instead."),{mapIndex:t.map.bind(t)}}(t);if("function"==typeof t)return dc(St(t));switch(`${t}`.toLowerCase()){case"cumsum":return pc;case"rank":return dc(((t,n)=>e.rank(t,(t=>n[t]))));case"quantile":return dc(((t,n)=>function(t,n){const r=e.count(t,n)-1;return e.rank(t,n).map((t=>t/r))}(t,(t=>n[t]))))}throw new Error(`invalid map: ${t}`)}function dc(t){return{mapIndex(e,n,r){const o=t(e,n);if(o.length!==e.length)throw new Error("map function returned a mismatched length");for(let t=0,n=e.length;t<n;++t)r[e[t]]=o[t]}}}const pc={mapIndex(t,e,n){let r=0;for(const o of t)n[o]=r+=e[o]}};function mc(t={}){"number"==typeof t&&(t={k:t});let{k:n,reduce:r,shift:o,anchor:i,strict:a}=t;if(void 0===i&&void 0!==o&&(i=function(t){switch(`${t}`.toLowerCase()){case"centered":return"middle";case"leading":return"start";case"trailing":return"end"}throw new Error(`invalid shift: ${t}`)}(o),Ln(`Warning: the shift option is deprecated; please use anchor "${i}" instead.`)),!((n=Math.floor(n))>0))throw new Error(`invalid k: ${n}`);return function(t="mean"){if("string"==typeof t){if(/^p\d{2}$/i.test(t))return yc(nt(t));switch(t.toLowerCase()){case"deviation":return yc(e.deviation);case"max":return gc(((t,n)=>e.max(t,(t=>n[t]))));case"mean":return xc;case"median":return yc(e.median);case"min":return gc(((t,n)=>e.min(t,(t=>n[t]))));case"mode":return gc(((t,n)=>e.mode(t,(t=>n[t]))));case"sum":return vc;case"variance":return yc(e.variance);case"difference":return Mc;case"ratio":return Lc;case"first":return Ac;case"last":return Sc}}if("function"!=typeof t)throw new Error(`invalid reduce: ${t}`);return gc(St(t))}(r)(n,function(t="middle",e){switch(`${t}`.toLowerCase()){case"middle":return e-1>>1;case"start":return 0;case"end":return e-1}throw new Error(`invalid anchor: ${t}`)}(i,n),a)}function yc(t){return(e,n,r)=>r?{mapIndex(r,o,i){const a=t=>null==o[t]?NaN:+o[t];let l=0;for(let t=0;t<e-1;++t)isNaN(a(t))&&++l;for(let o=0,s=r.length-e+1;o<s;++o)isNaN(a(o+e-1))&&++l,i[r[o+n]]=0===l?t(zt(r,o,o+e),a):NaN,isNaN(a(o))&&--l}}:{mapIndex(r,o,i){const a=t=>null==o[t]?NaN:+o[t];for(let o=-n;o<0;++o)i[r[o+n]]=t(zt(r,0,o+e),a);for(let o=0,l=r.length-n;o<l;++o)i[r[o+n]]=t(zt(r,o,o+e),a)}}}function gc(t){return(e,r,o)=>o?{mapIndex(o,i,a){let l=0;for(let t=0;t<e-1;++t)l+=n(i[o[t]]);for(let s=0,c=o.length-e+1;s<c;++s)l+=n(i[o[s+e-1]]),l===e&&(a[o[s+r]]=t(zt(o,s,s+e),i)),l-=n(i[o[s]])}}:{mapIndex(n,o,i){for(let a=-r;a<0;++a)i[n[a+r]]=t(zt(n,0,a+e),o);for(let a=0,l=n.length-r;a<l;++a)i[n[a+r]]=t(zt(n,a,a+e),o)}}}function vc(t,e,n){return n?{mapIndex(n,r,o){let i=0,a=0;for(let e=0;e<t-1;++e){const t=r[n[e]];null===t||isNaN(t)?++i:a+=+t}for(let l=0,s=n.length-t+1;l<s;++l){const s=r[n[l]],c=r[n[l+t-1]];null===c||isNaN(c)?++i:a+=+c,o[n[l+e]]=0===i?a:NaN,null===s||isNaN(s)?--i:a-=+s}}}:{mapIndex(n,r,o){let i=0;const a=n.length;for(let o=0,l=Math.min(a,t-e-1);o<l;++o)i+=+r[n[o]]||0;for(let l=-e,s=a-e;l<s;++l)i+=+r[n[l+t-1]]||0,o[n[l+e]]=i,i-=+r[n[l]]||0}}}function xc(t,e,n){if(n){const r=vc(t,e,n);return{mapIndex(n,o,i){r.mapIndex(n,o,i);for(let r=0,o=n.length-t+1;r<o;++r)i[n[r+e]]/=t}}}return{mapIndex(n,r,o){let i=0,a=0;const l=n.length;for(let o=0,s=Math.min(l,t-e-1);o<s;++o){let t=r[n[o]];null===t||isNaN(t=+t)||(i+=t,++a)}for(let s=-e,c=l-e;s<c;++s){let l=r[n[s+t-1]],c=r[n[s]];null===l||isNaN(l=+l)||(i+=l,++a),o[n[s+e]]=i/a,null===c||isNaN(c=+c)||(i-=c,--a)}}}}function wc(t,e,r,o){for(let i=r+o;r<i;++r){const o=t[e[r]];if(n(o))return o}}function bc(t,e,r,o){for(let i=r+o-1;i>=r;--i){const r=t[e[i]];if(n(r))return r}}function kc(t,e,n,r){for(let o=n+r;n<o;++n){let r=t[e[n]];if(null!==r&&!isNaN(r=+r))return r}}function $c(t,e,n,r){for(let o=n+r-1;o>=n;--o){let n=t[e[o]];if(null!==n&&!isNaN(n=+n))return n}}function Mc(t,e,n){return n?{mapIndex(n,r,o){for(let i=0,a=n.length-t;i<a;++i){const a=r[n[i]],l=r[n[i+t-1]];o[n[i+e]]=null===a||null===l?NaN:l-a}}}:{mapIndex(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=$c(r,n,i,t)-kc(r,n,i,t)}}}function Lc(t,e,n){return n?{mapIndex(n,r,o){for(let i=0,a=n.length-t;i<a;++i){const a=r[n[i]],l=r[n[i+t-1]];o[n[i+e]]=null===a||null===l?NaN:l/a}}}:{mapIndex(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=$c(r,n,i,t)/kc(r,n,i,t)}}}function Ac(t,e,n){return n?{mapIndex(n,r,o){for(let i=0,a=n.length-t;i<a;++i)o[n[i+e]]=r[n[i]]}}:{mapIndex(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=wc(r,n,i,t)}}}function Sc(t,e,n){return n?{mapIndex(n,r,o){for(let i=0,a=n.length-t;i<a;++i)o[n[i+e]]=r[n[i+t-1]]}}:{mapIndex(n,r,o){for(let i=-e,a=n.length-t+e+1;i<a;++i)o[n[i+e]]=bc(r,n,i,t)}}}const zc={n:20,k:2,color:"currentColor",opacity:.2,strict:!0,anchor:"end"};function Oc({n:t=zc.n,k:n=0,strict:r=zc.strict,anchor:o=zc.anchor}={}){return mc({k:t,reduce:t=>e.mean(t)+n*(e.deviation(t)||0),strict:r,anchor:o})}const Ec={ariaLabel:"tick",fill:null,stroke:"currentColor"};class Rc extends Io{constructor(t,e,n){super(t,e,n,Ec),Zo(this,n)}render(t,e,n,r,o){return kn("svg:g",o).call(co,this,r,o).call(this._transform,this,e).call((i=>i.selectAll().data(t).enter().append("line").call(uo,this).attr("x1",this._x1(e,n,r)).attr("x2",this._x2(e,n,r)).attr("y1",this._y1(e,n,r)).attr("y2",this._y2(e,n,r)).call(io,this,n).call(oi,this,n,o))).node()}}class Cc extends Rc{constructor(t,e={}){const{x:n,y:r,inset:o=0,insetTop:i=o,insetBottom:a=o}=e;super(t,{x:{value:n,scale:"x"},y:{value:r,scale:"y",type:"band",optional:!0}},e),this.insetTop=Q(i),this.insetBottom=Q(a)}_transform(t,e,{x:n}){t.call(po,e,{x:n},Kr,0)}_x1(t,{x:e}){return t=>e[t]}_x2(t,{x:e}){return t=>e[t]}_y1({y:t},{y:e},{marginTop:n}){const{insetTop:r}=this;return e&&t?t=>e[t]+r:n+r}_y2({y:t},{y:e},{height:n,marginBottom:r}){const{insetBottom:o}=this;return e&&t?n=>e[n]+t.bandwidth()-o:n-r-o}}class Tc extends Rc{constructor(t,e={}){const{x:n,y:r,inset:o=0,insetRight:i=o,insetLeft:a=o}=e;super(t,{y:{value:r,scale:"y"},x:{value:n,scale:"x",type:"band",optional:!0}},e),this.insetRight=Q(i),this.insetLeft=Q(a)}_transform(t,e,{y:n}){t.call(po,e,{y:n},0,Kr)}_x1({x:t},{x:e},{marginLeft:n}){const{insetLeft:r}=this;return e&&t?t=>e[t]+r:n+r}_x2({x:t},{x:e},{width:n,marginRight:r}){const{insetRight:o}=this;return e&&t?n=>e[n]+t.bandwidth()-o:n-r-o}_y1(t,{y:e}){return t=>e[t]}_y2(t,{y:e}){return t=>e[t]}}function Bc(t,{x:e=H,...n}={}){return new Cc(t,{...n,x:e})}function Nc(t,{y:e=H,...n}={}){return new Tc(t,{...n,y:e})}function Ic(t){const e=Pc(t),n=Wc(t);return t.map((t=>t<e||t>n?t:NaN))}function Pc(t){const n=2.5*jc(t)-1.5*qc(t);return e.min(t,(t=>t>=n?t:NaN))}function Wc(t){const n=2.5*qc(t)-1.5*jc(t);return e.max(t,(t=>t<=n?t:NaN))}function jc(t){return e.quantile(t,.25)}function qc(t){return e.quantile(t,.75)}const Fc={ariaLabel:"raster",stroke:null,pixelSize:1};function Dc(t,e){const n=+t;if(isNaN(n))throw new Error(`invalid ${e}: ${t}`);return n}function Yc(t,e){const n=Math.floor(t);if(isNaN(n))throw new Error(`invalid ${e}: ${t}`);return n}class _c extends Io{constructor(t,e,n={},r){let{width:o,height:i,x:a,y:l,x1:s=(null==a?0:void 0),y1:c=(null==l?0:void 0),x2:u=(null==a?o:void 0),y2:f=(null==l?i:void 0),pixelSize:h=r.pixelSize,blur:d=0,interpolate:p}=n;if(null!=o&&(o=Yc(o,"width")),null!=i&&(i=Yc(i,"height")),null!=s&&(s=Dc(s,"x1")),null!=c&&(c=Dc(c,"y1")),null!=u&&(u=Dc(u,"x2")),null!=f&&(f=Dc(f,"y2")),null==a&&(null==s||null==u))throw new Error("missing x");if(null==l&&(null==c||null==f))throw new Error("missing y");null!=t&&null!=o&&null!=i&&(void 0===a&&null!=s&&null!=u&&(a=function(t,e,n){return{transform(r){const o=r.length,i=new Float64Array(o),a=(e-t)/n,l=t+a/2;for(let t=0;t<o;++t)i[t]=t%n*a+l;return i}}}(s,u,o)),void 0===l&&null!=c&&null!=f&&(l=function(t,e,n,r){return{transform(o){const i=o.length,a=new Float64Array(i),l=(e-t)/r,s=t+l/2;for(let t=0;t<i;++t)a[t]=Math.floor(t/n)%r*l+s;return a}}}(c,f,o,i))),super(t,{x:{value:a,scale:"x",optional:!0},y:{value:l,scale:"y",optional:!0},x1:{value:null==s?null:[s],scale:"x",optional:!0,filter:null},y1:{value:null==c?null:[c],scale:"y",optional:!0,filter:null},x2:{value:null==u?null:[u],scale:"x",optional:!0,filter:null},y2:{value:null==f?null:[f],scale:"y",optional:!0,filter:null},...e},n,r),this.width=o,this.height=i,this.pixelSize=Dc(h,"pixelSize"),this.blur=Dc(d,"blur"),this.interpolate=null==a||null==l?null:function(t){if("function"==typeof t)return t;if(null==t)return Zc;switch(`${t}`.toLowerCase()){case"none":return Zc;case"nearest":return tu;case"barycentric":return Qc();case"random-walk":return eu()}throw new Error(`invalid interpolate: ${t}`)}(p)}}class Gc extends _c{constructor(t,e={}){const{imageRendering:n}=e;if(null==t){const{fill:t,fillOpacity:n}=e;void 0!==ct(n)[0]&&(e=Vc("fillOpacity",e)),void 0!==st(t)[0]&&(e=Vc("fill",e))}super(t,void 0,e,Fc),this.imageRendering=mo(n,"auto")}scale(t,{color:e,...n},r){return super.scale(t,n,r)}render(t,n,r,o,i){const a=n[r.channels.fill?.scale]??(t=>t),{x:l,y:s}=r,{document:c}=i,[u,f,h,d]=Hc(r,o,i),p=h-u,m=d-f,{pixelSize:y,width:g=Math.round(Math.abs(p)/y),height:v=Math.round(Math.abs(m)/y)}=this,x=g*v;let{fill:w,fillOpacity:b}=r,k=0;if(this.interpolate){const e=g/p,n=v/m,r=dt(l,(t=>(t-u)*e),Float64Array),o=dt(s,(t=>(t-f)*n),Float64Array);w&&(w=this.interpolate(t,g,v,r,o,w)),b&&(b=this.interpolate(t,g,v,r,o,b))}else null==this.data&&t&&(k=t.fi*x);const $=c.createElement("canvas");$.width=g,$.height=v;const M=$.getContext("2d"),L=M.createImageData(g,v),A=L.data;let{r:S,g:z,b:O}=e.rgb(this.fill)??{r:0,g:0,b:0},E=255*(this.fillOpacity??1);for(let t=0;t<x;++t){const n=t<<2;if(w){const r=a(w[t+k]);if(null==r){A[n+3]=0;continue}({r:S,g:z,b:O}=e.rgb(r))}b&&(E=255*b[t+k]),A[n+0]=S,A[n+1]=z,A[n+2]=O,A[n+3]=E}return this.blur>0&&e.blurImage(L,this.blur),M.putImageData(L,0,0),kn("svg:g",i).call(co,this,o,i).call(po,this,n).call((t=>t.append("image").attr("transform",`translate(${u},${f}) scale(${Math.sign(h-u)},${Math.sign(d-f)})`).attr("width",Math.abs(p)).attr("height",Math.abs(m)).attr("preserveAspectRatio","none").call(ho,"image-rendering",this.imageRendering).call(uo,this).attr("xlink:href",$.toDataURL()))).node()}}function Xc(t,e,n){arguments.length<3&&(n=e,e=null);let{x:r,y:o,[t]:i,...a}=n;return void 0===r&&void 0===o&&function(t){if(!Ft(t))return!1;for(const e of t)if(null!=e)return"object"==typeof e&&"0"in e&&"1"in e}(e)&&(r=J,o=K,void 0===i&&(i=tt)),[e,{...a,x:r,y:o,[t]:i}]}function Hc({x1:t,y1:e,x2:n,y2:r},o,{projection:i}){const{width:a,height:l,marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}=o;return[t&&null==i?t[0]:f,e&&null==i?e[0]:s,n&&null==i?n[0]:a-c,r&&null==i?r[0]:l-u]}function Uc({x1:t,y1:e,x2:n,y2:r},o,i,a){const l={};return t&&(l.x1=t),e&&(l.y1=e),n&&(l.x2=n),r&&(l.y2=r),Hc(fn(l,o),i,a)}function Vc(t,e={}){const{[t]:n}=e;if("function"!=typeof n)throw new Error(`invalid ${t}: not a function`);return we({...e,[t]:void 0},(function(r,o,i,a,l,s){const{x:c,y:u}=a;if(!c)throw new Error("missing scale: x");if(!u)throw new Error("missing scale: y");const[f,h,d,p]=Uc(i,a,l,s),m=d-f,y=p-h,{pixelSize:g}=this,{width:v=Math.round(Math.abs(m)/g),height:x=Math.round(Math.abs(y)/g)}=e,w=new Array(v*x*(o?o.length:1)),b=m/v,k=y/x;let $=0;for(const t of o??[void 0])for(let e=.5;e<x;++e)for(let r=.5;r<v;++r,++$)w[$]=n(c.invert(f+r*b),u.invert(h+e*k),t);return{data:w,facets:o,channels:{[t]:{value:w,scale:"auto"}}}}))}function Zc(t,e,n,r,o,i){const a=new Array(e*n);for(const l of t)r[l]<0||r[l]>=e||o[l]<0||o[l]>=n||(a[Math.floor(o[l])*e+Math.floor(r[l])]=i[l]);return a}function Qc({random:t=e.randomLcg(42)}={}){return(n,r,o,i,a,l)=>{const{points:s,triangles:c,hull:u}=e.Delaunay.from(n,(t=>i[t]),(t=>a[t])),f=new l.constructor(r*o).fill(NaN),h=new Uint8Array(r*o),d=function(t,e){return Ht(t)||_t(t)?nu:function(t){return(e,n,r,o,i,a,l,s)=>{const c=t(l,s);return c<n?e:c<n+o?r:i}}(e)}(l,t);for(let t=0;t<c.length;t+=3){const e=c[t],i=c[t+1],a=c[t+2],u=s[2*e],p=s[2*i],m=s[2*a],y=s[2*e+1],g=s[2*i+1],v=s[2*a+1],x=Math.min(u,p,m),w=Math.max(u,p,m),b=Math.min(y,g,v),k=Math.max(y,g,v),$=(g-v)*(u-m)+(y-v)*(m-p);if(!$)continue;const M=l[n[e]],L=l[n[i]],A=l[n[a]];for(let t=Math.floor(x);t<w;++t)for(let e=Math.floor(b);e<k;++e){if(t<0||t>=r||e<0||e>=o)continue;const n=t+.5,i=e+.5,a=((g-v)*(n-m)+(i-v)*(m-p))/$;if(a<0)continue;const l=((v-y)*(n-m)+(i-v)*(u-m))/$;if(l<0)continue;const s=1-a-l;if(s<0)continue;const c=t+r*e;f[c]=d(M,a,L,l,A,s,t,e),h[c]=1}}return function(t,e,n,r,o,i,a,l,s,c){n=Float64Array.from(l,(t=>n[s[t]])),r=Float64Array.from(l,(t=>r[s[t]])),o=Array.from(l,(t=>o[s[t]]));const u=n.length,f=Array.from({length:u},((t,e)=>function(t,e,n){const r=e.length,o=e.at(t-2),i=n.at(t-2),a=e.at(t-1),l=n.at(t-1),s=e[t],c=n[t],u=e.at(t+1-r),f=n.at(t+1-r),h=a-s,d=l-c,p=o-a,m=i-l,y=s-u,g=c-f,v=Math.hypot(h,d),x=Math.hypot(p,m),w=Math.hypot(y,g);return(t,e)=>{const n=t-a,r=e-l,o=t-s,i=e-c;return Kc(n,r,o,i)>-1e-6&&Kc(n,r,h,d)*x-Kc(n,r,p,m)*v>-1e-6&&Kc(o,i,y,g)*v-Kc(o,i,h,d)*w<=0}}(e,n,r)));let h=0;for(let l=0;l<a;++l){const a=l+.5;for(let s=0;s<i;++s){const d=s+i*l;if(!e[d]){const e=s+.5;for(let i=0;i<u;++i){const p=(u+h+(i%2?(i+1)/2:-i/2))%u;if(f[p](e,a)){const i=Jc(n.at(p-1),r.at(p-1),n[p],r[p],e,a);t[d]=c(o.at(p-1),i,o[p],1-i,o[p],0,s,l),h=p;break}}}}}}(f,h,i,a,l,r,o,u,n,d),f}}function Jc(t,e,n,r,o,i){const a=n-t,l=r-e,s=a*(n-o)+l*(r-i),c=a*(o-t)+l*(i-e);return s>0&&c>0?s/(s+c):+(s>c)}function Kc(t,e,n,r){return t*r-n*e}function tu(t,n,r,o,i,a){const l=new a.constructor(n*r),s=e.Delaunay.from(t,(t=>o[t]),(t=>i[t]));let c,u;for(let e=.5,o=0;e<r;++e){u=c;for(let r=.5;r<n;++r,++o)u=s.find(r,e,u),.5===r&&(c=u),l[o]=a[t[u]]}return l}function eu({random:t=e.randomLcg(42),minDistance:n=.5,maxSteps:r=2}={}){return(o,i,a,l,s,c)=>{const u=new c.constructor(i*a),f=e.Delaunay.from(o,(t=>l[t]),(t=>s[t]));let h,d,p;for(let e=.5,m=0;e<a;++e){d=h;for(let a=.5;a<i;++a,++m){let i,y=a,g=e;p=d=f.find(y,g,d),.5===a&&(h=d);let v=0;for(;(i=Math.hypot(l[o[p]]-y,s[o[p]]-g))>n&&v<r;){const n=2*t(a,e,v)*Math.PI;y+=Math.cos(n)*i,g+=Math.sin(n)*i,p=f.find(y,g,p),++v}u[m]=c[o[p]]}}return u}}function nu(t,e,n,r,o,i){return e*t+r*n+i*o}const ru={ariaLabel:"contour",fill:"none",stroke:"currentColor",strokeMiterlimit:1,pixelSize:2};class ou extends _c{constructor(t,{smooth:n=!0,value:r,...o}={}){const i=no({},o,ru);if(void 0===r)for(const t in i)if(null!=i[t].value){if(void 0!==r)throw new Error("ambiguous contour value");r=o[t],o[t]="value"}if(null!=r){const t={transform:t=>t.map((t=>t.value)),label:Tt(r)};for(const e in i)"value"===o[e]&&(o[e]=t)}if(null==t){if(null==r)throw new Error("missing contour value");o=Vc("value",{value:r,...o}),r=null}else{let{interpolate:t}=o;void 0===r&&(r=H),void 0===t&&(o.interpolate="nearest")}super(t,{value:{value:r,optional:!0}},function({thresholds:t,interval:n,...r}){return t=Wl(t,n,e.thresholdSturges),we(r,(function(n,r,o,i,a,l){const[s,c,u,f]=Uc(o,i,a,l),h=u-s,d=f-c,{pixelSize:p,width:m=Math.round(Math.abs(h)/p),height:y=Math.round(Math.abs(d)/p)}=this,g=m/h,v=y/d,x=o.value.value,w=[];if(this.interpolate){const{x:t,y:e}=Pn(o,i,l),n=dt(t,(t=>(t-s)*g),Float64Array),a=dt(e,(t=>(t-c)*v),Float64Array),u=[o.x,o.y,o.value],f=[n,a,x];for(const t of r){const e=this.filter(t,u,f);w.push(this.interpolate(e,m,y,n,a,x))}}else if(r){const t=m*y,e=r.length;for(let n=0;n<e;++n)w.push(x.slice(n*t,n*t+t))}else w.push(x);if(this.blur>0)for(const t of w)e.blur2({data:t,width:m,height:y},this.blur);const b=function(t,n,r,o){if("function"==typeof t?.range)return t.range(t.floor(r),o);"function"==typeof t&&(t=t(n,r,o));if("number"!=typeof t)return ht(t);const i=e.ticks(...e.nice(r,o,t),t);for(;i[i.length-1]>=o;)i.pop();for(;i[1]<r;)i.shift();return i}(t,x,...function(t){return[e.min(t,(t=>e.min(t,iu))),e.max(t,(t=>e.max(t,iu)))]}(w));if(null===b)throw new Error(`unsupported thresholds: ${t}`);const{contour:k}=e.contours().size([m,y]).smooth(this.smooth),$=[],M=[];for(const t of w)M.push(e.range($.length,$.push(...dt(b,(e=>k(t,e))))));for(const{coordinates:t}of $)for(const e of t)for(const t of e)for(const e of t)e[0]=e[0]/g+s,e[1]=e[1]/v+c;return{data:$,facets:M,channels:un(this.contourChannels,$)}}))}(o),ru);const a={geometry:{value:H}};for(const t in this.channels){const e=this.channels[t],{scale:n}=e;"x"!==n&&"y"!==n&&"value"!==t&&(a[t]=e,delete this.channels[t])}this.contourChannels=a,this.smooth=!!n}filter(t,{x:e,y:n,value:r,...o},i){return super.filter(t,o,i)}render(t,n,r,o,i){const{geometry:a}=r,l=e.geoPath();return kn("svg:g",i).call(co,this,o,i).call(po,this,n).call((e=>{e.selectAll().data(t).enter().append("path").call(uo,this).attr("d",(t=>l(a[t]))).call(io,this,r)})).node()}}function iu(t){return isFinite(t)?t:NaN}function au(t,e,n={}){const{x:r,y:o,maxRadius:i}=n,a=t({px:r,py:o,maxRadius:i}),l=[];null!=r&&l.push(ki(e,cu("x",{...a,inset:-6},n))),null!=o&&l.push($i(e,cu("y",{...a,inset:-6},n))),null!=r&&l.push(Ri(e,uu("x",{...a,dy:9,frameAnchor:"bottom",lineAnchor:"top"},n))),null!=o&&l.push(Ri(e,uu("y",{...a,dx:-9,frameAnchor:"left",textAnchor:"end"},n)));for(const t of l)t.ariaLabel=`crosshair ${t.ariaLabel}`;return Po(...l)}function lu(t,{channels:e,...n},{facet:r,facetAnchor:o,fx:i,fy:a,[t]:l,channels:s,transform:c,initializer:u}){return{...n,facet:r,facetAnchor:o,fx:i,fy:a,[t]:l,channels:{...e,...s},transform:c,initializer:su(t,u)}}function su(t,e){return null==e?e:function(n,r,{x:o,y:i,px:a,py:l,...s},...c){const{channels:{x:u,y:f,...h}={},...d}=e.call(this,n,r,{...s,x:a,y:l},...c);return{channels:{...h,...u&&{px:u,..."x"===t&&{x:u}},...f&&{py:f,..."y"===t&&{y:f}}},...d}}}function cu(t,e,n){const{color:r="currentColor",opacity:o=.2,ruleStroke:i=r,ruleStrokeOpacity:a=o,ruleStrokeWidth:l}=n;return{...lu(t,e,n),stroke:i,strokeOpacity:a,strokeWidth:l}}function uu(t,e,n){const{color:r="currentColor",textFill:o=r,textFillOpacity:i,textStroke:a="var(--plot-background)",textStrokeOpacity:l,textStrokeWidth:s=5}=n;return{...lu(t,e,fu(t,n)),fill:o,fillOpacity:i,stroke:a,strokeOpacity:l,strokeWidth:s}}function fu(t,e){return we(e,((e,n,r)=>({channels:{text:{value:wn(r,t)?.value}}})))}const hu={ariaLabel:"delaunay link",fill:"none",stroke:"currentColor",strokeMiterlimit:1},du={ariaLabel:"delaunay mesh",fill:null,stroke:"currentColor",strokeOpacity:.2},pu={ariaLabel:"hull",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeMiterlimit:1},mu={ariaLabel:"voronoi",fill:"none",stroke:"currentColor",strokeMiterlimit:1},yu={ariaLabel:"voronoi mesh",fill:null,stroke:"currentColor",strokeOpacity:.2};class gu extends Io{constructor(t,e={}){const{x:n,y:r,z:o,curve:i,tension:a}=e;super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:o,optional:!0}},e,hu),this.curve=Ll(i,a),Zo(this,e)}render(t,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,z:u}=r,{curve:f}=this,[h,d]=wo(this,o),p=s?t=>s[t]:et(h),m=c?t=>c[t]:et(d),y=this;function g(t){let n=-1;const o=[],a={};for(const t in r)a[t]=[];const l=[],s=[],c=[],u=[];function h(e,i){e=t[e],i=t[i],o.push(++n),l[n]=p(e),c[n]=m(e),s[n]=p(i),u[n]=m(i);for(const t in r)a[t].push(r[t][i])}const{halfedges:d,hull:g,triangles:v}=e.Delaunay.from(t,p,m);for(let t=0;t<d.length;++t){const e=d[t];e>t&&h(v[t],v[e])}for(let t=0;t<g.length;++t)h(g[t],g[(t+1)%g.length]);e.select(this).selectAll().data(o).enter().append("path").call(uo,y).attr("d",(t=>{const n=e.pathRound(),r=f(n);return r.lineStart(),r.point(l[t],c[t]),r.point(s[t],u[t]),r.lineEnd(),n})).call(io,y,a).call(oi,y,a,i)}return kn("svg:g",i).call(co,this,o,i).call(po,this,{x:s&&a,y:c&&l}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(g):e=>e.datum(t).each(g)).node()}}class vu extends Io{constructor(t,e={},n,r=(({z:t})=>t)){const{x:o,y:i}=e;super(t,{x:{value:o,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},z:{value:r(e),optional:!0}},e,n)}render(t,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,z:u}=r,[f,h]=wo(this,o),d=s?t=>s[t]:et(f),p=c?t=>c[t]:et(h),m=this;function y(t){const n=e.Delaunay.from(t,d,p);e.select(this).append("path").datum(t[0]).call(uo,m).attr("d",m._render(n,o)).call(io,m,r)}return kn("svg:g",i).call(co,this,o,i).call(po,this,{x:s&&a,y:c&&l}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(y):e=>e.datum(t).each(y)).node()}}class xu extends vu{constructor(t,e={}){super(t,e,du),this.fill="none"}_render(t){return t.render()}}class wu extends vu{constructor(t,e={}){super(t,e,pu,Mt)}_render(t){return t.renderHull()}}class bu extends Io{constructor(t,e={}){const{x:n,y:r,z:o}=e;super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:o,optional:!0}},e,mu)}render(t,n,r,o,i){const{x:a,y:l}=n,{x:s,y:c,z:u}=r,[f,h]=wo(this,o),d=s?t=>s[t]:et(f),p=c?t=>c[t]:et(h),m=this;function y(t){const n=$u(e.Delaunay.from(t,d,p),o);e.select(this).selectAll().data(t).enter().append("path").call(uo,m).attr("d",((t,e)=>n.renderCell(e))).call(io,m,r)}return kn("svg:g",i).call(co,this,o,i).call(po,this,{x:s&&a,y:c&&l}).call(u?n=>n.selectAll().data(e.group(t,(t=>u[t])).values()).enter().append("g").each(y):e=>e.datum(t).each(y)).node()}}class ku extends vu{constructor(t,e){super(t,e,yu),this.fill="none"}_render(t,e){return $u(t,e).render()}}function $u(t,e){const{width:n,height:r,marginTop:o,marginRight:i,marginBottom:a,marginLeft:l}=e;return t.voronoi([l,o,n-i,r-a])}function Mu(t,e,{x:n,y:r,...o}={}){return[n,r]=$t(n,r),new t(e,{...o,x:n,y:r})}const Lu={ariaLabel:"density",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class Au extends Io{constructor(t,{x:n,y:r,z:o,weight:i,fill:a,stroke:l,...s}={}){const c=zu(a)&&(a="currentColor",!0),u=zu(l)&&(l="currentColor",!0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:Mt({z:o,fill:a,stroke:l}),optional:!0},weight:{value:i,optional:!0}},function(t,n,r){const o=100;let{bandwidth:i,thresholds:a}=t;return i=void 0===i?20:+i,a=void 0===a?20:"function"==typeof a?.[Symbol.iterator]?rt(a):+a,we(t,(function(t,l,s,c,u,f){const h=s.weight?rt(s.weight.value):null,d=s.z?.value,{z:p}=this,[m,y]=wo(this,u),{width:g,height:v}=u,{x:x,y:w}=Pn(s,c,f),b=Object.fromEntries(Object.entries(s).filter((([t])=>!Su.has(t))).map((([t,e])=>[t,{...e,value:[]}]))),k=n&&[],$=r&&[],M=e.contourDensity().x(x?t=>x[t]:m).y(w?t=>w[t]:y).weight(h?t=>h[t]:1).size([g,v]).bandwidth(i),L=[];for(const t of l){const e=[];L.push(e);for(const n of d?lo(t,d,p):[t]){const t=M.contours(n);e.push([n,t])}}let A=a;if(!(A instanceof W)){let t=0;for(const e of L)for(const[,n]of e){const e=n.max;e>t&&(t=e)}A=Float64Array.from({length:a-1},((e,n)=>t*o*(n+1)/a))}const S=[],z=[];for(const t of L){const e=[];S.push(e);for(const[n,r]of t)for(const t of A){e.push(z.length),z.push(r(t/o)),k&&k.push(t),$&&$.push(t);for(const t in b)b[t].value.push(s[t].value[n[0]])}}return k&&k.push(0),$&&$.push(0),{data:t,facets:S,channels:{...b,...k&&{fill:{value:k,scale:"color"}},...$&&{stroke:{value:$,scale:"color"}},contours:{value:z}}}}))}({...s,fill:a,stroke:l},c,u),Lu),c&&(this.fill=void 0),u&&(this.stroke=void 0),this.z=o}filter(t){return t}render(t,n,r,o,i){const{contours:a}=r,l=e.geoPath();return kn("svg:g",i).call(co,this,o,i).call(po,this,{}).call((e=>e.selectAll().data(t).enter().append("path").call(uo,this).call(io,this,r).attr("d",(t=>l(a[t]))))).node()}}const Su=new Set(["x","y","z","weight"]);function zu(t){return/^density$/i.test(t)}function Ou(t,e,n){return void 0===e&&void 0===n?e=n=Eu(t):void 0===e?(n=Eu(n),e=void 0===t?n:Eu(t)):void 0===n?(e=Eu(e),n=void 0===t?e:Eu(t)):(e=Eu(e),n=Eu(n)),[e,n]}function Eu(t){let e;const{value:n,label:r=Tt(n)}=qt(t);return{transform:t=>e||(e=F(t,n)),label:r}}function Ru(t){return(e,n,r,o,i,a)=>{const{x1:l,x2:s}=r,{height:c}=o,u=new Float32Array(l.length),f=new Float32Array(s.length);(t===zr(n.y)<0?u:f).fill(c);const h=a(e,n,{...r,x2:l,y2:f},o,i),d=a(e,n,{...r,x1:s,y1:u},o,i),p=h.querySelector("g")??h,m=d.querySelector("g")??d;for(let t=0;p.firstChild;t+=2){const e=eo(),n=kn("svg:clipPath",i).attr("id",e).node();n.appendChild(p.firstChild),m.childNodes[t].setAttribute("clip-path",`url(#${e})`),m.insertBefore(n,m.childNodes[t])}return d}}const Cu={ariaLabel:"geo",fill:"none",stroke:"currentColor",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Tu extends Io{constructor(t,e={}){const[n,r]=ct(e.r,3);super(t,{geometry:{value:e.geometry,scale:"projection"},r:{value:n,scale:"r",filter:l,optional:!0}},Fs(e),Cu),this.r=r}render(t,n,r,o,i){const{geometry:a,r:l}=r,c=e.geoPath(i.projection??function({x:t,y:n}){if(t||n)return t??=t=>t,n??=t=>t,e.geoTransform({point(e,r){this.stream.point(t(e),n(r))}})}(n)),{r:u}=this;return s(u)?t=[]:void 0!==u&&c.pointRadius(u),kn("svg:g",i).call(co,this,o,i).call(po,this,n).call((e=>{e.selectAll().data(t).enter().append("path").call(uo,this).attr("d",l?t=>c.pointRadius(l[t])(a[t]):t=>c(a[t])).call(io,this,r)})).node()}}function Bu(t,{geometry:e=H,...n}={}){switch(t?.type){case"FeatureCollection":t=t.features;break;case"GeometryCollection":t=t.geometries;break;case"Feature":case"LineString":case"MultiLineString":case"MultiPoint":case"MultiPolygon":case"Point":case"Polygon":case"Sphere":t=[t]}return new Tu(t,{geometry:e,...n})}const Nu=.5,Iu=0;function Pu(t,e,n,r,o){const i=o*(1.5/he),a=new Map;for(const l of e){let e=n[l],s=r[l];if(isNaN(e)||isNaN(s))continue;let c=Math.round(s=(s-Iu)/i),u=Math.round(e=(e-Nu)/o-(1&c)/2),f=s-c;if(3*Math.abs(f)>1){let t=e-u,n=u+(e<u?-1:1)/2,r=c+(s<c?-1:1),o=e-n,i=s-r;t*t+f*f>o*o+i*i&&(u=n+(1&c?1:-1)/2,c=r)}const h=`${u},${c}`;let d=a.get(h);void 0===d&&(d={index:[],extent:{data:t,x:(u+(1&c)/2)*o+Nu,y:c*i+Iu}},a.set(h,d)),d.index.push(l)}return a.values()}const Wu={ariaLabel:"hexgrid",fill:"none",stroke:"currentColor",strokeOpacity:.1};class ju extends Io{constructor({binWidth:t=20,clip:e=!0,...n}={}){super(_,void 0,{clip:e,...n},Wu),this.binWidth=Q(t)}render(t,e,n,r,o){const{binWidth:i}=this,{marginTop:a,marginRight:l,marginBottom:s,marginLeft:c,width:u,height:f}=r,h=c-Nu,d=u-l-Nu,p=a-Iu,m=f-s-Iu,y=i/2,g=y*de,v=g/2,x=2*y,w=1.5*g,b=Math.floor(h/x),k=Math.ceil(d/x),$=Math.floor((p+v)/w),M=Math.ceil((m-v)/w)+1,L=`m0,${qu(-g)}l${qu(y)},${qu(v)}v${qu(g)}l${qu(-y)},${qu(v)}`;let A=L;for(let t=$;t<M;++t)for(let e=b;e<k;++e)A+=`M${qu(e*x+(1&t)*y)},${qu(t*w)}${L}`;return kn("svg:g",o).datum(0).call(co,this,r,o).call(po,this,{},Kr+Nu,Kr+Iu).call((t=>t.append("path").call(uo,this).call(io,this,n).attr("d",A))).node()}}function qu(t){return Math.round(1e3*t)/1e3}const Fu={ariaLabel:"image",fill:null,stroke:null};class Du extends Io{constructor(t,e={}){let{x:n,y:r,r:o,width:i,height:a,rotate:s,src:c,preserveAspectRatio:u,crossOrigin:f,frameAnchor:h,imageRendering:d}=e;null==o&&(o=void 0),void 0===o&&void 0===i&&void 0===a?i=a=16:void 0===i&&void 0!==a?i=a:void 0===a&&void 0!==i&&(a=i);const[p,m]="string"==typeof(y=c)&&(function(t){return/^\.*\//.test(t)}(y)||function(t){return/^(blob|data|file|http|https):/i.test(t)}(y))?[void 0,y]:[y,void 0];var y;const[g,v]=ct(o),[x,w]=ct(i,void 0!==v?2*v:void 0),[b,k]=ct(a,void 0!==v?2*v:void 0),[$,M]=ct(s,0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},r:{value:g,scale:"r",filter:l,optional:!0},width:{value:x,filter:l,optional:!0},height:{value:b,filter:l,optional:!0},rotate:{value:$,optional:!0},src:{value:p,optional:!0}},Fs(e),Fu),this.src=m,this.width=w,this.rotate=M,this.height=k,this.r=v,this.preserveAspectRatio=mo(u,"xMidYMid"),this.crossOrigin=Z(f),this.frameAnchor=ee(h),this.imageRendering=mo(d,"auto")}render(t,e,n,r,o){const{x:i,y:a}=e,{x:l,y:s,width:c,height:u,r:f,rotate:h,src:d}=n,{r:p,width:m,height:y,rotate:g}=this,[v,x]=wo(this,r);return kn("svg:g",o).call(co,this,r,o).call(po,this,{x:l&&i,y:s&&a}).call((e=>e.selectAll().data(t).enter().append("image").call(uo,this).attr("x",Yu(l,c,f,v,m,p)).attr("y",Yu(s,u,f,x,y,p)).attr("width",c?t=>c[t]:void 0!==m?m:f?t=>2*f[t]:2*p).attr("height",u?t=>u[t]:void 0!==y?y:f?t=>2*f[t]:2*p).attr("transform",h?t=>`rotate(${h[t]})`:g?`rotate(${g})`:null).attr("transform-origin",h||g?Li`${l?t=>l[t]:v}px ${s?t=>s[t]:x}px`:null).call(ho,"href",d?t=>d[t]:this.src).call(ho,"preserveAspectRatio",this.preserveAspectRatio).call(ho,"crossorigin",this.crossOrigin).call(ho,"image-rendering",this.imageRendering).call(ho,"clip-path",f?t=>`circle(${f[t]}px)`:void 0!==p?`circle(${p}px)`:null).call(io,this,n))).node()}}function Yu(t,e,n,r,o,i){return e&&t?n=>t[n]-e[n]/2:e?t=>r-e[t]/2:t&&void 0!==o?e=>t[e]-o/2:void 0!==o?r-o/2:n&&t?e=>t[e]-n[e]:n?t=>r-n[t]:t?e=>t[e]-i:r-i}function _u(t,e,n){var r=0===t||1===t?0:Math.exp(Xu(e+n)-Xu(e)-Xu(n)+e*Math.log(t)+n*Math.log(1-t));return!(t<0||t>1)&&(t<(e+1)/(e+n+2)?r*Gu(t,e,n)/e:1-r*Gu(1-t,n,e)/n)}function Gu(t,e,n){var r,o,i,a,l=1e-30,s=1,c=e+n,u=e+1,f=e-1,h=1,d=1-c*t/u;for(Math.abs(d)<l&&(d=l),a=d=1/d;s<=100&&(d=1+(o=s*(n-s)*t/((f+(r=2*s))*(e+r)))*d,Math.abs(d)<l&&(d=l),h=1+o/h,Math.abs(h)<l&&(h=l),a*=(d=1/d)*h,d=1+(o=-(e+s)*(c+s)*t/((e+r)*(u+r)))*d,Math.abs(d)<l&&(d=l),h=1+o/h,Math.abs(h)<l&&(h=l),a*=i=(d=1/d)*h,!(Math.abs(i-1)<3e-7));s++);return a}function Xu(t){var e,n,r,o=0,i=[76.18009172947146,-86.5053203294167,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(r=(n=e=t)+5.5,r-=(e+.5)*Math.log(r);o<6;o++)a+=i[o]/++n;return Math.log(2.506628274631*a/e)-r}function Hu(t,e){var n=function(t,e,n){var r,o,i,a,l,s,c,u,f,h,d=e-1,p=n-1,m=0;if(t<=0)return 0;if(t>=1)return 1;for(e>=1&&n>=1?(i=t<.5?t:1-t,s=(2.30753+.27061*(a=Math.sqrt(-2*Math.log(i))))/(1+a*(.99229+.04481*a))-a,t<.5&&(s=-s),c=(s*s-3)/6,u=2/(1/(2*e-1)+1/(2*n-1)),f=s*Math.sqrt(c+u)/u-(1/(2*n-1)-1/(2*e-1))*(c+5/6-2/(3*u)),s=e/(e+n*Math.exp(2*f))):(r=Math.log(e/(e+n)),o=Math.log(n/(e+n)),s=t<(a=Math.exp(e*r)/e)/(f=a+(l=Math.exp(n*o)/n))?Math.pow(e*f*t,1/e):1-Math.pow(n*f*(1-t),1/n)),h=-Xu(e)-Xu(n)+Xu(e+n);m<10;m++){if(0===s||1===s)return s;if((s-=a=(l=(_u(s,e,n)-t)/(a=Math.exp(d*Math.log(s)+p*Math.log(1-s)+h)))/(1-.5*Math.min(1,l*(d/s-p/(1-s)))))<=0&&(s=.5*(s+a)),s>=1&&(s=.5*(s+a+1)),Math.abs(a)<1e-8*s&&m>0)break}return s}(2*Math.min(t,1-t),.5*e,.5);return n=Math.sqrt(e*(1-n)/n),t>.5?n:-n}const Uu={ariaLabel:"linear-regression",fill:"currentColor",fillOpacity:.1,stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Vu extends Io{constructor(t,e={}){const{x:n,y:r,z:o,ci:i=.95,precision:a=4}=e;if(super(t,{x:{value:n,scale:"x"},y:{value:r,scale:"y"},z:{value:Mt(e),optional:!0}},e,Uu),this.z=o,this.ci=+i,this.precision=+a,!(0<=this.ci&&this.ci<1))throw new Error(`invalid ci; not in [0, 1): ${i}`);if(!(this.precision>0))throw new Error(`invalid precision: ${a}`)}render(t,e,n,r,o){const{x:i,y:a,z:l}=n,{ci:s}=this;return kn("svg:g",o).call(co,this,r,o).call(po,this,e).call((e=>e.selectAll().data(l?lo(t,l,this.z):[t]).enter().call((t=>t.append("path").attr("fill","none").call(uo,this).call(ao,this,{...n,fill:null,fillOpacity:null}).attr("d",(t=>this._renderLine(t,i,a))).call(s&&!Kt(this.fill)?t=>t.select(Zu).attr("stroke","none").call(uo,this).call(ao,this,{...n,stroke:null,strokeOpacity:null,strokeWidth:null}).attr("d",(t=>this._renderBand(t,i,a))):()=>{}))))).node()}}function Zu(){return this.parentNode.insertBefore(this.ownerDocument.createElementNS(e.namespaces.svg,"path"),this)}class Qu extends Vu{constructor(t,e){super(t,e)}_renderBand(t,n,r){const{ci:o,precision:i}=this,[a,l]=e.extent(t,(t=>r[t])),s=Ku(t,r,n),c=tf(t,r,n,(1-o)/2,s);return e.area().y((t=>t)).x0((t=>c(t,-1))).x1((t=>c(t,1)))(e.range(a,l-i/2,i).concat(l))}_renderLine(t,n,r){const[o,i]=e.extent(t,(t=>r[t])),a=Ku(t,r,n);return`M${a(o)},${o}L${a(i)},${i}`}}class Ju extends Vu{constructor(t,e){super(t,e)}_renderBand(t,n,r){const{ci:o,precision:i}=this,[a,l]=e.extent(t,(t=>n[t])),s=Ku(t,n,r),c=tf(t,n,r,(1-o)/2,s);return e.area().x((t=>t)).y0((t=>c(t,-1))).y1((t=>c(t,1)))(e.range(a,l-i/2,i).concat(l))}_renderLine(t,n,r){const[o,i]=e.extent(t,(t=>n[t])),a=Ku(t,n,r);return`M${o},${a(o)}L${i},${a(i)}`}}function Ku(t,e,n){let r=0,o=0,i=0,a=0;for(const l of t){const t=e[l],s=n[l];r+=t,o+=s,i+=t*s,a+=t*t}const l=t.length,s=(l*i-r*o)/(l*a-r*r),c=(o-s*r)/l;return t=>s*t+c}function tf(t,n,r,o,i){const a=e.sum(t,(t=>n[t]))/t.length;let l=0,s=0;for(const e of t)l+=(n[e]-a)**2,s+=(r[e]-i(n[e]))**2;const c=Math.sqrt(s/(t.length-2)),u=Hu(o,t.length-2);return(e,n)=>{const r=i(e),o=c*Math.sqrt(1/t.length+(e-a)**2/l);return r+n*u*o}}function ef({path:t=H,delimiter:n,frameAnchor:r,treeLayout:o=e.tree,treeSort:i,treeSeparation:a,treeAnchor:l,treeFilter:s,...c}={}){l=rf(l),i=lf(i),null!=s&&(s=df(s)),void 0===r&&(r=l.frameAnchor);const u=cf(n),f=Af(c,df),[h,d]=Rt(),[p,m]=Rt();return{x:h,y:p,frameAnchor:r,...xe(c,((n,r)=>{const c=u(F(n,t)),h=d([]),p=m([]);let y=-1;const g=[],v=[],x=e.stratify().path((t=>c[t])),w=o();w.nodeSize&&w.nodeSize([1,1]),w.separation&&void 0!==a&&w.separation(a??U);for(const t of f)t[Lf]=t[$f]([]);for(const t of r){const e=[],r=x(t.filter((t=>null!=c[t]))).each((t=>t.data=n[t.data]));null!=i&&r.sort(i),w(r);for(const t of r.descendants())if(null==s||s(t)){e.push(++y),g[y]=t.data,l.position(t,y,h,p);for(const e of f)e[Lf][y]=e[Mf](t)}v.push(e)}return{data:g,facets:v}})),...Object.fromEntries(f)}}function nf({path:t=H,delimiter:n,curve:r="bump-x",stroke:o="#555",strokeWidth:i=1.5,strokeOpacity:a=.5,treeLayout:l=e.tree,treeSort:s,treeSeparation:c,treeAnchor:u,treeFilter:f,...h}={}){u=rf(u),s=lf(s),null!=f&&(f=pf(f)),h={curve:r,stroke:o,strokeWidth:i,strokeOpacity:a,...h};const d=cf(n),p=Af(h,pf),[m,y]=Rt(),[g,v]=Rt(),[x,w]=Rt(),[b,k]=Rt();return{x1:m,x2:g,y1:x,y2:b,...xe(h,((n,r)=>{const o=d(F(n,t)),i=y([]),a=v([]),h=w([]),m=k([]);let g=-1;const x=[],b=[],$=e.stratify().path((t=>o[t])),M=l();M.nodeSize&&M.nodeSize([1,1]),M.separation&&void 0!==c&&M.separation(c??U);for(const t of p)t[Lf]=t[$f]([]);for(const t of r){const e=[],r=$(t.filter((t=>null!=o[t]))).each((t=>t.data=n[t.data]));null!=s&&r.sort(s),M(r);for(const{source:t,target:n}of r.links())if(null==f||f(n,t)){e.push(++g),x[g]=n.data,u.position(t,g,i,h),u.position(n,g,a,m);for(const e of p)e[Lf][g]=e[Mf](n,t)}b.push(e)}return{data:x,facets:b}})),...Object.fromEntries(p)}}function rf(t="left"){switch(`${t}`.trim().toLowerCase()){case"left":return of;case"right":return af}throw new Error(`invalid tree anchor: ${t}`)}const of={frameAnchor:"left",dx:6,position({x:t,y:e},n,r,o){r[n]=e,o[n]=-t}},af={frameAnchor:"right",dx:-6,position({x:t,y:e},n,r,o){r[n]=-e,o[n]=-t}};function lf(t){return null==t||"function"==typeof t?t:`${t}`.trim().toLowerCase().startsWith("node:")?sf(df(t)):sf(function(t){return e=>e.data?.[t]}(t))}function sf(t){return(e,n)=>r(t(e),t(n))}function cf(t="/"){if("/"===(t=`${t}`))return t=>t;if(1!==t.length)throw new Error("delimiter must be exactly one character");const e=t.charCodeAt(0);return t=>t.map((t=>function(t,e){if(e===uf)throw new Error("delimiter cannot be backslash");let n=!1;for(let r=0,o=t.length;r<o;++r){switch(t.charCodeAt(r)){case uf:if(!n){n=!0;continue}break;case e:n?(t=t.slice(0,r-1)+t.slice(r),--r,--o):t=t.slice(0,r)+"/"+t.slice(r+1);break;case ff:n?(t=t.slice(0,r)+"\\\\"+t.slice(r),r+=2,o+=2):(t=t.slice(0,r)+"\\"+t.slice(r),++r,++o)}n=!1}return t}(t,e)))}const uf=92,ff=47;function hf(t){return vt(t)&&"function"==typeof t.node}function df(t){if(hf(t))return t.node;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")){switch(t){case"node:name":return yf;case"node:path":return mf;case"node:internal":return xf;case"node:external":return wf;case"node:depth":return gf;case"node:height":return vf}throw new Error(`invalid node value: ${t}`)}}function pf(t){if(hf(t))return t.node;if(vt(e=t)&&"function"==typeof e.link)return t.link;var e;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")||t.startsWith("parent:")){switch(t){case"parent:name":return bf(yf);case"parent:path":return bf(mf);case"parent:depth":return bf(gf);case"parent:height":return bf(vf);case"node:name":return yf;case"node:path":return mf;case"node:internal":return xf;case"node:external":return wf;case"node:depth":return gf;case"node:height":return vf}throw new Error(`invalid link value: ${t}`)}}function mf(t){return t.id}function yf(t){return function(t){let e=t.length;for(;--e>0&&!kf(t,e););return function(t){let e=!1;for(let n=0,r=t.length;n<r;++n){switch(t.charCodeAt(n)){case uf:if(!e){e=!0;continue}case ff:e&&(t=t.slice(0,n-1)+t.slice(n),--n,--r)}e=!1}return t}(t.slice(e+1))}(t.id)}function gf(t){return t.depth}function vf(t){return t.height}function xf(t){return!!t.children}function wf(t){return!t.children}function bf(t){return(e,n)=>null==n?void 0:t(n)}function kf(t,e){if("/"===t[e]){let n=0;for(;e>0&&"\\"===t[--e];)++n;if(!(1&n))return!0}return!1}const $f=2,Mf=3,Lf=4;function Af(t,e){const n=[];for(const r in t){const o=t[r],i=e(o);void 0!==i&&n.push([r,...Rt(o),i])}return n}function Sf(t,{fill:n,stroke:r,strokeWidth:o,strokeOpacity:i,strokeLinejoin:a,strokeLinecap:l,strokeMiterlimit:s,strokeDasharray:c,strokeDashoffset:u,marker:f,markerStart:h=f,markerEnd:d=f,dot:p=Jt(h)&&Jt(d),text:m="node:name",textStroke:y="var(--plot-background)",title:g="node:path",dx:v,dy:x,textAnchor:w,treeLayout:b=e.tree,textLayout:k=(b===e.tree||b===e.cluster?"mirrored":"normal"),tip:$,...M}={}){if(void 0===v&&(v=rf(M.treeAnchor).dx),void 0!==w)throw new Error("textAnchor is not a configurable tree option");function L(e){return Ri(t,ef({treeLayout:b,text:m,fill:void 0===n?"currentColor":n,stroke:y,dx:v,dy:x,title:g,...e,...M}))}return k=ft(k,"textLayout",["mirrored","normal"]),Po(As(t,nf({treeLayout:b,markerStart:h,markerEnd:d,stroke:void 0!==r?r:void 0===n?"node:internal":n,strokeWidth:o,strokeOpacity:i,strokeLinejoin:a,strokeLinecap:l,strokeMiterlimit:s,strokeDasharray:c,strokeDashoffset:u,...M})),p?Ys(t,ef({treeLayout:b,fill:void 0===n?"node:internal":n,title:g,tip:$,...M})):null,null!=m?"mirrored"===k?[L({textAnchor:"start",treeFilter:"node:external"}),L({textAnchor:"end",treeFilter:"node:internal",dx:-v})]:L():null)}function zf(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Of(t,e,n,r,o){for(var i=o+1;r<=o;){var a=r+o>>>1,l=t[a];(void 0!==n?n(l,e):l-e)>=0?(i=a,o=a-1):r=a+1}return i}function Ef(t,e,n,r,o){for(var i=o+1;r<=o;){var a=r+o>>>1,l=t[a];(void 0!==n?n(l,e):l-e)>0?(i=a,o=a-1):r=a+1}return i}function Rf(t,e,n,r,o){for(var i=r-1;r<=o;){var a=r+o>>>1,l=t[a];(void 0!==n?n(l,e):l-e)<0?(i=a,r=a+1):o=a-1}return i}function Cf(t,e,n,r,o){for(var i=r-1;r<=o;){var a=r+o>>>1,l=t[a];(void 0!==n?n(l,e):l-e)<=0?(i=a,r=a+1):o=a-1}return i}function Tf(t,e,n,r,o){for(;r<=o;){var i=r+o>>>1,a=t[i],l=void 0!==n?n(a,e):a-e;if(0===l)return i;l<=0?r=i+1:o=i-1}return-1}function Bf(t,e,n,r,o,i){return"function"==typeof n?i(t,e,n,void 0===r?0:0|r,void 0===o?t.length-1:0|o):i(t,e,void 0,void 0===n?0:0|n,void 0===r?t.length-1:0|r)}var Nf={ge:function(t,e,n,r,o){return Bf(t,e,n,r,o,Of)},gt:function(t,e,n,r,o){return Bf(t,e,n,r,o,Ef)},lt:function(t,e,n,r,o){return Bf(t,e,n,r,o,Rf)},le:function(t,e,n,r,o){return Bf(t,e,n,r,o,Cf)},eq:function(t,e,n,r,o){return Bf(t,e,n,r,o,Tf)}},If=function(t){if(!t||0===t.length)return new Zf(null);return new Zf(Vf(t))};function Pf(t,e,n,r,o){this.mid=t,this.left=e,this.right=n,this.leftPoints=r,this.rightPoints=o,this.count=(e?e.count:0)+(n?n.count:0)+r.length}var Wf=Pf.prototype;function jf(t,e){t.mid=e.mid,t.left=e.left,t.right=e.right,t.leftPoints=e.leftPoints,t.rightPoints=e.rightPoints,t.count=e.count}function qf(t,e){var n=Vf(e);t.mid=n.mid,t.left=n.left,t.right=n.right,t.leftPoints=n.leftPoints,t.rightPoints=n.rightPoints,t.count=n.count}function Ff(t,e){var n=t.intervals([]);n.push(e),qf(t,n)}function Df(t,e){var n=t.intervals([]),r=n.indexOf(e);return r<0?0:(n.splice(r,1),qf(t,n),1)}function Yf(t,e,n){for(var r=0;r<t.length&&t[r][0]<=e;++r){var o=n(t[r]);if(o)return o}}function _f(t,e,n){for(var r=t.length-1;r>=0&&t[r][1]>=e;--r){var o=n(t[r]);if(o)return o}}function Gf(t,e){for(var n=0;n<t.length;++n){var r=e(t[n]);if(r)return r}}function Xf(t,e){return t-e}function Hf(t,e){var n=t[0]-e[0];return n||t[1]-e[1]}function Uf(t,e){var n=t[1]-e[1];return n||t[0]-e[0]}function Vf(t){if(0===t.length)return null;for(var e=[],n=0;n<t.length;++n)e.push(t[n][0],t[n][1]);e.sort(Xf);var r=e[e.length>>1],o=[],i=[],a=[];for(n=0;n<t.length;++n){var l=t[n];l[1]<r?o.push(l):r<l[0]?i.push(l):a.push(l)}var s=a,c=a.slice();return s.sort(Hf),c.sort(Uf),new Pf(r,Vf(o),Vf(i),s,c)}function Zf(t){this.root=t}Wf.intervals=function(t){return t.push.apply(t,this.leftPoints),this.left&&this.left.intervals(t),this.right&&this.right.intervals(t),t},Wf.insert=function(t){var e=this.count-this.leftPoints.length;if(this.count+=1,t[1]<this.mid)this.left?4*(this.left.count+1)>3*(e+1)?Ff(this,t):this.left.insert(t):this.left=Vf([t]);else if(t[0]>this.mid)this.right?4*(this.right.count+1)>3*(e+1)?Ff(this,t):this.right.insert(t):this.right=Vf([t]);else{var n=Nf.ge(this.leftPoints,t,Hf),r=Nf.ge(this.rightPoints,t,Uf);this.leftPoints.splice(n,0,t),this.rightPoints.splice(r,0,t)}},Wf.remove=function(t){var e=this.count-this.leftPoints;if(t[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(e-1)?Df(this,t):2===(i=this.left.remove(t))?(this.left=null,this.count-=1,1):(1===i&&(this.count-=1),i):0;if(t[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(e-1)?Df(this,t):2===(i=this.right.remove(t))?(this.right=null,this.count-=1,1):(1===i&&(this.count-=1),i):0;if(1===this.count)return this.leftPoints[0]===t?2:0;if(1===this.leftPoints.length&&this.leftPoints[0]===t){if(this.left&&this.right){for(var n=this,r=this.left;r.right;)n=r,r=r.right;if(n===this)r.right=this.right;else{var o=this.left,i=this.right;n.count-=r.count,n.right=r.left,r.left=o,r.right=i}jf(this,r),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?jf(this,this.left):jf(this,this.right);return 1}for(o=Nf.ge(this.leftPoints,t,Hf);o<this.leftPoints.length&&this.leftPoints[o][0]===t[0];++o)if(this.leftPoints[o]===t){this.count-=1,this.leftPoints.splice(o,1);for(i=Nf.ge(this.rightPoints,t,Uf);i<this.rightPoints.length&&this.rightPoints[i][1]===t[1];++i)if(this.rightPoints[i]===t)return this.rightPoints.splice(i,1),1}return 0},Wf.queryPoint=function(t,e){if(t<this.mid){if(this.left)if(n=this.left.queryPoint(t,e))return n;return Yf(this.leftPoints,t,e)}if(t>this.mid){var n;if(this.right)if(n=this.right.queryPoint(t,e))return n;return _f(this.rightPoints,t,e)}return Gf(this.leftPoints,e)},Wf.queryInterval=function(t,e,n){var r;if(t<this.mid&&this.left&&(r=this.left.queryInterval(t,e,n)))return r;if(e>this.mid&&this.right&&(r=this.right.queryInterval(t,e,n)))return r;return e<this.mid?Yf(this.leftPoints,e,n):t>this.mid?_f(this.rightPoints,t,n):Gf(this.leftPoints,n)};var Qf=Zf.prototype;Qf.insert=function(t){this.root?this.root.insert(t):this.root=new Pf(t[0],null,null,[t],[t])},Qf.remove=function(t){if(this.root){var e=this.root.remove(t);return 2===e&&(this.root=null),0!==e}return!1},Qf.queryPoint=function(t,e){if(this.root)return this.root.queryPoint(t,e)},Qf.queryInterval=function(t,e,n){if(t<=e&&this.root)return this.root.queryInterval(t,e,n)},Object.defineProperty(Qf,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(Qf,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});var Jf=zf(If);const Kf=({marginLeft:t})=>[1,t],th=({width:t,marginRight:e})=>[-1,t-e],eh=({width:t,marginLeft:e,marginRight:n})=>[0,(e+t-n)/2],nh=({marginTop:t})=>[1,t],rh=({height:t,marginBottom:e})=>[-1,t-e],oh=({height:t,marginTop:e,marginBottom:n})=>[0,(e+t-n)/2];function ih(t){return"string"==typeof t?{anchor:t}:t}function ah(t){const{anchor:e,padding:n,...r}=t,{r:o}=r;return[{anchor:e,padding:n,r:o},r]}function lh(t,e,n,r,o,i){if(null!=o&&"number"!=typeof o){let{channels:t,sort:e,reverse:n}=i;t=ne(t),void 0===t?.r&&(i={...i,channels:{...t,r:{value:o,scale:"r"}}}),void 0===e&&void 0===n&&(i.sort={channel:"-r"})}return we(i,(function(i,s,c,u,f,h){let{[e]:d,r:p}=c;if(!c[e])throw new Error(`missing channel: ${e}`);({[e]:d}=Pn(c,u,h));const m=p?void 0:void 0!==o?Q(o):void 0!==this.r?this.r:3;p&&(p=F(p.value,u[p.scale]||H,Float64Array));let[y,g]=n(f);const v=y?ch:sh,x=new Float64Array(d.length),w=p?t=>p[t]:()=>m;for(let t of s){const e=Jf();t=t.filter(p?t=>a(d[t])&&l(p[t]):t=>a(d[t]));const n=new Float64Array(2*t.length+2);for(const o of t){const t=w(o),i=y?t+r:0,a=d[o]-t,l=d[o]+t;let s=2;e.queryInterval(a-r,l+r,(([,,t])=>{const e=x[t]-i,a=d[o]-d[t],l=r+(p?p[o]+p[t]:2*m),c=Math.sqrt(l*l-a*a);n[s++]=e-c,n[s++]=e+c}));let c=n.slice(0,s);y&&(c=c.filter((t=>t>=0)));t:for(const t of c.sort(v)){for(let e=0;e<s;e+=2)if(n[e]+1e-6<t&&t<n[e+1]-1e-6)continue t;x[o]=t+i;break}e.insert([a,l,o])}}y||(y=1);for(const t of s)for(const e of t)x[e]=x[e]*y+g;return{data:i,facets:s,channels:{[t]:{value:x,source:null},[e]:{value:d,source:c[e]},...p&&{r:{value:p,source:c.r}}}}}))}function sh(t,e){return Math.abs(t)-Math.abs(e)}function ch(t,e){return t-e}function uh(t){if(void 0===t)return ph;if("function"==typeof t)return fh(St(t));if(/^p\d{2}$/i.test(t))return hh(nt(t));switch(`${t}`.toLowerCase()){case"deviation":return yh;case"first":return ph;case"last":return mh;case"max":return gh;case"mean":return vh;case"median":return xh;case"min":return wh;case"sum":return bh;case"extent":return dh}throw new Error(`invalid basis: ${t}`)}function fh(t){return{mapIndex(e,n,r){const o=+t(e,n);for(const t of e)r[t]=null===n[t]?NaN:n[t]/o}}}function hh(t){return fh(((e,n)=>t(e,(t=>n[t]))))}const dh={mapIndex(t,n,r){const[o,i]=e.extent(t,(t=>n[t])),a=i-o;for(const e of t)r[e]=null===n[e]?NaN:(n[e]-o)/a}},ph=fh(((t,e)=>{for(let r=0;r<t.length;++r){const o=e[t[r]];if(n(o))return o}})),mh=fh(((t,e)=>{for(let r=t.length-1;r>=0;--r){const o=e[t[r]];if(n(o))return o}})),yh={mapIndex(t,n,r){const o=e.mean(t,(t=>n[t])),i=e.deviation(t,(t=>n[t]));for(const e of t)r[e]=null===n[e]?NaN:i?(n[e]-o)/i:0}},gh=hh(e.max),vh=hh(e.mean),xh=hh(e.median),wh=hh(e.min),bh=hh(e.sum);function kh(t){if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"min":return Sh;case"max":return zh}throw new Error(`unknown selector: ${t}`)}function $h(t){return Oh(null,Lh,t)}function Mh(t){return Oh(null,Ah,t)}function*Lh(t){yield t[0]}function*Ah(t){yield t[t.length-1]}function*Sh(t,n){yield e.least(t,(t=>n[t]))}function*zh(t,n){yield e.greatest(t,(t=>n[t]))}function Oh(t,n,r){if(null!=t){if(null==r[t])throw new Error(`missing channel: ${t}`);t=r[t]}const o=Mt(r);return xe(r,((r,i)=>{const a=F(r,o),l=F(r,t),s=[];for(const t of i){const r=[];for(const o of a?e.group(t,(t=>a[t])).values():[t])for(const t of n(o,l))r.push(t);s.push(r)}return{data:r,facets:s}}))}t.Area=ws,t.Arrow=Os,t.BarX=Ts,t.BarY=Bs,t.Cell=Ws,t.Contour=ou,t.Density=Au,t.Dot=Ds,t.Frame=Ha,t.Geo=Tu,t.Hexgrid=ju,t.Image=Du,t.Line=Gs,t.Link=Ls,t.Mark=Io,t.Raster=Gc,t.Rect=Zs,t.RuleX=wi,t.RuleY=bi,t.Text=zi,t.TickX=Cc,t.TickY=Tc,t.Tip=Qa,t.Vector=ra,t.area=bs,t.areaX=ks,t.areaY=$s,t.arrow=function(t,{x:e,x1:n,x2:r,y:o,y1:i,y2:a,...l}={}){return[n,r]=Ss(e,n,r),[i,a]=Ss(o,i,a),new Os(t,{...l,x1:n,x2:r,y1:i,y2:a})},t.auto=function(t,e){const n=tc(t,e),{fx:r,fy:o,x:{zero:i},y:{zero:a},markOptions:l,transformOptions:s,colorMode:c}=n,u=lc[n.markImpl],f=lc[n.transformImpl],h=null!=r||null!=o?Ua({strokeOpacity:.1}):null,d=[i?ki([0]):null,a?$i([0]):null],p=u(t,f?f(s,l):l);return"stroke"===c?Po(h,d,p):Po(h,p,d)},t.autoSpec=tc,t.axisFx=ya,t.axisFy=pa,t.axisX=ma,t.axisY=da,t.barX=Ns,t.barY=Is,t.bin=El,t.binX=zl,t.binY=Ol,t.bollinger=Oc,t.bollingerX=function(t,{x:e=H,y:n,k:r=zc.k,color:o=zc.color,opacity:i=zc.opacity,fill:a=o,fillOpacity:l=i,stroke:s=o,strokeOpacity:c,strokeWidth:u,...f}={}){return Po(Jt(a)?null:ks(t,fc({x1:Oc({k:-r,...f}),x2:Oc({k:r,...f})},{x1:e,x2:e,y:n,fill:a,fillOpacity:l,...f})),Jt(s)?null:Hs(t,fc({x:Oc(f)},{x:e,y:n,stroke:s,strokeOpacity:c,strokeWidth:u,...f})))},t.bollingerY=function(t,{x:e,y:n=H,k:r=zc.k,color:o=zc.color,opacity:i=zc.opacity,fill:a=o,fillOpacity:l=i,stroke:s=o,strokeOpacity:c,strokeWidth:u,...f}={}){return Po(Jt(a)?null:$s(t,fc({y1:Oc({k:-r,...f}),y2:Oc({k:r,...f})},{x:e,y1:n,y2:n,fill:a,fillOpacity:l,...f})),Jt(s)?null:Us(t,fc({y:Oc(f)},{x:e,y:n,stroke:s,strokeOpacity:c,strokeWidth:u,...f})))},t.boxX=function(t,{x:e=H,y:n=null,fill:r="#ccc",fillOpacity:o,stroke:i="currentColor",strokeOpacity:a,strokeWidth:l=2,sort:s,...c}={}){const u=null!=n?Ce:Ee;return Po($i(t,u({x1:Pc,x2:Wc},{x:e,y:n,stroke:i,strokeOpacity:a,...c})),Ns(t,u({x1:"p25",x2:"p75"},{x:e,y:n,fill:r,fillOpacity:o,...c})),Bc(t,u({x:"p50"},{x:e,y:n,stroke:i,strokeOpacity:a,strokeWidth:l,sort:s,...c})),Ys(t,fc({x:Ic},{x:e,y:n,z:n,stroke:i,strokeOpacity:a,...c})))},t.boxY=function(t,{y:e=H,x:n=null,fill:r="#ccc",fillOpacity:o,stroke:i="currentColor",strokeOpacity:a,strokeWidth:l=2,sort:s,...c}={}){const u=null!=n?Re:Ee;return Po(ki(t,u({y1:Pc,y2:Wc},{x:n,y:e,stroke:i,strokeOpacity:a,...c})),Is(t,u({y1:"p25",y2:"p75"},{x:n,y:e,fill:r,fillOpacity:o,...c})),Nc(t,u({y:"p50"},{x:n,y:e,stroke:i,strokeOpacity:a,strokeWidth:l,sort:s,...c})),Ys(t,fc({y:Ic},{x:n,y:e,z:n,stroke:i,strokeOpacity:a,...c})))},t.cell=js,t.cellX=function(t,{x:e=X,fill:n,stroke:r,...o}={}){return void 0===n&&void 0===st(r)[0]&&(n=H),new Ws(t,{...o,x:e,fill:n,stroke:r})},t.cellY=function(t,{y:e=X,fill:n,stroke:r,...o}={}){return void 0===n&&void 0===st(r)[0]&&(n=H),new Ws(t,{...o,y:e,fill:n,stroke:r})},t.centroid=function({geometry:t=H,...n}={}){return we({...n,x:null,y:null},((n,r,o,i,a,{projection:l})=>{const s=F(n,t),c=s.length,u=new Float64Array(c),f=new Float64Array(c),h=e.geoPath(l);for(let t=0;t<c;++t)[u[t],f[t]]=h.centroid(s[t]);return{data:n,facets:r,channels:{x:{value:u,scale:null==l?"x":null,source:null},y:{value:f,scale:null==l?"y":null,source:null}}}}))},t.circle=function(t,e){return Ys(t,{...e,symbol:"circle"})},t.cluster=function(t,n){return Sf(t,{...n,treeLayout:e.cluster})},t.column=Rt,t.contour=function(){return new ou(...Xc("value",...arguments))},t.crosshair=function(t,e){return au(Yo,t,e)},t.crosshairX=function(t,e={}){return au(_o,t,e)},t.crosshairY=function(t,e={}){return au(Go,t,e)},t.delaunayLink=function(t,e){return Mu(gu,t,e)},t.delaunayMesh=function(t,e){return Mu(xu,t,e)},t.density=function(t,{x:e,y:n,...r}={}){return[e,n]=$t(e,n),new Au(t,{...r,x:e,y:n})},t.differenceY=function(t,{x1:e,x2:n,y1:r,y2:o,x:i=(void 0===e&&void 0===n?X:void 0),y:a=(void 0===r&&void 0===o?H:void 0),fill:l,positiveFill:s="#3ca951",negativeFill:c="#4269d0",fillOpacity:u=1,positiveFillOpacity:f=u,negativeFillOpacity:h=u,stroke:d,strokeOpacity:p,z:m=st(d)[0],clip:y,tip:g,render:v,...x}={}){return[e,n]=Ou(i,e,n),[r,o]=Ou(a,r,o),e===n&&r===o&&(r=Eu(0)),({tip:g}=qo({tip:g},"x")),Po(Jt(s)?null:Object.assign(bs(t,{x1:e,x2:n,y1:r,y2:o,z:m,fill:s,fillOpacity:f,render:Wo(v,Ru(!0)),clip:y,...x}),{ariaLabel:"positive difference"}),Jt(c)?null:Object.assign(bs(t,{x1:e,x2:n,y1:r,y2:o,z:m,fill:c,fillOpacity:h,render:Wo(v,Ru(!1)),clip:y,...x}),{ariaLabel:"negative difference"}),Xs(t,{x:n,y:o,z:m,stroke:d,strokeOpacity:p,tip:g,clip:!0,...x}))},t.dodgeX=function(t={},e={}){1===arguments.length&&([t,e]=ah(t));let{anchor:n="left",padding:r=1,r:o=e.r}=ih(t);switch(`${n}`.toLowerCase()){case"left":n=Kf;break;case"right":n=th;break;case"middle":n=eh;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return lh("x","y",n,Q(r),o,e)},t.dodgeY=function(t={},e={}){1===arguments.length&&([t,e]=ah(t));let{anchor:n="bottom",padding:r=1,r:o=e.r}=ih(t);switch(`${n}`.toLowerCase()){case"top":n=nh;break;case"bottom":n=rh;break;case"middle":n=oh;break;default:throw new Error(`unknown dodge anchor: ${n}`)}return lh("y","x",n,Q(r),o,e)},t.dot=Ys,t.dotX=function(t,{x:e=H,...n}={}){return new Ds(t,vi({...n,x:e}))},t.dotY=function(t,{y:e=H,...n}={}){return new Ds(t,gi({...n,y:e}))},t.filter=function(t,e){return $e(e,Me(t))},t.find=function(t){if("function"!=typeof t)throw new Error(`invalid test function: ${t}`);return{reduceIndex:(e,n,{data:r})=>n[e.find((e=>t(r[e],e,r)))]}},t.formatIsoDate=Qr,t.formatMonth=function(t="en-US",e="short"){const n=Vr(t,e);return t=>null==t||isNaN(t=+new Date(Date.UTC(2e3,+t)))?void 0:n.format(t)},t.formatWeekday=function(t="en-US",e="short"){const n=Zr(t,e);return t=>null==t||isNaN(t=+new Date(Date.UTC(2001,0,+t)))?void 0:n.format(t)},t.frame=Ua,t.geo=Bu,t.geoCentroid=function({geometry:t=H,...n}={}){let r;return{...n,x:{transform:n=>Float64Array.from(r=F(F(n,t),e.geoCentroid),(([t])=>t))},y:{transform:()=>Float64Array.from(r,(([,t])=>t))}}},t.graticule=function({strokeOpacity:t=.1,...n}={}){return Bu(e.geoGraticule10(),{strokeOpacity:t,...n})},t.gridFx=ka,t.gridFy=wa,t.gridX=ba,t.gridY=xa,t.group=Te,t.groupX=Re,t.groupY=Ce,t.groupZ=Ee,t.hexagon=function(t,e){return Ys(t,{...e,symbol:"hexagon"})},t.hexbin=function(t={fill:"count"},{binWidth:e,...n}={}){const{z:r}=n;return e=void 0===e?20:Q(e),Ne(t=De(t,n),"fill")&&(n.channels={...n.channels,fill:{value:[]}}),void 0===n.symbol&&(n.symbol="hexagon"),void 0!==n.r||Ne(t,"r")||(n.r=e/2),we(n,((n,o,i,a,l,s)=>{let{x:c,y:u,z:f,fill:h,stroke:d,symbol:p}=i;if(void 0===c)throw new Error("missing channel: x");if(void 0===u)throw new Error("missing channel: y");({x:c,y:u}=Pn(i,a,s)),f=f?f.value:F(n,r),h=h?.value,d=d?.value,p=p?.value;const m=He(t,{z:f,fill:h,stroke:d,symbol:p}),y=f&&[],g=h&&[],v=d&&[],x=p&&[],w=[],b=[],k=[];let $=-1;for(const e of t)e.initialize(n);for(const r of o){const o=[];for(const e of t)e.scope("facet",r);for(const[i,a]of je(r,m))for(const{index:r,extent:l}of Pu(n,a,c,u,e)){o.push(++$),b.push(l.x),k.push(l.y),f&&y.push(m===f?i:f[r[0]]),h&&g.push(m===h?i:h[r[0]]),d&&v.push(m===d?i:d[r[0]]),p&&x.push(m===p?i:p[r[0]]);for(const e of t)e.reduce(r,l)}w.push(o)}const M=i.x.scale,L=i.y.scale;return{data:n,facets:w,channels:{x:{value:b,source:a[M]?{value:dt(b,a[M].invert),scale:M}:null},y:{value:k,source:a[L]?{value:dt(k,a[L].invert),scale:L}:null},...f&&{z:{value:y}},...h&&{fill:{value:g,scale:"auto"}},...d&&{stroke:{value:v,scale:"auto"}},...p&&{symbol:{value:x,scale:"auto"}},...Object.fromEntries(t.map((({name:t,output:n})=>[t,{scale:"auto",label:n.label,radius:"r"===t?e/2:void 0,value:n.transform()}])))}}}))},t.hexgrid=function(t){return new ju(t)},t.hull=function(t,e){return Mu(wu,t,e)},t.identity=H,t.image=function(t,{x:e,y:n,...r}={}){return void 0===r.frameAnchor&&([e,n]=$t(e,n)),new Du(t,{...r,x:e,y:n})},t.indexOf=X,t.initializer=we,t.interpolateNearest=tu,t.interpolateNone=Zc,t.interpolatorBarycentric=Qc,t.interpolatorRandomWalk=eu,t.legend=function(t={}){for(const[e,n]of Fa){const r=t[e];if(xt(r)){const o=bn(t);let i;if("symbol"===e){const{fill:e,stroke:n=(void 0===e&&xt(t.color)?"color":void 0)}=t;i={fill:e,stroke:n}}return n(Nr(e,r,i),Da(o,r,t),(e=>xt(t[e])?Nr(e,t[e]):null))}}throw new Error("unknown legend type; no scale found")},t.line=Xs,t.lineX=Hs,t.lineY=Us,t.linearRegressionX=function(t,{y:e=X,x:n=H,stroke:r,fill:o=(Jt(r)?"currentColor":r),...i}={}){return new Qu(t,Tl({...i,x:n,y:e,fill:o,stroke:r}))},t.linearRegressionY=function(t,{x:e=X,y:n=H,stroke:r,fill:o=(Jt(r)?"currentColor":r),...i}={}){return new Ju(t,Cl({...i,x:e,y:n,fill:o,stroke:r}))},t.link=As,t.map=fc,t.mapX=cc,t.mapY=uc,t.marks=Po,t.normalize=uh,t.normalizeX=function(t,e){return 1===arguments.length&&({basis:t,...e}=t),cc(uh(t),e)},t.normalizeY=function(t,e){return 1===arguments.length&&({basis:t,...e}=t),uc(uh(t),e)},t.plot=al,t.pointer=Yo,t.pointerX=_o,t.pointerY=Go,t.raster=function(){const[t,e]=Xc("fill",...arguments);return new Gc(t,null==t||void 0!==e.fill||void 0!==e.fillOpacity?e:{...e,fill:H})},t.rect=Qs,t.rectX=Js,t.rectY=Ks,t.reverse=function({sort:t,...e}={}){return{...$e(e,Le),sort:bt(t)?t:null}},t.ruleX=ki,t.ruleY=$i,t.scale=function(t={}){let e;for(const n in t)if(fe.has(n)&&xt(t[n])){if(void 0!==e)throw new Error("ambiguous scale definition; multiple scales found");e=Xr(Nr(n,t[n]))}if(void 0===e)throw new Error("invalid scale definition; no scale found");return e},t.select=function(t,e={}){if("string"==typeof t)switch(t.toLowerCase()){case"first":return $h(e);case"last":return Mh(e)}if("function"==typeof t)return Oh(null,t,e);let n,r;for(n in t){if(void 0!==r)throw new Error("ambiguous selector; multiple inputs");r=kh(t[n])}if(void 0===r)throw new Error(`invalid selector: ${t}`);return Oh(n,r,e)},t.selectFirst=$h,t.selectLast=Mh,t.selectMaxX=function(t){return Oh("x",zh,t)},t.selectMaxY=function(t){return Oh("y",zh,t)},t.selectMinX=function(t){return Oh("x",Sh,t)},t.selectMinY=function(t){return Oh("y",Sh,t)},t.shiftX=function(t,n){return function(t,n,r={}){let o,i=1;if("number"==typeof n)i=n,o=(t,e)=>+t+e;else{if("string"==typeof n){const t=n.startsWith("-")?-1:1;[n,i]=E(n.replace(/^[+-]/,"")),i*=t}n=Pt(n),o=(t,e)=>n.offset(t,e)}const a=`${t}2`,l=fc({[`${t}1`]:t=>t.map((t=>o(t,i))),[a]:t=>t},r),s=l[a].transform;return l[a].transform=()=>{const t=s(),[n,r]=e.extent(t);return t.domain=i<0?[n,o(r,i)]:[o(n,i),r],t},l}("x",t,n)},t.shuffle=function({seed:t,sort:n,...r}={}){return{...$e(r,Oe(null==t?Math.random:e.randomLcg(t))),sort:bt(n)?n:null}},t.sort=Ae,t.sphere=function({strokeWidth:t=1.5,...e}={}){return Bu({type:"Sphere"},{strokeWidth:t,...e})},t.spike=function(t,e={}){const{shape:n=ea,stroke:r=Qi.stroke,strokeWidth:o=1,fill:i=r,fillOpacity:a=.3,anchor:l="start",...s}=e;return oa(t,{...s,shape:n,stroke:r,strokeWidth:o,fill:i,fillOpacity:a,anchor:l})},t.stackX=ns,t.stackX1=function(t={},e={}){1===arguments.length&&([t,e]=as(t));const{y1:n,y:r=n,x:o}=e,[i,a,l]=ss(r,o,"y","x",t,e);return{...i,y1:n,y:a,x:l}},t.stackX2=function(t={},e={}){1===arguments.length&&([t,e]=as(t));const{y1:n,y:r=n,x:o}=e,[i,a,,l]=ss(r,o,"y","x",t,e);return{...i,y1:n,y:a,x:l}},t.stackY=rs,t.stackY1=function(t={},e={}){1===arguments.length&&([t,e]=as(t));const{x1:n,x:r=n,y:o}=e,[i,a,l]=ss(r,o,"x","y",t,e);return{...i,x1:n,x:a,y:l}},t.stackY2=function(t={},e={}){1===arguments.length&&([t,e]=as(t));const{x1:n,x:r=n,y:o}=e,[i,a,,l]=ss(r,o,"x","y",t,e);return{...i,x1:n,x:a,y:l}},t.text=Ri,t.textX=Ci,t.textY=Ti,t.tickX=Bc,t.tickY=Nc,t.tip=Ja,t.transform=xe,t.tree=Sf,t.treeLink=nf,t.treeNode=ef,t.valueof=F,t.vector=oa,t.vectorX=ia,t.vectorY=aa,t.version="0.6.14",t.voronoi=function(t,e){return Mu(bu,t,e)},t.voronoiMesh=function(t,e){return Mu(ku,t,e)},t.window=mc,t.windowX=function(t={},e){return 1===arguments.length&&(e=t),cc(mc(t),e)},t.windowY=function(t={},e){return 1===arguments.length&&(e=t),uc(mc(t),e)}}));
